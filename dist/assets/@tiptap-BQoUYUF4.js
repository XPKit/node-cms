import{r as Vt,m as qt,d as Ut,a as Gt,g as Jt,w as Yt,n as Qt,u as Xt,o as Zt,h as nt,T as te,c as ee}from"./@vue-D4RBOkYN.js";import{P,a as B,S as F,f as ne,c as pt,T as re,l as se,b as oe,d as A,e as ie,g as ae,j as ce,h as le,i as de,k as ue,m as It,n as pe,o as fe,q as he,r as me,s as ge,t as ye,u as ke,v as be,w as Me,x as ve,y as we,z as vt,N as ft,A as Se,B as K,F as W,C as Te,D as Ae,E as xe,G as Ee,H as Ce,I as Le,J as Oe,R as Pe,K as $e,L as Be,M as He,O as Ie,Q as Ne,U as Re,V as je,W as Fe,X as wt,Y as ht,Z as De}from"./vendor-DDOfCGgg.js";function G(e){const{state:t,transaction:n}=e;let{selection:r}=n,{doc:s}=n,{storedMarks:o}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,o=n.storedMarks,n}}}class J{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:n,state:r}=this,{view:s}=n,{tr:o}=r,i=this.buildProps(o);return Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...p)=>{const d=l(...p)(i);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(o),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,n=!0){const{rawCommands:r,editor:s,state:o}=this,{view:i}=s,a=[],l=!!t,c=t||o.tr,p=()=>(!l&&n&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(c),a.every(u=>u===!0)),d={...Object.fromEntries(Object.entries(r).map(([u,f])=>[u,(...y)=>{const h=this.buildProps(c,n),k=f(...y)(h);return a.push(k),d}])),run:p};return d}createCan(t){const{rawCommands:n,state:r}=this,s=!1,o=t||r.tr,i=this.buildProps(o,s);return{...Object.fromEntries(Object.entries(n).map(([l,c])=>[l,(...p)=>c(...p)({...i,dispatch:void 0})])),chain:()=>this.createChain(o,s)}}buildProps(t,n=!0){const{rawCommands:r,editor:s,state:o}=this,{view:i}=s,a={tr:t,editor:s,view:i,state:G({state:o,transaction:t}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(t,n),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...p)=>c(...p)(a)]))}};return a}}class _e{constructor(){this.callbacks={}}on(t,n){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(n),this}emit(t,...n){const r=this.callbacks[t];return r&&r.forEach(s=>s.apply(this,n)),this}off(t,n){const r=this.callbacks[t];return r&&(n?this.callbacks[t]=r.filter(s=>s!==n):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}function g(e,t,n){return e.config[t]===void 0&&e.parent?g(e.parent,t,n):typeof e.config[t]=="function"?e.config[t].bind({...n,parent:e.parent?g(e.parent,t,n):null}):e.config[t]}function Y(e){const t=e.filter(s=>s.type==="extension"),n=e.filter(s=>s.type==="node"),r=e.filter(s=>s.type==="mark");return{baseExtensions:t,nodeExtensions:n,markExtensions:r}}function Nt(e){const t=[],{nodeExtensions:n,markExtensions:r}=Y(e),s=[...n,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage},l=g(i,"addGlobalAttributes",a);if(!l)return;l().forEach(p=>{p.types.forEach(d=>{Object.entries(p.attributes).forEach(([u,f])=>{t.push({type:d,name:u,attribute:{...o,...f}})})})})}),s.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage},l=g(i,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([p,d])=>{const u={...o,...d};typeof(u==null?void 0:u.default)=="function"&&(u.default=u.default()),u!=null&&u.isRequired&&(u==null?void 0:u.default)===void 0&&delete u.default,t.push({type:i.name,name:p,attribute:u})})}),t}function S(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function v(...e){return e.filter(t=>!!t).reduce((t,n)=>{const r={...t};return Object.entries(n).forEach(([s,o])=>{if(!r[s]){r[s]=o;return}if(s==="class"){const a=o?o.split(" "):[],l=r[s]?r[s].split(" "):[],c=a.filter(p=>!l.includes(p));r[s]=[...l,...c].join(" ")}else s==="style"?r[s]=[r[s],o].join("; "):r[s]=o}),r},{})}function ct(e,t){return t.filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(e.attrs)||{}:{[n.name]:e.attrs[n.name]}).reduce((n,r)=>v(n,r),{})}function Rt(e){return typeof e=="function"}function M(e,t=void 0,...n){return Rt(e)?t?e.bind(t)(...n):e(...n):e}function ze(e={}){return Object.keys(e).length===0&&e.constructor===Object}function Ke(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function St(e,t){return e.style?e:{...e,getAttrs:n=>{const r=e.getAttrs?e.getAttrs(n):e.attrs;if(r===!1)return!1;const s=t.reduce((o,i)=>{const a=i.attribute.parseHTML?i.attribute.parseHTML(n):Ke(n.getAttribute(i.name));return a==null?o:{...o,[i.name]:a}},{});return{...r,...s}}}}function Tt(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>t==="attrs"&&ze(n)?!1:n!=null))}function We(e,t){var n;const r=Nt(e),{nodeExtensions:s,markExtensions:o}=Y(e),i=(n=s.find(c=>g(c,"topNode")))===null||n===void 0?void 0:n.name,a=Object.fromEntries(s.map(c=>{const p=r.filter(k=>k.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:t},u=e.reduce((k,b)=>{const w=g(b,"extendNodeSchema",d);return{...k,...w?w(c):{}}},{}),f=Tt({...u,content:M(g(c,"content",d)),marks:M(g(c,"marks",d)),group:M(g(c,"group",d)),inline:M(g(c,"inline",d)),atom:M(g(c,"atom",d)),selectable:M(g(c,"selectable",d)),draggable:M(g(c,"draggable",d)),code:M(g(c,"code",d)),defining:M(g(c,"defining",d)),isolating:M(g(c,"isolating",d)),attrs:Object.fromEntries(p.map(k=>{var b;return[k.name,{default:(b=k==null?void 0:k.attribute)===null||b===void 0?void 0:b.default}]}))}),m=M(g(c,"parseHTML",d));m&&(f.parseDOM=m.map(k=>St(k,p)));const y=g(c,"renderHTML",d);y&&(f.toDOM=k=>y({node:k,HTMLAttributes:ct(k,p)}));const h=g(c,"renderText",d);return h&&(f.toText=h),[c.name,f]})),l=Object.fromEntries(o.map(c=>{const p=r.filter(h=>h.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:t},u=e.reduce((h,k)=>{const b=g(k,"extendMarkSchema",d);return{...h,...b?b(c):{}}},{}),f=Tt({...u,inclusive:M(g(c,"inclusive",d)),excludes:M(g(c,"excludes",d)),group:M(g(c,"group",d)),spanning:M(g(c,"spanning",d)),code:M(g(c,"code",d)),attrs:Object.fromEntries(p.map(h=>{var k;return[h.name,{default:(k=h==null?void 0:h.attribute)===null||k===void 0?void 0:k.default}]}))}),m=M(g(c,"parseHTML",d));m&&(f.parseDOM=m.map(h=>St(h,p)));const y=g(c,"renderHTML",d);return y&&(f.toDOM=h=>y({mark:h,HTMLAttributes:ct(h,p)})),[c.name,f]}));return new He({topNode:i,nodes:a,marks:l})}function rt(e,t){return t.nodes[e]||t.marks[e]||null}function At(e,t){return Array.isArray(t)?t.some(n=>(typeof n=="string"?n:n.name)===e.name):t}const Ve=(e,t=500)=>{let n="";const r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(s,o,i,a)=>{var l,c;const p=((c=(l=s.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:s,pos:o,parent:i,index:a}))||s.textContent||"%leaf%";n+=p.slice(0,Math.max(0,r-o))}),n};function mt(e){return Object.prototype.toString.call(e)==="[object RegExp]"}class Q{constructor(t){this.find=t.find,this.handler=t.handler}}const qe=(e,t)=>{if(mt(t))return t.exec(e);const n=t(e);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function st(e){var t;const{editor:n,from:r,to:s,text:o,rules:i,plugin:a}=e,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((t=c.nodeBefore||c.nodeAfter)===null||t===void 0)&&t.marks.find(u=>u.type.spec.code))return!1;let p=!1;const d=Ve(c)+o;return i.forEach(u=>{if(p)return;const f=qe(d,u.find);if(!f)return;const m=l.state.tr,y=G({state:l.state,transaction:m}),h={from:r-(f[0].length-o.length),to:s},{commands:k,chain:b,can:w}=new J({editor:n,state:y});u.handler({state:y,range:h,match:f,commands:k,chain:b,can:w})===null||!m.steps.length||(m.setMeta(a,{transform:m,from:r,to:s,text:o}),l.dispatch(m),p=!0)}),p}function Ue(e){const{editor:t,rules:n}=e,r=new P({state:{init(){return null},apply(s,o){const i=s.getMeta(r);return i||(s.selectionSet||s.docChanged?null:o)}},props:{handleTextInput(s,o,i,a){return st({editor:t,from:o,to:i,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:o}=s.state.selection;o&&st({editor:t,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(s,o){if(o.key!=="Enter")return!1;const{$cursor:i}=s.state.selection;return i?st({editor:t,from:i.pos,to:i.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function Ge(e){return typeof e=="number"}class Je{constructor(t){this.find=t.find,this.handler=t.handler}}const Ye=(e,t,n)=>{if(mt(t))return[...e.matchAll(t)];const r=t(e,n);return r?r.map(s=>{const o=[s.text];return o.index=s.index,o.input=e,o.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(s.replaceWith)),o}):[]};function Qe(e){const{editor:t,state:n,from:r,to:s,rule:o,pasteEvent:i,dropEvent:a}=e,{commands:l,chain:c,can:p}=new J({editor:t,state:n}),d=[];return n.doc.nodesBetween(r,s,(f,m)=>{if(!f.isTextblock||f.type.spec.code)return;const y=Math.max(r,m),h=Math.min(s,m+f.content.size),k=f.textBetween(y-m,h-m,void 0,"ï¿¼");Ye(k,o.find,i).forEach(w=>{if(w.index===void 0)return;const x=y+w.index+1,E=x+w[0].length,O={from:n.tr.mapping.map(x),to:n.tr.mapping.map(E)},$=o.handler({state:n,range:O,match:w,commands:l,chain:c,can:p,pasteEvent:i,dropEvent:a});d.push($)})}),d.every(f=>f!==null)}function Xe(e){const{editor:t,rules:n}=e;let r=null,s=!1,o=!1,i=new ClipboardEvent("paste"),a=new DragEvent("drop");return n.map(c=>new P({view(p){const d=u=>{var f;r=!((f=p.dom.parentElement)===null||f===void 0)&&f.contains(u.target)?p.dom.parentElement:null};return window.addEventListener("dragstart",d),{destroy(){window.removeEventListener("dragstart",d)}}},props:{handleDOMEvents:{drop:(p,d)=>(o=r===p.dom.parentElement,a=d,!1),paste:(p,d)=>{var u;const f=(u=d.clipboardData)===null||u===void 0?void 0:u.getData("text/html");return i=d,s=!!(f!=null&&f.includes("data-pm-slice")),!1}}},appendTransaction:(p,d,u)=>{const f=p[0],m=f.getMeta("uiEvent")==="paste"&&!s,y=f.getMeta("uiEvent")==="drop"&&!o;if(!m&&!y)return;const h=d.doc.content.findDiffStart(u.doc.content),k=d.doc.content.findDiffEnd(u.doc.content);if(!Ge(h)||!k||h===k.b)return;const b=u.tr,w=G({state:u,transaction:b});if(!(!Qe({editor:t,state:w,from:Math.max(h-1,0),to:k.b-1,rule:c,pasteEvent:i,dropEvent:a})||!b.steps.length))return a=new DragEvent("drop"),i=new ClipboardEvent("paste"),b}}))}function Ze(e){const t=e.filter((n,r)=>e.indexOf(n)!==r);return[...new Set(t)]}class j{constructor(t,n){this.splittableMarks=[],this.editor=n,this.extensions=j.resolve(t),this.schema=We(this.extensions,n),this.extensions.forEach(r=>{var s;this.editor.extensionStorage[r.name]=r.storage;const o={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:rt(r.name,this.schema)};r.type==="mark"&&(!((s=M(g(r,"keepOnSplit",o)))!==null&&s!==void 0)||s)&&this.splittableMarks.push(r.name);const i=g(r,"onBeforeCreate",o);i&&this.editor.on("beforeCreate",i);const a=g(r,"onCreate",o);a&&this.editor.on("create",a);const l=g(r,"onUpdate",o);l&&this.editor.on("update",l);const c=g(r,"onSelectionUpdate",o);c&&this.editor.on("selectionUpdate",c);const p=g(r,"onTransaction",o);p&&this.editor.on("transaction",p);const d=g(r,"onFocus",o);d&&this.editor.on("focus",d);const u=g(r,"onBlur",o);u&&this.editor.on("blur",u);const f=g(r,"onDestroy",o);f&&this.editor.on("destroy",f)})}static resolve(t){const n=j.sort(j.flatten(t)),r=Ze(n.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),n}static flatten(t){return t.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},s=g(n,"addExtensions",r);return s?[n,...this.flatten(s())]:n}).flat(10)}static sort(t){return t.sort((r,s)=>{const o=g(r,"priority")||100,i=g(s,"priority")||100;return o>i?-1:o<i?1:0})}get commands(){return this.extensions.reduce((t,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:rt(n.name,this.schema)},s=g(n,"addCommands",r);return s?{...t,...s()}:t},{})}get plugins(){const{editor:t}=this,n=j.sort([...this.extensions].reverse()),r=[],s=[],o=n.map(i=>{const a={name:i.name,options:i.options,storage:i.storage,editor:t,type:rt(i.name,this.schema)},l=[],c=g(i,"addKeyboardShortcuts",a);let p={};if(i.type==="mark"&&i.config.exitable&&(p.ArrowRight=()=>L.handleExit({editor:t,mark:i})),c){const y=Object.fromEntries(Object.entries(c()).map(([h,k])=>[h,()=>k({editor:t})]));p={...p,...y}}const d=Le(p);l.push(d);const u=g(i,"addInputRules",a);At(i,t.options.enableInputRules)&&u&&r.push(...u());const f=g(i,"addPasteRules",a);At(i,t.options.enablePasteRules)&&f&&s.push(...f());const m=g(i,"addProseMirrorPlugins",a);if(m){const y=m();l.push(...y)}return l}).flat();return[Ue({editor:t,rules:r}),...Xe({editor:t,rules:s}),...o]}get attributes(){return Nt(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:n}=Y(this.extensions);return Object.fromEntries(n.filter(r=>!!g(r,"addNodeView")).map(r=>{const s=this.attributes.filter(l=>l.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:t,type:S(r.name,this.schema)},i=g(r,"addNodeView",o);if(!i)return[];const a=(l,c,p,d)=>{const u=ct(l,s);return i()({editor:t,node:l,getPos:p,decorations:d,HTMLAttributes:u,extension:r})};return[r.name,a]}))}}function tn(e){return Object.prototype.toString.call(e).slice(8,-1)}function ot(e){return tn(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function X(e,t){const n={...e};return ot(e)&&ot(t)&&Object.keys(t).forEach(r=>{ot(t[r])?r in e?n[r]=X(e[r],t[r]):Object.assign(n,{[r]:t[r]}):Object.assign(n,{[r]:t[r]})}),n}class C{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=M(g(this,"addOptions",{name:this.name}))),this.storage=M(g(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new C(t)}configure(t={}){const n=this.extend();return n.options=X(this.options,t),n.storage=M(g(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new C({...this.config,...t});return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=M(g(n,"addOptions",{name:n.name})),n.storage=M(g(n,"addStorage",{name:n.name,options:n.options})),n}}function jt(e,t,n){const{from:r,to:s}=t,{blockSeparator:o=`

`,textSerializers:i={}}=n||{};let a="",l=!0;return e.nodesBetween(r,s,(c,p,d,u)=>{var f;const m=i==null?void 0:i[c.type.name];m?(c.isBlock&&!l&&(a+=o,l=!0),d&&(a+=m({node:c,pos:p,parent:d,index:u,range:t}))):c.isText?(a+=(f=c==null?void 0:c.text)===null||f===void 0?void 0:f.slice(Math.max(r,p)-p,s-p),l=!1):c.isBlock&&!l&&(a+=o,l=!0)}),a}function Ft(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,n])=>[t,n.spec.toText]))}const en=C.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new P({key:new B("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:s}=t,{ranges:o}=s,i=Math.min(...o.map(p=>p.$from.pos)),a=Math.max(...o.map(p=>p.$to.pos)),l=Ft(n);return jt(r,{from:i,to:a},{textSerializers:l})}}})]}}),nn=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),rn=(e=!1)=>({commands:t})=>t.setContent("",e),sn=()=>({state:e,tr:t,dispatch:n})=>{const{selection:r}=t,{ranges:s}=r;return n&&s.forEach(({$from:o,$to:i})=>{e.doc.nodesBetween(o.pos,i.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:p}=t,d=c.resolve(p.map(l)),u=c.resolve(p.map(l+a.nodeSize)),f=d.blockRange(u);if(!f)return;const m=se(f);if(a.type.isTextblock){const{defaultType:y}=d.parent.contentMatchAt(d.index());t.setNodeMarkup(f.start,y)}(m||m===0)&&t.lift(f,m)})}),!0},on=e=>t=>e(t),an=()=>({state:e,dispatch:t})=>oe(e,t),cn=(e,t)=>({editor:n,tr:r})=>{const{state:s}=n,o=s.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);const i=r.mapping.map(t);return r.insert(i,o.content),r.setSelection(new A(r.doc.resolve(i-1))),!0},ln=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,r=n.$anchor.node();if(r.content.size>0)return!1;const s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===r.type){if(t){const a=s.before(o),l=s.after(o);e.delete(a,l).scrollIntoView()}return!0}return!1},dn=e=>({tr:t,state:n,dispatch:r})=>{const s=S(e,n.schema),o=t.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===s){if(r){const l=o.before(i),c=o.after(i);t.delete(l,c).scrollIntoView()}return!0}return!1},un=e=>({tr:t,dispatch:n})=>{const{from:r,to:s}=e;return n&&t.delete(r,s),!0},pn=()=>({state:e,dispatch:t})=>ie(e,t),fn=()=>({commands:e})=>e.keyboardShortcut("Enter"),hn=()=>({state:e,dispatch:t})=>ae(e,t);function q(e,t,n={strict:!0}){const r=Object.keys(t);return r.length?r.every(s=>n.strict?t[s]===e[s]:mt(t[s])?t[s].test(e[s]):t[s]===e[s]):!0}function lt(e,t,n={}){return e.find(r=>r.type===t&&q(r.attrs,n))}function mn(e,t,n={}){return!!lt(e,t,n)}function gt(e,t,n={}){if(!e||!t)return;let r=e.parent.childAfter(e.parentOffset);if(e.parentOffset===r.offset&&r.offset!==0&&(r=e.parent.childBefore(e.parentOffset)),!r.node)return;const s=lt([...r.node.marks],t,n);if(!s)return;let o=r.index,i=e.start()+r.offset,a=o+1,l=i+r.node.nodeSize;for(lt([...r.node.marks],t,n);o>0&&s.isInSet(e.parent.child(o-1).marks);)o-=1,i-=e.parent.child(o).nodeSize;for(;a<e.parent.childCount&&mn([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:i,to:l}}function H(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}const gn=(e,t={})=>({tr:n,state:r,dispatch:s})=>{const o=H(e,r.schema),{doc:i,selection:a}=n,{$from:l,from:c,to:p}=a;if(s){const d=gt(l,o,t);if(d&&d.from<=c&&d.to>=p){const u=A.create(i,d.from,d.to);n.setSelection(u)}}return!0},yn=e=>t=>{const n=typeof e=="function"?e(t):e;for(let r=0;r<n.length;r+=1)if(n[r](t))return!0;return!1};function Dt(e){return e instanceof A}function N(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function _t(e,t=null){if(!t)return null;const n=F.atStart(e),r=F.atEnd(e);if(t==="start"||t===!0)return n;if(t==="end")return r;const s=n.from,o=r.to;return t==="all"?A.create(e,N(0,s,o),N(e.content.size,s,o)):A.create(e,N(t,s,o),N(t,s,o))}function yt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const kn=(e=null,t={})=>({editor:n,view:r,tr:s,dispatch:o})=>{t={scrollIntoView:!0,...t};const i=()=>{yt()&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),t!=null&&t.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&e===null||e===!1)return!0;if(o&&e===null&&!Dt(n.state.selection))return i(),!0;const a=_t(s.doc,e)||n.state.selection,l=n.state.selection.eq(a);return o&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),i()),!0},bn=(e,t)=>n=>e.every((r,s)=>t(r,{...n,index:s})),Mn=(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),zt=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const r=t[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):r.nodeType===1&&zt(r)}return e};function xt(e){const t=`<body>${e}</body>`,n=new window.DOMParser().parseFromString(t,"text/html").body;return zt(n)}function U(e,t,n){if(n={slice:!0,parseOptions:{},...n},typeof e=="object"&&e!==null)try{return Array.isArray(e)&&e.length>0?W.fromArray(e.map(r=>t.nodeFromJSON(r))):t.nodeFromJSON(e)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),U("",t,n)}if(typeof e=="string"){const r=Oe.fromSchema(t);return n.slice?r.parseSlice(xt(e),n.parseOptions).content:r.parse(xt(e),n.parseOptions)}return U("",t,n)}function vn(e,t,n){const r=e.steps.length-1;if(r<t)return;const s=e.steps[r];if(!(s instanceof Pe||s instanceof $e))return;const o=e.mapping.maps[r];let i=0;o.forEach((a,l,c,p)=>{i===0&&(i=p)}),e.setSelection(F.near(e.doc.resolve(i),n))}const wn=e=>e.toString().startsWith("<"),Sn=(e,t,n)=>({tr:r,dispatch:s,editor:o})=>{if(s){n={parseOptions:{},updateSelection:!0,...n};const i=U(t,o.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions}});if(i.toString()==="<>")return!0;let{from:a,to:l}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},c=!0,p=!0;if((wn(i)?i:[i]).forEach(u=>{u.check(),c=c?u.isText&&u.marks.length===0:!1,p=p?u.isBlock:!1}),a===l&&p){const{parent:u}=r.doc.resolve(a);u.isTextblock&&!u.type.spec.code&&!u.childCount&&(a-=1,l+=1)}c?Array.isArray(t)?r.insertText(t.map(u=>u.text||"").join(""),a,l):typeof t=="object"&&t&&t.text?r.insertText(t.text,a,l):r.insertText(t,a,l):r.replaceWith(a,l,i),n.updateSelection&&vn(r,r.steps.length-1,-1)}return!0},Tn=()=>({state:e,dispatch:t})=>ce(e,t),An=()=>({state:e,dispatch:t})=>le(e,t),xn=()=>({state:e,dispatch:t})=>de(e,t),En=()=>({state:e,dispatch:t})=>ue(e,t),Cn=()=>({tr:e,state:t,dispatch:n})=>{try{const r=It(t.doc,t.selection.$from.pos,-1);return r==null?!1:(e.join(r,2),n&&n(e),!0)}catch{return!1}},Ln=()=>({state:e,dispatch:t,tr:n})=>{try{const r=It(e.doc,e.selection.$from.pos,1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},On=()=>({state:e,dispatch:t})=>pe(e,t),Pn=()=>({state:e,dispatch:t})=>fe(e,t);function kt(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function $n(e){const t=e.split(/-(?!$)/);let n=t[t.length-1];n==="Space"&&(n=" ");let r,s,o,i;for(let a=0;a<t.length-1;a+=1){const l=t[a];if(/^(cmd|meta|m)$/i.test(l))i=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))yt()||kt()?i=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),i&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}const Bn=e=>({editor:t,view:n,tr:r,dispatch:s})=>{const o=$n(e).split(/-(?!$)/),i=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,a))});return l==null||l.steps.forEach(c=>{const p=c.map(r.mapping);p&&s&&r.maybeStep(p)}),!0};function _(e,t,n={}){const{from:r,to:s,empty:o}=e.selection,i=t?S(t,e.schema):null,a=[];e.doc.nodesBetween(r,s,(d,u)=>{if(d.isText)return;const f=Math.max(r,u),m=Math.min(s,u+d.nodeSize);a.push({node:d,from:f,to:m})});const l=s-r,c=a.filter(d=>i?i.name===d.node.type.name:!0).filter(d=>q(d.node.attrs,n,{strict:!1}));return o?!!c.length:c.reduce((d,u)=>d+u.to-u.from,0)>=l}const Hn=(e,t={})=>({state:n,dispatch:r})=>{const s=S(e,n.schema);return _(n,s,t)?he(n,r):!1},In=()=>({state:e,dispatch:t})=>me(e,t),Nn=e=>({state:t,dispatch:n})=>{const r=S(e,t.schema);return ge(r)(t,n)},Rn=()=>({state:e,dispatch:t})=>ye(e,t);function Z(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function Et(e,t){const n=typeof t=="string"?[t]:t;return Object.keys(e).reduce((r,s)=>(n.includes(s)||(r[s]=e[s]),r),{})}const jn=(e,t)=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const a=Z(typeof e=="string"?e:e.name,r.schema);return a?(a==="node"&&(o=S(e,r.schema)),a==="mark"&&(i=H(e,r.schema)),s&&n.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,p)=>{o&&o===c.type&&n.setNodeMarkup(p,void 0,Et(c.attrs,t)),i&&c.marks.length&&c.marks.forEach(d=>{i===d.type&&n.addMark(p,p+c.nodeSize,i.create(Et(d.attrs,t)))})})}),!0):!1},Fn=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),Dn=()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size}),_n=()=>({state:e,dispatch:t})=>ke(e,t),zn=()=>({state:e,dispatch:t})=>be(e,t),Kn=()=>({state:e,dispatch:t})=>Me(e,t),Wn=()=>({state:e,dispatch:t})=>ve(e,t),Vn=()=>({state:e,dispatch:t})=>we(e,t);function Kt(e,t,n={}){return U(e,t,{slice:!1,parseOptions:n})}const qn=(e,t=!1,n={})=>({tr:r,editor:s,dispatch:o})=>{const{doc:i}=r,a=Kt(e,s.schema,n);return o&&r.replaceWith(0,i.content.size,a).setMeta("preventUpdate",!t),!0};function tt(e,t){const n=H(t,e.schema),{from:r,to:s,empty:o}=e.selection,i=[];o?(e.storedMarks&&i.push(...e.storedMarks),i.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,s,l=>{i.push(...l.marks)});const a=i.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function Un(e,t){const n=new re(e);return t.forEach(r=>{r.steps.forEach(s=>{n.step(s)})}),n}function Gn(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function Jn(e,t,n){const r=[];return e.nodesBetween(t.from,t.to,(s,o)=>{n(s)&&r.push({node:s,pos:o})}),r}function Yn(e,t){for(let n=e.depth;n>0;n-=1){const r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}function bt(e){return t=>Yn(t.$from,e)}function Qn(e,t){const n=Be.fromSchema(t).serializeFragment(e),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}function Xn(e,t){const n={from:0,to:e.content.size};return jt(e,n,t)}function Zn(e,t){const n=S(t,e.schema),{from:r,to:s}=e.selection,o=[];e.doc.nodesBetween(r,s,a=>{o.push(a)});const i=o.reverse().find(a=>a.type.name===n.name);return i?{...i.attrs}:{}}function Wt(e,t){const n=Z(typeof t=="string"?t:t.name,e.schema);return n==="node"?Zn(e,t):n==="mark"?tt(e,t):{}}function tr(e,t=JSON.stringify){const n={};return e.filter(r=>{const s=t(r);return Object.prototype.hasOwnProperty.call(n,s)?!1:n[s]=!0})}function er(e){const t=tr(e);return t.length===1?t:t.filter((n,r)=>!t.filter((o,i)=>i!==r).some(o=>n.oldRange.from>=o.oldRange.from&&n.oldRange.to<=o.oldRange.to&&n.newRange.from>=o.newRange.from&&n.newRange.to<=o.newRange.to))}function nr(e){const{mapping:t,steps:n}=e,r=[];return t.maps.forEach((s,o)=>{const i=[];if(s.ranges.length)s.forEach((a,l)=>{i.push({from:a,to:l})});else{const{from:a,to:l}=n[o];if(a===void 0||l===void 0)return;i.push({from:a,to:l})}i.forEach(({from:a,to:l})=>{const c=t.slice(o).map(a,-1),p=t.slice(o).map(l),d=t.invert().map(c,-1),u=t.invert().map(p);r.push({oldRange:{from:d,to:u},newRange:{from:c,to:p}})})}),er(r)}function Mt(e,t,n){const r=[];return e===t?n.resolve(e).marks().forEach(s=>{const o=n.resolve(e-1),i=gt(o,s.type);i&&r.push({mark:s,...i})}):n.nodesBetween(e,t,(s,o)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(i=>({from:o,to:o+s.nodeSize,mark:i})))}),r}function V(e,t,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=e.find(o=>o.type===t&&o.name===r);return s?s.attribute.keepOnSplit:!1}))}function dt(e,t,n={}){const{empty:r,ranges:s}=e.selection,o=t?H(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(d=>o?o.name===d.type.name:!0).find(d=>q(d.attrs,n,{strict:!1}));let i=0;const a=[];if(s.forEach(({$from:d,$to:u})=>{const f=d.pos,m=u.pos;e.doc.nodesBetween(f,m,(y,h)=>{if(!y.isText&&!y.marks.length)return;const k=Math.max(f,h),b=Math.min(m,h+y.nodeSize),w=b-k;i+=w,a.push(...y.marks.map(x=>({mark:x,from:k,to:b})))})}),i===0)return!1;const l=a.filter(d=>o?o.name===d.mark.type.name:!0).filter(d=>q(d.mark.attrs,n,{strict:!1})).reduce((d,u)=>d+u.to-u.from,0),c=a.filter(d=>o?d.mark.type!==o&&d.mark.type.excludes(o):!0).reduce((d,u)=>d+u.to-u.from,0);return(l>0?l+c:l)>=i}function rr(e,t,n={}){if(!t)return _(e,null,n)||dt(e,null,n);const r=Z(t,e.schema);return r==="node"?_(e,t,n):r==="mark"?dt(e,t,n):!1}function Ct(e,t){const{nodeExtensions:n}=Y(t),r=n.find(i=>i.name===e);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},o=M(g(r,"group",s));return typeof o!="string"?!1:o.split(" ").includes("list")}function sr(e){var t;const n=(t=e.type.createAndFill())===null||t===void 0?void 0:t.toJSON(),r=e.toJSON();return JSON.stringify(n)===JSON.stringify(r)}function or(e,t,n){var r;const{selection:s}=t;let o=null;if(Dt(s)&&(o=s.$cursor),o){const a=(r=e.storedMarks)!==null&&r!==void 0?r:o.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:i}=s;return i.some(({$from:a,$to:l})=>{let c=a.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(n):!1;return e.doc.nodesBetween(a.pos,l.pos,(p,d,u)=>{if(c)return!1;if(p.isInline){const f=!u||u.type.allowsMarkType(n),m=!!n.isInSet(p.marks)||!p.marks.some(y=>y.type.excludes(n));c=f&&m}return!c}),c})}const ir=(e,t={})=>({tr:n,state:r,dispatch:s})=>{const{selection:o}=n,{empty:i,ranges:a}=o,l=H(e,r.schema);if(s)if(i){const c=tt(r,l);n.addStoredMark(l.create({...c,...t}))}else a.forEach(c=>{const p=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(p,d,(u,f)=>{const m=Math.max(f,p),y=Math.min(f+u.nodeSize,d);u.marks.find(k=>k.type===l)?u.marks.forEach(k=>{l===k.type&&n.addMark(m,y,l.create({...k.attrs,...t}))}):n.addMark(m,y,l.create(t))})});return or(r,n,l)},ar=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),cr=(e,t={})=>({state:n,dispatch:r,chain:s})=>{const o=S(e,n.schema);return o.isTextblock?s().command(({commands:i})=>vt(o,t)(n)?!0:i.clearNodes()).command(({state:i})=>vt(o,t)(i,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},lr=e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,s=N(e,0,r.content.size),o=ft.create(r,s);t.setSelection(o)}return!0},dr=e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,{from:s,to:o}=typeof e=="number"?{from:e,to:e}:e,i=A.atStart(r).from,a=A.atEnd(r).to,l=N(s,i,a),c=N(o,i,a),p=A.create(r,l,c);t.setSelection(p)}return!0},ur=e=>({state:t,dispatch:n})=>{const r=S(e,t.schema);return Se(r)(t,n)};function Lt(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const r=n.filter(s=>t==null?void 0:t.includes(s.type.name));e.tr.ensureMarks(r)}}const pr=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:s})=>{const{selection:o,doc:i}=t,{$from:a,$to:l}=o,c=s.extensionManager.attributes,p=V(c,a.node().type.name,a.node().attrs);if(o instanceof ft&&o.node.isBlock)return!a.parentOffset||!K(i,a.pos)?!1:(r&&(e&&Lt(n,s.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(r){const d=l.parentOffset===l.parent.content.size;o instanceof A&&t.deleteSelection();const u=a.depth===0?void 0:Gn(a.node(-1).contentMatchAt(a.indexAfter(-1)));let f=d&&u?[{type:u,attrs:p}]:void 0,m=K(t.doc,t.mapping.map(a.pos),1,f);if(!f&&!m&&K(t.doc,t.mapping.map(a.pos),1,u?[{type:u}]:void 0)&&(m=!0,f=u?[{type:u,attrs:p}]:void 0),m&&(t.split(t.mapping.map(a.pos),1,f),u&&!d&&!a.parentOffset&&a.parent.type!==u)){const y=t.mapping.map(a.before()),h=t.doc.resolve(y);a.node(-1).canReplaceWith(h.index(),h.index()+1,u)&&t.setNodeMarkup(t.mapping.map(a.before()),u)}e&&Lt(n,s.extensionManager.splittableMarks),t.scrollIntoView()}return!0},fr=e=>({tr:t,state:n,dispatch:r,editor:s})=>{var o;const i=S(e,n.schema),{$from:a,$to:l}=n.selection,c=n.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const p=a.node(-1);if(p.type!==i)return!1;const d=s.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==i||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let h=W.empty;const k=a.index(-1)?1:a.index(-2)?2:3;for(let $=a.depth-k;$>=a.depth-3;$-=1)h=W.from(a.node($).copy(h));const b=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,w=V(d,a.node().type.name,a.node().attrs),x=((o=i.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(w))||void 0;h=h.append(W.from(i.createAndFill(null,x)||void 0));const E=a.before(a.depth-(k-1));t.replace(E,a.after(-b),new Te(h,4-k,0));let O=-1;t.doc.nodesBetween(E,t.doc.content.size,($,et)=>{if(O>-1)return!1;$.isTextblock&&$.content.size===0&&(O=et+1)}),O>-1&&t.setSelection(A.near(t.doc.resolve(O))),t.scrollIntoView()}return!0}const u=l.pos===a.end()?p.contentMatchAt(0).defaultType:null,f=V(d,p.type.name,p.attrs),m=V(d,a.node().type.name,a.node().attrs);t.delete(a.pos,l.pos);const y=u?[{type:i,attrs:f},{type:u,attrs:m}]:[{type:i,attrs:f}];if(!K(t.doc,a.pos,2))return!1;if(r){const{selection:h,storedMarks:k}=n,{splittableMarks:b}=s.extensionManager,w=k||h.$to.parentOffset&&h.$from.marks();if(t.split(a.pos,2,y).scrollIntoView(),!w||!r)return!0;const x=w.filter(E=>b.includes(E.type.name));t.ensureMarks(x)}return!0},it=(e,t)=>{const n=bt(i=>i.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=e.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&pt(e.doc,n.pos)&&e.join(n.pos),!0},at=(e,t)=>{const n=bt(i=>i.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=e.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&pt(e.doc,r)&&e.join(r),!0},hr=(e,t,n,r={})=>({editor:s,tr:o,state:i,dispatch:a,chain:l,commands:c,can:p})=>{const{extensions:d,splittableMarks:u}=s.extensionManager,f=S(e,i.schema),m=S(t,i.schema),{selection:y,storedMarks:h}=i,{$from:k,$to:b}=y,w=k.blockRange(b),x=h||y.$to.parentOffset&&y.$from.marks();if(!w)return!1;const E=bt(O=>Ct(O.type.name,d))(y);if(w.depth>=1&&E&&w.depth-E.depth<=1){if(E.node.type===f)return c.liftListItem(m);if(Ct(E.node.type.name,d)&&f.validContent(E.node.content)&&a)return l().command(()=>(o.setNodeMarkup(E.pos,f),!0)).command(()=>it(o,f)).command(()=>at(o,f)).run()}return!n||!x||!a?l().command(()=>p().wrapInList(f,r)?!0:c.clearNodes()).wrapInList(f,r).command(()=>it(o,f)).command(()=>at(o,f)).run():l().command(()=>{const O=p().wrapInList(f,r),$=x.filter(et=>u.includes(et.type.name));return o.ensureMarks($),O?!0:c.clearNodes()}).wrapInList(f,r).command(()=>it(o,f)).command(()=>at(o,f)).run()},mr=(e,t={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:o=!1}=n,i=H(e,r.schema);return dt(r,i,t)?s.unsetMark(i,{extendEmptyMarkRange:o}):s.setMark(i,t)},gr=(e,t,n={})=>({state:r,commands:s})=>{const o=S(e,r.schema),i=S(t,r.schema);return _(r,o,n)?s.setNode(i):s.setNode(o,n)},yr=(e,t={})=>({state:n,commands:r})=>{const s=S(e,n.schema);return _(n,s,t)?r.lift(s):r.wrapIn(s,t)},kr=()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let o;if(s.spec.isInputRules&&(o=s.getState(e))){if(t){const i=e.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)i.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=i.doc.resolve(o.from).marks();i.replaceWith(o.from,o.to,e.schema.text(o.text,l))}else i.delete(o.from,o.to)}return!0}}return!1},br=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:r,ranges:s}=n;return r||t&&s.forEach(o=>{e.removeMark(o.$from.pos,o.$to.pos)}),!0},Mr=(e,t={})=>({tr:n,state:r,dispatch:s})=>{var o;const{extendEmptyMarkRange:i=!1}=t,{selection:a}=n,l=H(e,r.schema),{$from:c,empty:p,ranges:d}=a;if(!s)return!0;if(p&&i){let{from:u,to:f}=a;const m=(o=c.marks().find(h=>h.type===l))===null||o===void 0?void 0:o.attrs,y=gt(c,l,m);y&&(u=y.from,f=y.to),n.removeMark(u,f,l)}else d.forEach(u=>{n.removeMark(u.$from.pos,u.$to.pos,l)});return n.removeStoredMark(l),!0},vr=(e,t={})=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const a=Z(typeof e=="string"?e:e.name,r.schema);return a?(a==="node"&&(o=S(e,r.schema)),a==="mark"&&(i=H(e,r.schema)),s&&n.selection.ranges.forEach(l=>{const c=l.$from.pos,p=l.$to.pos;r.doc.nodesBetween(c,p,(d,u)=>{o&&o===d.type&&n.setNodeMarkup(u,void 0,{...d.attrs,...t}),i&&d.marks.length&&d.marks.forEach(f=>{if(i===f.type){const m=Math.max(u,c),y=Math.min(u+d.nodeSize,p);n.addMark(m,y,i.create({...f.attrs,...t}))}})})}),!0):!1},wr=(e,t={})=>({state:n,dispatch:r})=>{const s=S(e,n.schema);return Ae(s,t)(n,r)},Sr=(e,t={})=>({state:n,dispatch:r})=>{const s=S(e,n.schema);return xe(s,t)(n,r)};var Tr=Object.freeze({__proto__:null,blur:nn,clearContent:rn,clearNodes:sn,command:on,createParagraphNear:an,cut:cn,deleteCurrentNode:ln,deleteNode:dn,deleteRange:un,deleteSelection:pn,enter:fn,exitCode:hn,extendMarkRange:gn,first:yn,focus:kn,forEach:bn,insertContent:Mn,insertContentAt:Sn,joinUp:Tn,joinDown:An,joinBackward:xn,joinForward:En,joinItemBackward:Cn,joinItemForward:Ln,joinTextblockBackward:On,joinTextblockForward:Pn,keyboardShortcut:Bn,lift:Hn,liftEmptyBlock:In,liftListItem:Nn,newlineInCode:Rn,resetAttributes:jn,scrollIntoView:Fn,selectAll:Dn,selectNodeBackward:_n,selectNodeForward:zn,selectParentNode:Kn,selectTextblockEnd:Wn,selectTextblockStart:Vn,setContent:qn,setMark:ir,setMeta:ar,setNode:cr,setNodeSelection:lr,setTextSelection:dr,sinkListItem:ur,splitBlock:pr,splitListItem:fr,toggleList:hr,toggleMark:mr,toggleNode:gr,toggleWrap:yr,undoInputRule:kr,unsetAllMarks:br,unsetMark:Mr,updateAttributes:vr,wrapIn:wr,wrapInList:Sr});const Ar=C.create({name:"commands",addCommands(){return{...Tr}}}),xr=C.create({name:"editable",addProseMirrorPlugins(){return[new P({key:new B("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Er=C.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new P({key:new B("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;const r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),Cr=C.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:p,$anchor:d}=l,{pos:u,parent:f}=d,m=d.parent.isTextblock?a.doc.resolve(u-1):d,y=m.parent.type.spec.isolating,h=d.pos-d.parentOffset,k=y&&m.parent.childCount===1?h===d.pos:F.atStart(c).from===u;return!p||!k||!f.type.isTextblock||f.textContent.length?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},o={...r,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return yt()||kt()?o:s},addProseMirrorPlugins(){return[new P({key:new B("clearDocument"),appendTransaction:(e,t,n)=>{if(!(e.some(m=>m.docChanged)&&!t.doc.eq(n.doc)))return;const{empty:s,from:o,to:i}=t.selection,a=F.atStart(t.doc).from,l=F.atEnd(t.doc).to;if(s||!(o===a&&i===l)||!(n.doc.textBetween(0,n.doc.content.size," "," ").length===0))return;const d=n.tr,u=G({state:n,transaction:d}),{commands:f}=new J({editor:this.editor,state:u});if(f.clearNodes(),!!d.steps.length)return d}})]}}),Lr=C.create({name:"tabindex",addProseMirrorPlugins(){return[new P({key:new B("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var Or=Object.freeze({__proto__:null,ClipboardTextSerializer:en,Commands:Ar,Editable:xr,FocusEvents:Er,Keymap:Cr,Tabindex:Lr});class I{constructor(t,n,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=t,this.editor=n,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!==null&&t!==void 0?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You canât set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(t);return new I(n,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new I(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new I(t,this.editor)}get children(){const t=[];return this.node.content.forEach((n,r)=>{const s=n.isBlock&&!n.isTextblock,o=this.pos+r+(s?0:1),i=this.resolvedPos.doc.resolve(o);if(!s&&i.depth<=this.depth)return;const a=new I(i,this.editor,s,s?n:null);s&&(a.actualDepth=this.depth+1),t.push(new I(i,this.editor,s,s?n:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,n={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===t)if(Object.keys(n).length>0){const o=s.node.attrs,i=Object.keys(n);for(let a=0;a<i.length;a+=1){const l=i[a];if(o[l]!==n[l])break}}else r=s;s=s.parent}return r}querySelector(t,n={}){return this.querySelectorAll(t,n,!0)[0]||null}querySelectorAll(t,n={},r=!1){let s=[];return this.isBlock||!this.children||this.children.length===0||this.children.forEach(o=>{if(o.node.type.name===t){if(Object.keys(n).length>0){const i=o.node.attrs,a=Object.keys(n);for(let l=0;l<a.length;l+=1){const c=a[l];if(i[c]!==n[c])return}}if(s.push(o),r)return}s=s.concat(o.querySelectorAll(t))}),s}setAttribute(t){const n=this.editor.state.selection;this.editor.chain().setTextSelection(this.from).updateAttributes(this.node.type.name,t).setTextSelection(n.from).run()}}const Pr=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function $r(e,t,n){const r=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(r!==null)return r;const s=document.createElement("style");return t&&s.setAttribute("nonce",t),s.setAttribute(`data-tiptap-style${n?`-${n}`:""}`,""),s.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(s),s}let Br=class extends _e{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=$r(Pr,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,n=!0){this.setOptions({editable:t}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,n){const r=Rt(n)?n(t,[...this.state.plugins]):[...this.state.plugins,t],s=this.state.reconfigure({plugins:r});this.view.updateState(s)}unregisterPlugin(t){if(this.isDestroyed)return;const n=typeof t=="string"?`${t}$`:t.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(s=>!s.key.startsWith(n))});this.view.updateState(r)}createExtensionManager(){const n=[...this.options.enableCoreExtensions?Object.values(Or):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(r==null?void 0:r.type));this.extensionManager=new j(n,this)}createCommandManager(){this.commandManager=new J({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=Kt(this.options.content,this.schema,this.options.parseOptions),n=_t(t,this.options.autofocus);this.view=new Ee(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:Ce.create({doc:t,selection:n||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(i=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(i)});return}const n=this.state.apply(t),r=!this.state.selection.eq(n.selection);this.view.updateState(n),this.emit("transaction",{editor:this,transaction:t}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const s=t.getMeta("focus"),o=t.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:t}),o&&this.emit("blur",{editor:this,event:o.event,transaction:t}),!(!t.docChanged||t.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return Wt(this.state,t)}isActive(t,n){const r=typeof t=="string"?t:null,s=typeof t=="string"?n:t;return rr(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Qn(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:n=`

`,textSerializers:r={}}=t||{};return Xn(this.state.doc,{blockSeparator:n,textSerializers:{...Ft(this.schema),...r}})}get isEmpty(){return sr(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(!((t=this.view)===null||t===void 0)&&t.docView)}$node(t,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(t,n))||null}$nodes(t,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(t,n))||null}$pos(t){const n=this.state.doc.resolve(t);return new I(n,this)}get $doc(){return this.$pos(0)}};function D(e){return new Q({find:e.find,handler:({state:t,range:n,match:r})=>{const s=M(e.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:o}=t,i=r[r.length-1],a=r[0];if(i){const l=a.search(/\S/),c=n.from+a.indexOf(i),p=c+i.length;if(Mt(n.from,n.to,t.doc).filter(f=>f.mark.type.excluded.find(y=>y===e.type&&y!==f.mark.type)).filter(f=>f.to>c).length)return null;p<n.to&&o.delete(p,n.to),c>n.from&&o.delete(n.from+l,c);const u=n.from+l+i.length;o.addMark(n.from+l,u,e.type.create(s||{})),o.removeStoredMark(e.type)}}})}function Hr(e){return new Q({find:e.find,handler:({state:t,range:n,match:r})=>{const s=M(e.getAttributes,void 0,r)||{},{tr:o}=t,i=n.from;let a=n.to;const l=e.type.create(s);if(r[1]){const c=r[0].lastIndexOf(r[1]);let p=i+c;p>a?p=a:a=p+r[1].length;const d=r[0][r[0].length-1];o.insertText(d,i+r[0].length-1),o.replaceWith(p,a,l)}else r[0]&&o.insert(i-1,e.type.create(s)).delete(o.mapping.map(i),o.mapping.map(a));o.scrollIntoView()}})}function ut(e){return new Q({find:e.find,handler:({state:t,range:n,match:r})=>{const s=t.doc.resolve(n.from),o=M(e.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,o)}})}function z(e){return new Q({find:e.find,handler:({state:t,range:n,match:r,chain:s})=>{const o=M(e.getAttributes,void 0,r)||{},i=t.tr.delete(n.from,n.to),l=i.doc.resolve(n.from).blockRange(),c=l&&ne(l,e.type,o);if(!c)return null;if(i.wrap(l,c),e.keepMarks&&e.editor){const{selection:d,storedMarks:u}=t,{splittableMarks:f}=e.editor.extensionManager,m=u||d.$to.parentOffset&&d.$from.marks();if(m){const y=m.filter(h=>f.includes(h.type.name));i.ensureMarks(y)}}if(e.keepAttributes){const d=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(d,o).run()}const p=i.doc.resolve(n.from-1).nodeBefore;p&&p.type===e.type&&pt(i.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(r,p))&&i.join(n.from-1)}})}class L{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=M(g(this,"addOptions",{name:this.name}))),this.storage=M(g(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new L(t)}configure(t={}){const n=this.extend();return n.options=X(this.options,t),n.storage=M(g(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new L({...this.config,...t});return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=M(g(n,"addOptions",{name:n.name})),n.storage=M(g(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:t,mark:n}){const{tr:r}=t.state,s=t.state.selection.$from;if(s.pos===s.end()){const i=s.marks();if(!!!i.find(c=>(c==null?void 0:c.type.name)===n.name))return!1;const l=i.find(c=>(c==null?void 0:c.type.name)===n.name);return l&&r.removeStoredMark(l),r.insertText(" ",s.pos),t.view.dispatch(r),!0}return!1}}class T{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=M(g(this,"addOptions",{name:this.name}))),this.storage=M(g(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new T(t)}configure(t={}){const n=this.extend();return n.options=X(this.options,t),n.storage=M(g(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new T({...this.config,...t});return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=M(g(n,"addOptions",{name:n.name})),n.storage=M(g(n,"addStorage",{name:n.name,options:n.options})),n}}function R(e){return new Je({find:e.find,handler:({state:t,range:n,match:r,pasteEvent:s})=>{const o=M(e.getAttributes,void 0,r,s);if(o===!1||o===null)return null;const{tr:i}=t,a=r[r.length-1],l=r[0];let c=n.to;if(a){const p=l.search(/\S/),d=n.from+l.indexOf(a),u=d+a.length;if(Mt(n.from,n.to,t.doc).filter(m=>m.mark.type.excluded.find(h=>h===e.type&&h!==m.mark.type)).filter(m=>m.to>d).length)return null;u<n.to&&i.delete(u,n.to),d>n.from&&i.delete(n.from+p,d),c=n.from+p+a.length,i.addMark(n.from+p,c,e.type.create(o||{})),i.removeStoredMark(e.type)}}})}function Ot(e){return ee((t,n)=>({get(){return t(),e},set(r){e=r,requestAnimationFrame(()=>{requestAnimationFrame(()=>{n()})})}}))}class ws extends Br{constructor(t={}){return super(t),this.vueRenderers=Vt(new Map),this.contentComponent=null,this.reactiveState=Ot(this.view.state),this.reactiveExtensionStorage=Ot(this.extensionStorage),this.on("transaction",()=>{this.reactiveState.value=this.view.state,this.reactiveExtensionStorage.value=this.extensionStorage}),qt(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(t,n){super.registerPlugin(t,n),this.reactiveState.value=this.view.state}unregisterPlugin(t){super.unregisterPlugin(t),this.reactiveState.value=this.view.state}}const Ss=Ut({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(e){const t=Gt(),n=Jt();return Yt(()=>{const r=e.editor;r&&r.options.element&&t.value&&Qt(()=>{if(!t.value||!r.options.element.firstChild)return;const s=Xt(t.value);t.value.append(...r.options.element.childNodes),r.contentComponent=n.ctx._,r.setOptions({element:s}),r.createNodeViews()})}),Zt(()=>{const r=e.editor;if(!r||(r.isDestroyed||r.view.setProps({nodeViews:{}}),r.contentComponent=null,!r.options.element.firstChild))return;const s=document.createElement("div");s.append(...r.options.element.childNodes),r.setOptions({element:s})}),{rootEl:t}},render(){const e=[];return this.editor&&this.editor.vueRenderers.forEach(t=>{const n=nt(te,{to:t.teleportElement,key:t.id},nt(t.component,{ref:t.id,...t.props}));e.push(n)}),nt("div",{ref:t=>{this.rootEl=t}},...e)}}),Ir=/^\s*>\s$/,Nr=T.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return["blockquote",v(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[z({find:Ir,type:this.type})]}}),Rr=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,jr=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,Fr=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,Dr=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,_r=L.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",v(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[D({find:Rr,type:this.type}),D({find:Fr,type:this.type})]},addPasteRules(){return[R({find:jr,type:this.type}),R({find:Dr,type:this.type})]}}),zr=T.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",v(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Pt=L.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",v(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=tt(e,this.type);return Object.entries(n).some(([,s])=>!!s)?!0:t.unsetMark(this.name)}}}}),$t=/^\s*([-+*])\s$/,Kr=T.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",v(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(zr.name,this.editor.getAttributes(Pt.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=z({find:$t,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=z({find:$t,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Pt.name),editor:this.editor})),[e]}}),Wr=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,Vr=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,qr=L.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",v(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[D({find:Wr,type:this.type})]},addPasteRules(){return[R({find:Vr,type:this.type})]}}),Ur=/^```([a-z]+)?[\s\n]$/,Gr=/^~~~([a-z]+)?[\s\n]$/,Jr=T.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,o=[...((t=e.firstElementChild)===null||t===void 0?void 0:t.classList)||[]].filter(i=>i.startsWith(n)).map(i=>i.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",v(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=t.pos===1;return!e||t.parent.type.name!==this.name?!1:n||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,i=r.parent.textContent.endsWith(`

`);return!o||!i?!1:e.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:r}=t,{$from:s,empty:o}=n;if(!o||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0||r.nodeAt(a)?!1:e.commands.exitCode()}}},addInputRules(){return[ut({find:Ur,type:this.type,getAttributes:e=>({language:e[1]})}),ut({find:Gr,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new P({key:new B("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,o=s==null?void 0:s.mode;if(!n||!o)return!1;const{tr:i}=e.state;return i.replaceSelectionWith(this.type.create({language:o})),i.setSelection(A.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.insertText(n.replace(/\r\n?/g,`
`)),i.setMeta("paste",!0),e.dispatch(i),!0}}})]}}),Yr=T.create({name:"doc",topNode:!0,content:"block+"}),Qr=C.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Ie(this.options)]}}),Xr=C.create({name:"gapCursor",addProseMirrorPlugins(){return[Ne()]},extendNodeSchema(e){var t;const n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=M(g(e,"allowGapCursor",n)))!==null&&t!==void 0?t:null}}}),Zr=T.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",v(this.options.HTMLAttributes,e)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:s,storedMarks:o}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:a}=r.extensionManager,l=o||s.$to.parentOffset&&s.$from.marks();return t().insertContent({type:this.name}).command(({tr:c,dispatch:p})=>{if(p&&l&&i){const d=l.filter(u=>a.includes(u.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),ts=T.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,v(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>ut({find:new RegExp(`^(#{1,${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),es=C.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>Re(e,t),redo:()=>({state:e,dispatch:t})=>je(e,t)}},addProseMirrorPlugins(){return[Fe(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-Ñ":()=>this.editor.commands.undo(),"Shift-Mod-Ñ":()=>this.editor.commands.redo()}}}),ns=T.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",v(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{const{$to:n}=t.selection,r=e();return n.parentOffset===0?r.insertContentAt(Math.max(n.pos-2,0),{type:this.name}):r.insertContent({type:this.name}),r.command(({tr:s,dispatch:o})=>{var i;if(o){const{$to:a}=s.selection,l=a.end();if(a.nodeAfter)a.nodeAfter.isTextblock?s.setSelection(A.create(s.doc,a.pos+1)):a.nodeAfter.isBlock?s.setSelection(ft.create(s.doc,a.pos)):s.setSelection(A.create(s.doc,a.pos));else{const c=(i=a.parent.type.contentMatch.defaultType)===null||i===void 0?void 0:i.create();c&&(s.insert(l,c),s.setSelection(A.create(s.doc,l+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Hr({find:/^(?:---|â-|___\s|\*\*\*\s)$/,type:this.type})]}}),rs=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,ss=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,os=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,is=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,as=L.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",v(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[D({find:rs,type:this.type}),D({find:os,type:this.type})]},addPasteRules(){return[R({find:ss,type:this.type}),R({find:is,type:this.type})]}}),cs=T.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",v(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),ls=T.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",v(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Bt=L.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",v(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=tt(e,this.type);return Object.entries(n).some(([,s])=>!!s)?!0:t.unsetMark(this.name)}}}}),Ht=/^(\d+)\.\s$/,ds=T.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...n}=e;return t===1?["ol",v(this.options.HTMLAttributes,n),0]:["ol",v(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(ls.name,this.editor.getAttributes(Bt.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=z({find:Ht,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=z({find:Ht,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(Bt.name)}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1],editor:this.editor})),[e]}}),us=T.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",v(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),ps=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,fs=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,hs=L.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",v(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){const e={};return kt()?e["Mod-Shift-s"]=()=>this.editor.commands.toggleStrike():e["Ctrl-Shift-s"]=()=>this.editor.commands.toggleStrike(),e},addInputRules(){return[D({find:ps,type:this.type})]},addPasteRules(){return[R({find:fs,type:this.type})]}}),ms=T.create({name:"text",group:"inline"}),Ts=C.create({name:"starterKit",addExtensions(){var e,t,n,r,s,o,i,a,l,c,p,d,u,f,m,y,h,k;const b=[];return this.options.blockquote!==!1&&b.push(Nr.configure((e=this.options)===null||e===void 0?void 0:e.blockquote)),this.options.bold!==!1&&b.push(_r.configure((t=this.options)===null||t===void 0?void 0:t.bold)),this.options.bulletList!==!1&&b.push(Kr.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&b.push(qr.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&b.push(Jr.configure((s=this.options)===null||s===void 0?void 0:s.codeBlock)),this.options.document!==!1&&b.push(Yr.configure((o=this.options)===null||o===void 0?void 0:o.document)),this.options.dropcursor!==!1&&b.push(Qr.configure((i=this.options)===null||i===void 0?void 0:i.dropcursor)),this.options.gapcursor!==!1&&b.push(Xr.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&b.push(Zr.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&b.push(ts.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&b.push(es.configure((p=this.options)===null||p===void 0?void 0:p.history)),this.options.horizontalRule!==!1&&b.push(ns.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&b.push(as.configure((u=this.options)===null||u===void 0?void 0:u.italic)),this.options.listItem!==!1&&b.push(cs.configure((f=this.options)===null||f===void 0?void 0:f.listItem)),this.options.orderedList!==!1&&b.push(ds.configure((m=this.options)===null||m===void 0?void 0:m.orderedList)),this.options.paragraph!==!1&&b.push(us.configure((y=this.options)===null||y===void 0?void 0:y.paragraph)),this.options.strike!==!1&&b.push(hs.configure((h=this.options)===null||h===void 0?void 0:h.strike)),this.options.text!==!1&&b.push(ms.configure((k=this.options)===null||k===void 0?void 0:k.text)),b}}),As=L.create({name:"superscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sup"},{style:"vertical-align",getAttrs(e){return e!=="super"?!1:null}}]},renderHTML({HTMLAttributes:e}){return["sup",v(this.options.HTMLAttributes,e),0]},addCommands(){return{setSuperscript:()=>({commands:e})=>e.setMark(this.name),toggleSuperscript:()=>({commands:e})=>e.toggleMark(this.name),unsetSuperscript:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-.":()=>this.editor.commands.toggleSuperscript()}}});function gs(e){return new P({key:new B("autolink"),appendTransaction:(t,n,r)=>{const s=t.some(c=>c.docChanged)&&!n.doc.eq(r.doc),o=t.some(c=>c.getMeta("preventAutolink"));if(!s||o)return;const{tr:i}=r,a=Un(n.doc,[...t]);if(nr(a).forEach(({newRange:c})=>{const p=Jn(r.doc,c,f=>f.isTextblock);let d,u;if(p.length>1?(d=p[0],u=r.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ")):p.length&&r.doc.textBetween(c.from,c.to," "," ").endsWith(" ")&&(d=p[0],u=r.doc.textBetween(d.pos,c.to,void 0," ")),d&&u){const f=u.split(" ").filter(h=>h!=="");if(f.length<=0)return!1;const m=f[f.length-1],y=d.pos+u.lastIndexOf(m);if(!m)return!1;ht(m).filter(h=>h.isLink).map(h=>({...h,from:y+h.start+1,to:y+h.end+1})).filter(h=>r.schema.marks.code?!r.doc.rangeHasMark(h.from,h.to,r.schema.marks.code):!0).filter(h=>e.validate?e.validate(h.value):!0).forEach(h=>{Mt(h.from,h.to,r.doc).some(k=>k.mark.type===e.type)||i.addMark(h.from,h.to,e.type.create({href:h.href}))})}}),!!i.steps.length)return i}})}function ys(e){return new P({key:new B("handleClickLink"),props:{handleClick:(t,n,r)=>{var s,o;if(r.button!==0)return!1;let i=r.target;const a=[];for(;i.nodeName!=="DIV";)a.push(i),i=i.parentNode;if(!a.find(u=>u.nodeName==="A"))return!1;const l=Wt(t.state,e.type.name),c=r.target,p=(s=c==null?void 0:c.href)!==null&&s!==void 0?s:l.href,d=(o=c==null?void 0:c.target)!==null&&o!==void 0?o:l.target;return c&&p?(window.open(p,d),!0):!1}}})}function ks(e){return new P({key:new B("handlePasteLink"),props:{handlePaste:(t,n,r)=>{const{state:s}=t,{selection:o}=s,{empty:i}=o;if(i)return!1;let a="";r.content.forEach(c=>{a+=c.textContent});const l=ht(a).find(c=>c.isLink&&c.value===a);return!a||!l?!1:(e.editor.commands.setMark(e.type,{href:l.href}),!0)}}})}const xs=L.create({name:"link",priority:1e3,keepOnSplit:!1,onCreate(){this.options.protocols.forEach(e=>{if(typeof e=="string"){wt(e);return}wt(e.scheme,e.optionalSlashes)})},onDestroy(){De()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:void 0}},addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:'a[href]:not([href *= "javascript:" i])'}]},renderHTML({HTMLAttributes:e}){var t;return!((t=e.href)===null||t===void 0)&&t.startsWith("javascript:")?["a",v(this.options.HTMLAttributes,{...e,href:""}),0]:["a",v(this.options.HTMLAttributes,e),0]},addCommands(){return{setLink:e=>({chain:t})=>t().setMark(this.name,e).setMeta("preventAutolink",!0).run(),toggleLink:e=>({chain:t})=>t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[R({find:e=>{const t=[];if(e){const n=ht(e).filter(r=>r.isLink);n.length&&n.forEach(r=>t.push({text:r.value,data:{href:r.href},index:r.start}))}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)===null||t===void 0?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[];return this.options.autolink&&e.push(gs({type:this.type,validate:this.options.validate})),this.options.openOnClick&&e.push(ys({type:this.type})),this.options.linkOnPaste&&e.push(ks({editor:this.editor,type:this.type})),e}}),Es=L.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",v(this.options.HTMLAttributes,e),0]},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});export{Ss as E,xs as L,Ts as S,Es as U,ws as a,As as b};
