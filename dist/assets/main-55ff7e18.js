import{V as ve,a as f,i as Ee,_ as i,E as ce,b as C,c as $,d as De,e as M,r as Oe,f as q,g as y,h as m,j as ye,k as se,l as he,m as R,n as be,o as Q,p as J,q as Z,s as Me,t as ee,u as Fe,v as Ae,w as me,x as le,y as Ce,z as Ne,A as we,B as N,C as Ve,D as pe,F as W,G as $e,H as Ue,I as Pe,J as Be,K as V,L as j,M as u,N as qe,O as je,P as ie,Q as He,R as Ge,S as Ke,T as ze,U as Ye,W as We,X as Xe,Y as Qe,Z as Je,$ as Ze,a0 as et,a1 as tt,a2 as st,a3 as it,a4 as at,a5 as rt,a6 as B,a7 as nt,a8 as lt,a9 as H,aa as ot,ab as ct,ac as dt,ad as ut,ae as ht,af as mt,ag as pt,ah as Se,ai as ft,aj as gt,ak as _t,al as vt}from"./vendor-0617e4c3.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();const Le=new ve({theme:{themes:{light:{primary:"#00095B","node-cms-black":"#00142E","node-cms-blue":"#00095B","node-cms-grabber":"#1700F4","node-cms-twilight":"#00142E","node-cms-grey":"#AFAFAF","node-cms-light-grey":"#DBDBDB","node-cms-light-white-grey":"#EDEDED","node-cms-off-white":"#F6F6F6","node-cms-red":"#C90000"},dark:{primary:"#00142E","node-cms-black":"#00142E","node-cms-blue":"00142E","node-cms-grabber":"00142E","node-cms-twilight":"00142E","node-cms-grey":"00142E","node-cms-light-grey":"00142E","node-cms-light-white-grey":"00142E","node-cms-off-white":"00142E","node-cms-red":"00142E"}}},icons:{iconfont:"mdi"}});f.use(ve);f.use(Ee,{vuetify:Le,iconsGroup:"mdi"});class yt{constructor(){this.isShow=!1,this.list=[]}start(e){this.isShow=!0,this.list=i.union(this.list,[e])}stop(e){this.list=i.difference(this.list,[e]),i.isEmpty(this.list)&&(this.isShow=!1)}}const de=new yt;class bt{constructor(){this.events=new ce}send(e,s="success"){this.events.emit("notification",{message:e,type:s})}sendOmnibarDisplayStatus(e){this.events.emit("omnibar-display-status",e)}}const U=new bt;class Ct{constructor(){this.user=null,this.logoutCallbackList=[]}init(){console.info("LoginService - init"),setInterval(async()=>{this.checkStatus()},1e3*15)}async getStatus(){try{const{data:e}=await C.get(`${window.location.pathname}login`);return this.user=e,e}catch{return null}}async checkStatus(){let e;const s=i.cloneDeep(this.user);try{e=await this.getStatus()}catch{}i.isEmpty(e)&&!i.isEmpty(s)&&(console.info("will logout"),await this.logout())}async changeTheme(e){try{const s=i.get(this.user,"theme","dark")==="dark"?"light":"dark";return await C.get(`${window.location.pathname}changeTheme/${s}`),console.warn("Successfully changed the theme for user"),i.set(this.user,"theme",s),s}catch(s){console.error("Failed to change theme: ",s)}}async logout(){this.user=null;try{await C.get(`${window.location.pathname}logout`),window.location.reload()}catch(e){console.error("Failed to logout: ",e)}i.each(this.logoutCallbackList,e=>{e()})}onLogout(e){this.logoutCallbackList.push(e)}checkPermission(e){return i.includes(this.user.group.modules,e)}}const O=new Ct;class wt{constructor(){this.config={}}async init(){try{const{data:e}=await $.get(`${window.location.pathname}config`);this.config=e}catch(e){console.error("Error during init of ConfigService:",e)}}}const P=new wt;let $t=class{constructor(){this.dict={},this.locale="enUS"}async init(){const{data:e}=await $.get(`${window.location.pathname}i18n/config.json`);this.config=i.get(e,"config.language",{defaultLocale:"enUS",locales:["enUS"]}),this.locale=i.get(this.config,"defaultLocale","enUS");for(const s of this.config.locales)try{const{data:a}=await $.get(`${window.location.pathname}i18n/${s}.json`);this.dict[s]=a}catch(a){console.warn(`TranslateService wasn't able to pull ${s}: `,a)}}setLocale(e){this.locale=e}get(e,s,a){if(i.isString(e)){const r=this.dict[s||this.locale]&&this.dict[s||this.locale][e];return r?i.template(r)(a):e}return i.isEmpty(e)?"":e[s||this.locale]||""}};const h=new $t;class St{constructor(){this.cacheMap={}}async cache(e){const{data:s}=await $.get(`${window.location.pathname}../api/${e}`);return i.get(s,"userLoggedOut",!1)?(console.info("Received userLoggedOut from server, will redirect to login page"),window.location.reload(),[]):(this.cacheMap[e]=s,this.get(e))}get(e){const s=this.cacheMap[e];return i.isUndefined(s)&&console.info(`resource (${e}) is not cached`),s}setSchemas(e){this.schemas=e}getSchema(e){return i.find(this.schemas,{title:e})}}const L=new St;function p(t,e,s,a,r,n,l,o){var c=typeof t=="function"?t.options:t;e&&(c.render=e,c.staticRenderFns=s,c._compiled=!0),a&&(c.functional=!0),n&&(c._scopeId="data-v-"+n);var d;if(l?(d=function(g){g=g||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!g&&typeof __VUE_SSR_CONTEXT__<"u"&&(g=__VUE_SSR_CONTEXT__),r&&r.call(this,g),g&&g._registeredComponents&&g._registeredComponents.add(l)},c._ssrRegister=d):r&&(d=o?function(){r.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:r),d)if(c.functional){c._injectStyles=d;var _=c.render;c.render=function(E,I){return d.call(I),_(E,I)}}else{var b=c.beforeCreate;c.beforeCreate=b?[].concat(b,d):[d]}return{exports:t,options:c}}const Lt={data(){return{}},mounted(){},methods:{notify(t,e="success"){i.get(console,e,console.info)(t),U.send(t,e)},sendOmnibarDisplayStatus(t){U.sendOmnibarDisplayStatus(t)}}},Rt=null,xt=null;var Tt=p(Lt,Rt,xt,!1,null,null,null,null);const F=Tt.exports,It={};var kt=function(){var e=this,s=e._self._c;return s("div",{staticClass:"showbox active"},[s("div",{staticClass:"loader"},[s("svg",{staticClass:"circular",attrs:{viewBox:"25 25 50 50"}},[s("circle",{staticClass:"path",attrs:{cx:"50",cy:"50",r:"20",fill:"none","stroke-width":"2","stroke-miterlimit":"10"}})])])])},Et=[],Dt=p(It,kt,Et,!1,null,null,null,null);const Re=Dt.exports,Ot={props:{localeList:{type:Array,default:()=>[]}},data(){return{TranslateService:h}},methods:{select(t){h.setLocale(t)}}};var Mt=function(){var e=this,s=e._self._c;return e.localeList&&e.localeList.length>1?s("div",{staticClass:"locale-list"},e._l(e.localeList,function(a,r){return s("div",{key:r,staticClass:"locale",class:{active:e.TranslateService.locale==a},on:{click:function(n){return e.select(a)}}},[e._v(" "+e._s(e._f("translate")("TL_"+a.toUpperCase()))+" ")])}),0):e._e()},Ft=[],At=p(Ot,Mt,Ft,!1,null,null,null,null);const Nt=At.exports;class Vt{constructor(){De(this),this.events=new ce,this.connection=null,this.clientID=0,this.isConnecting=!1,this.isConnected=!1,this.connecting=!1,this.serverUrl=!1}async init(e){this.serverUrl=`ws://${window.location.hostname}:${i.get(e,"webserver.port",9090)}`,this.connect()}connect(){clearTimeout(this.connecting),!this.isConnecting&&(this.isConnecting=!0,this.isConnected=!1,this.events.emit("connected",!1),setTimeout(()=>{this.client=new WebSocket(this.serverUrl,"json"),console.info(`Created websocket client for ${this.serverUrl}`),this.client.onopen=this.onOpen,this.client.onclose=this.onClose,this.client.onmessage=this.onMessage},150))}onClose(e){console.info("Websocket - onClose",e),this.isConnecting=!1,this.isConnected=!1,this.events.emit("connected",!1),clearTimeout(this.heatbeat),clearTimeout(this.connecting),this.connecting=setTimeout(async()=>{await this.connect()},500)}onOpen(e){this.onHeartbeat(),this.isConnecting=!1,this.isConnected=!0,this.events.emit("connected",!0)}onMessage(e){const s=JSON.parse(e.data),a=i.get(s,"action","??");if(a==="ping")return this.pong();this.events.emit(a,i.get(s,"data",{}))}pong(){this.send({action:"pong",bearer:"9-0123456789"}),this.onHeartbeat()}send(e){try{this.client&&this.client.send(JSON.stringify(e))}catch(s){console.error("WebSocket::send: Error:",s)}}onHeartbeat(){clearTimeout(this.heatbeat),this.heatbeat=setTimeout(()=>{this.client.close()},3e4+5e3)}}const A=new Vt;M.extend(Oe);const Ut={props:{config:{type:[Object,Boolean],default:!1},settingsData:{type:[Object,Boolean],default:!1}},data(){return{TranslateService:h,destroyed:!1,type:null,timer:null,system:{cpu:{count:0,usage:0,model:"Unknown"},memory:{totalMemMb:0,usedMemMb:0,freeMemMb:0,freeMemPercentage:0},network:"not supported",drive:"not supported",uptime:0}}},computed:{showLogoutButton(){return!i.get(window,"disableJwtLogin",!1)}},async mounted(){A.events.on("getSystemInfo",t=>{this.system=t,this.$forceUpdate()}),await A.init(this.config),this.getSystemData()},destroyed(){this.destroyed=!0,clearTimeout(this.timer)},methods:{isActiveLink(t){const e=new URL(window.location),s=new URL(t);return e.host===s.host},getTheme(){return i.get(O,"user.theme","light")==="dark"},async onChangeTheme(){const t=i.get(O,"user.theme","light")==="light"?"dark":"light";this.$vuetify.theme.dark=await O.changeTheme(t)==="dark"},async logout(){await O.logout()},async getSystemData(){try{A.send({action:"getSystemInfo"})}catch(t){console.error(t)}this.destroyed||(this.timer=setTimeout(this.getSystemData,this.error?1e4:5e3))},select(t){this.$emit("selectItem",t)},timeAgo(t){return M().subtract(parseInt(t,10),"second").fromNow()},convertBytes(t){const e=["MB","GB","TB"];if(t===0)return"0 MB";if(Math.log(t)<=0)return`${t.toFixed(1)} MB`;const s=parseInt(Math.floor(Math.log(t)/Math.log(1024)));return s<=0?t+" "+e[s]:(t/Math.pow(1024,s)).toFixed(1)+" "+e[s]}}};var Pt=function(){var e=this,s=e._self._c;return s("div",{staticClass:"system-info"},[e.settingsData&&e.settingsData.linksGroups&&e.settingsData.linksGroups.length>0?s(q,{attrs:{"content-class":"links-menu","offset-y":"","close-on-content-click":!1,"nudge-bottom":"5px",transition:"slide-y-transition"},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:r}){return[s(y,e._g(e._b({attrs:{icon:""}},"v-btn",r,!1),a),[s(m,[e._v("mdi-dots-vertical")])],1)]}}],null,!1,3221905750)},[s("div",{staticClass:"links-wrapper"},e._l(e.settingsData.linksGroups,function(a,r){return s("div",{key:r,staticClass:"group"},[s("div",{staticClass:"node-cms-title"},[e._v(e._s(a.value.title))]),e._l(a.value.links,function(n,l){return s("a",{key:l,staticClass:"link",class:{active:e.isActiveLink(n.value.url)},attrs:{href:n.value.url}},[e._v(e._s(n.value.name))])}),r<e.settingsData.linksGroups.length-1?s(ye):e._e()],2)}),0)]):e._e(),s(q,{attrs:{"content-class":"system-info-menu","offset-y":"","close-on-content-click":!1,"nudge-bottom":"5px",transition:"slide-y-transition"},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:r}){return[s(y,e._g(e._b({attrs:{icon:""}},"v-btn",r,!1),a),[s(m,[e._v("mdi-cog-outline")])],1)]}}])},[s("div",{staticClass:"system-info-wrapper"},[s("div",{staticClass:"node-cms-title flex"},[s("span",[e._v(e._s(e._f("translate")("TL_SYSTEM")))]),s("div",{staticClass:"theme-switch",on:{click:function(a){return e.onChangeTheme()}}},[s(m,{class:{selected:!e.getTheme()}},[e._v("mdi-weather-sunny")]),s(m,{class:{selected:e.getTheme()}},[e._v("mdi-weather-night")])],1)]),s("div",{staticClass:"stats cpu"},[s("div",{staticClass:"node-cms-title"},[s("small",[s("b",[e._v("CPU Usage")])])]),s(se,{attrs:{rounded:"",value:e.system.cpu.usage}}),s("small",{staticClass:"text"},[e._v(e._s(e.system.cpu.count)+" cores ("+e._s(e.system.cpu.model)+")")])],1),s("div",{staticClass:"stats ram"},[s("div",{staticClass:"node-cms-title"},[s("small",[s("b",[e._v("Memory Usage")])])]),s(se,{attrs:{rounded:"",value:100-e.system.memory.freeMemPercentage}}),s("small",{staticClass:"text"},[e._v(e._s(e.convertBytes(e.system.memory.usedMemMb))+" / "+e._s(e.convertBytes(e.system.memory.totalMemMb)))])],1),e.system.drive!="not supported"?s("div",{staticClass:"stats drive"},[s("div",{staticClass:"node-cms-title"},[s("small",[s("b",[e._v("Disk Usage")])])]),s(se,{attrs:{rounded:"",value:100-e.system.drive.usedPercentage}}),s("small",{staticClass:"text"},[e._v(e._s(e.convertBytes(e.system.drive.usedGb*1024))+" / "+e._s(e.convertBytes(e.system.drive.totalGb*1024)))])],1):e._e(),s("div",{staticClass:"stats two-by-two"},[e.system.network!="not supported"?s("div",{staticClass:"stats network"},[s("div",{staticClass:"node-cms-title"},[s("small",[s("b",[e._v("Network Usage")])])]),s("small",{staticClass:"text"},[e._v(e._s(e.convertBytes(e.system.network.total.outputMb))+" "),s(m,[e._v("mdi-arrow-up")]),e._v(" / "+e._s(e.convertBytes(e.system.network.total.inputMb))+" "),s(m,[e._v("mdi-arrow-down")])],1)]):e._e(),s("div",{staticClass:"stats uptime"},[s("div",{staticClass:"node-cms-title"},[s("small",[s("b",[e._v("Uptime:")])]),e._v(" "),s("small",{staticClass:"text"},[e._v(e._s(e.timeAgo(e.system.uptime)))])])])])])]),e.showLogoutButton?s(y,{attrs:{icon:""},on:{click:function(a){return e.logout()}}},[s(m,[e._v("mdi-logout")])],1):e._e()],1)},Bt=[],qt=p(Ut,Pt,Bt,!1,null,"8a8420cc",null,null);const jt=qt.exports;class Ht{constructor(){this.events=new ce}select(e){this.events.emit("select",e)}}const G=new Ht;const Gt={mixins:[F],props:{selectResourceCallback:{type:Function,default:()=>{}},groupedList:{type:Array,default:()=>[]},selectedItem:{type:Object,default:()=>{}}},data(){return{showOmnibar:!1,search:null,scrolledToBottom:!1,resourcesList:[],results:[],highlightedItem:0,searchModes:["all","resource","field"],searchMode:"all",shortcutsWhenClosed:{open:["ctrl","p"]},shortcuts:{esc:["esc"],open:["ctrl","p"],"arrow-up":["arrowup"],"arrow-down":["arrowdown"],enter:["enter"],all:["shift","a"],resource:["shift","r"],field:["shift","f"]},searchOptions:{keys:["displayname"],scoreFn:t=>t[0]?t[0].score+(this.isResultInCurrentResource(t)?1e7:0):-1e7}}},watch:{search(){this.highlightedItem=0,this.results=[];const t=he.go(this.search,this.getDataForSearch(),this.searchOptions);this.results=i.compact(i.map(t,(e,s)=>i.isNull(i.get(e,"[0]",null))?!1:(e.obj.html=he.highlight(e[0]),e.obj.score=e.score,e.obj)))}},mounted(){this.resourcesList=i.map(i.flatten(i.map(this.groupedList,"list")),t=>(t.type="resource",t.displayname=i.get(t,"displayname.enUS",i.get(t,"displayname",t.title)),t)),this.fieldsList=i.flatten(i.map(this.resourcesList,t=>i.map(t.schema,e=>(e.resource=t,e.displayname=`${t.displayname}.${i.get(e,"label.enUS",i.get(e,"label",e.field))}`,e.type="field",e))))},methods:{onScroll({target:{scrollTop:t,clientHeight:e,scrollHeight:s}}){this.scrolledToBottom=t+e>=s-50},isResultInCurrentResource(t){return i.startsWith(i.get(t[0],"target",""),i.get(this.selectedItem,"displayname",""))},getDataForSearch(){return this.searchMode==="all"?i.concat(this.resourcesList,this.fieldsList):this.searchMode==="resource"?this.resourcesList:this.fieldsList},getIconForResult(t){return this.getIcon(this.searchMode==="all"?t.type:this.searchMode)},getIcon(t){return`mdi-${t==="resource"?"package":"cursor-text"}`},isCharHighlighted(t,e){return i.includes(i.values(t._indexes),e)},showHideOmnibar(t){this.showOmnibar=t,this.setSearchMode("all"),t&&this.$nextTick(()=>{i.get(this.$refs,"['search']",!1).focus()}),this.sendOmnibarDisplayStatus(t)},selectResult(t=-1){const e=i.get(this.results,`[${t===-1?this.highlightedItem:t}]`,!1);if(!e)return;const s=i.includes(["resource","plugin"],e.type)?e:e.resource;s!==this.selectedItem?(console.info(`Switching to resource ${s.title}`),this.selectResourceCallback(s)):e.type==="field"&&G.events.emit("select",i.omit(e,"resource")),this.showHideOmnibar(!1)},setSearchMode(t){this.searchMode=t,this.search=""},scrollToResult(t){const e=document.getElementById(`result-${this.highlightedItem}`);e&&e.scrollIntoView()},async interactiveSearch(t){const e=i.get(t,"srcKey",!1);if(e){if(!this.showOmnibar){e==="open"&&this.showHideOmnibar(!0);return}e==="esc"||e==="open"?this.showHideOmnibar(!1):e==="arrow-up"?(this.highlightedItem-1>=0?this.highlightedItem-=1:this.highlightedItem=0,this.scrollToResult()):e==="arrow-down"?(this.highlightedItem+1<=this.results.length-1?this.highlightedItem+=1:this.highlightedItem=this.results.length-1,this.scrollToResult()):e==="enter"?this.selectResult():i.includes(this.searchModes,e)&&this.setSearchMode(e)}}}};var Kt=function(){var e=this,s=e._self._c;return s("div",{directives:[{name:"shortkey",rawName:"v-shortkey",value:e.showOmnibar?e.shortcuts:e.shortcutsWhenClosed,expression:"showOmnibar ? shortcuts : shortcutsWhenClosed"}],attrs:{id:"omnibar"},on:{shortkey:e.interactiveSearch}},[s("div",{class:{displayed:e.showOmnibar},attrs:{id:"omnibar-backdrop"},on:{click:function(a){return e.showHideOmnibar(!1)}}}),s(R,{directives:[{name:"show",rawName:"v-show",value:e.showOmnibar,expression:"showOmnibar"}],attrs:{elevation:"24"}},[s(be,{staticClass:"search"},[s(Q,{ref:"search",staticClass:"search-bar",attrs:{flat:"",filled:"",rounded:"","hide-details":"","prepend-inner-icon":"mdi-magnify",dense:"",placeholder:e._f("translate")("TL_INSERT_KEYWORDS"),type:"text",autocomplete:"off",name:"search",prefix:e.searchMode==="all"?"":`${e.searchMode}:`},model:{value:e.search,callback:function(a){e.search=a},expression:"search"}})],1),e.results&&e.results.length>0?[s(ye),s("div",{ref:"scrollWrapper",staticClass:"scroll-wrapper",class:{"scrolled-to-bottom":e.scrolledToBottom||e.results.length<20},on:{scroll:e.onScroll}},[s(J,{attrs:{dense:""}},e._l(e.results,function(a,r){return s(Z,{key:r,staticClass:"list",class:{highlighted:e.highlightedItem===r},attrs:{id:"result-"+r,ripple:!1},on:{click:function(n){return e.selectResult(r)}}},[s(Me,[s(ee,[s(m,{attrs:{small:""}},[e._v(e._s(e.getIconForResult(a)))]),s("span",{domProps:{innerHTML:e._s(a.html)}})],1)],1)],1)}),1)],1)]:e._e()],2)],1)},zt=[],Yt=p(Gt,Kt,zt,!1,null,null,null,null);const Wt=Yt.exports;const Xt={components:{Omnibar:Wt},props:{selectResourceCallback:{type:Function,default:()=>{}},groupedList:{type:Array,default:()=>[]},selectedItem:{type:Object,default:()=>{}}},mounted(){this.$nextTick(()=>{i.isEmpty(this.selectedItem)&&this.selectResourceCallback(i.first(i.get(i.first(this.groupedList),"list",[])))})},methods:{getResourceTitle(t){return t.displayname?h.get(t.displayname):t.title},groupSelected(t){if(!this.selectedItem)return!1;const e=i.get(this.selectedItem,"group.enUS",i.get(this.selectedItem,"group",!1)),s=i.get(t,"name.enUS",t.name);return s==="TL_OTHERS"&&!e?!0:s===e}}};var Qt=function(){var e=this,s=e._self._c;return e.groupedList?s("div",{staticClass:"resources-content"},[s("omnibar",{attrs:{"select-resource-callback":e.selectResourceCallback,"grouped-list":e.groupedList,"selected-item":e.selectedItem}}),s("div",{staticClass:"resource-list"},e._l(e.groupedList,function(a,r){return s("div",{key:`resource-group-${r}`,staticClass:"resource"},[s(q,{attrs:{auto:"","open-on-hover":"","offset-y":"","close-on-content-click":!1,"content-class":"resources-menu"},scopedSlots:e._u([{key:"activator",fn:function({on:n,attrs:l}){return[s("div",e._g(e._b({staticClass:"menu-btn-wrapper"},"div",l,!1),n),[s(y,{class:{selected:e.groupSelected(a)},attrs:{outlined:e.groupSelected(a),text:"",rounded:"",small:""}},[e._v(" "+e._s(e._f("translate")(a.name))+" ")])],1)]}}],null,!0)},[s(J,{attrs:{rounded:""}},e._l(a.list,function(n){return s(Z,{key:n.name,class:{selected:e.selectedItem===n},attrs:{dense:""},on:{click:function(l){return e.selectResourceCallback(n)}}},[s(ee,[e._v(e._s(e.getResourceTitle(n)))])],1)}),1)],1)],1)}),0)],1):e._e()},Jt=[],Zt=p(Xt,Qt,Jt,!1,null,"d5bc0246",null,null);const es=Zt.exports,ts=""+new URL("logo-3832edb8.svg",import.meta.url).href;const ss={components:{SystemInfo:jt,ResourceList:es},props:{toolbarTitle:{type:[String,Boolean],default:!1},groupedList:{type:Array,default:()=>[]},config:{type:[Object,Boolean],default:!1},localeClass:{type:Object,default:()=>{}},selectResourceCallback:{type:Function,default:()=>{}},selectedItem:{type:Object,default:()=>{}}},data(){return{settingsData:!1}},mounted(){this.getSettingsData()},methods:{getDefaultLogo(){return ts},getLogo(){const t=i.find(i.get(this.settingsData,"_attachments",[]),{_name:"logo"});return i.isUndefined(t)?!1:i.get(t,"url","")},hasLogoOrTitle(){return this.getLogo()||i.get(this.settingsData,"title",!1)},async getSettingsData(){try{this.settingsData=i.first(await L.cache("_settings"))}catch(t){console.error(t)}},getSelectedItemName(){return i.get(this.selectedItem,"displayname",!1)?h.get(this.selectedItem.displayname):i.get(this.selectedItem,"name",!1)}}};var is=function(){var e=this,s=e._self._c;return s("div",{staticClass:"nav-bar-wrapper"},[s(Fe,{staticClass:"nav-bar",class:e.localeClass,attrs:{"min-width":"100%",width:"100%",height:"58"}},[s(Ae,[e.settingsData&&e.hasLogoOrTitle()?[e.getLogo()?s("img",{staticClass:"logo",attrs:{src:e.getLogo()}}):e.settingsData.title&&e.settingsData.title.length>0?[e._v(" "+e._s(e.settingsData.title)+" ")]:e._e()]:s("img",{staticClass:"logo",attrs:{src:e.getDefaultLogo()}})],2),s(me),s("resource-list",{attrs:{"select-resource-callback":e.selectResourceCallback,"grouped-list":e.groupedList,"selected-item":e.selectedItem}}),s(me),e.config?s("system-info",{attrs:{config:e.config,"settings-data":e.settingsData}}):e._e()],1)],1)},as=[],rs=p(ss,is,as,!1,null,null,null,null);const ns=rs.exports,ls={methods:{getName(t){return this.getValue(t,i.first(this.resource.schema),this.resource.displayItem)},getValue(t,e,s){let a="";if(e){if(e.input==="file"){const r=i(t).get("_attachments",[]).find(n=>n._name===e.field);a=r&&r._filename}else if(e.input==="select"){let r=i.get(t,e.field);i.isString(r)&&(r=i.find(L.get(e.source),{_id:r}),r&&i.each(e.options&&e.options.extraSources,(n,l)=>{const o=i.get(r,l);i.isString(o)&&i.set(r,l,i.find(L.get(n),{_id:o}))})),e.options&&e.options.customLabel?a=le.render(e.options.customLabel,r||{}):a=i.get(r,i.chain(r).keys().first().value(),"")}a===""&&(this.resource.locales&&(e.localised||i.isUndefined(e.localised))?a=i.get(t,`${this.locale}.${e.field}`):a=i.get(t,e.field))}if(s){const r=i.clone(t);i.each(this.getExtraRessources(),(n,l)=>{const o=L.get(n);if(o){const c=i.find(o,{_id:i.get(r,l)});c&&i.set(r,l,c)}}),a=le.render(s,r)}return a},getExtraRessources(){return i.extend(i.get(this.resource,"extraSources",{}),i.get(this.resource,"schema[0].options.extraSources"))}}},os={mixins:[F,ls],props:{list:{type:[Array,Boolean],default:()=>[]},resource:{type:[Object,Boolean],default:()=>{}},groupedList:{type:[Array,Boolean],default:()=>[]},resourceGroup:{type:[Object,Boolean],default:()=>{}},selectedItem:{type:Object,default:()=>{}},selectResourceCallback:{type:Function,default:()=>{}},updateRecordList:{type:Function,default:()=>{}},locale:{type:String,default:"enUS"},multiselect:{type:Boolean,default:!1},multiselectItems:{type:[Array,Boolean],default:()=>[]}},data(){return{lastSelectedItem:!1,menuOpened:!1,search:null,TranslateService:h,omnibarDisplayed:!1,sift:{isQuery:!1,isValid:!1},query:{},localMultiselectItems:[]}},computed:{selectedResourceGroup(){return i.find(this.groupedList,t=>this.groupSelected(t))},maxCount(){return i.get(this.resource,"maxCount",0)},listCount(){return i.get(this.list,"length",0)},filteredList(){let t=this.getSearchableFields();return t.length===0&&(t=[i.first(this.resource.schema)]),i.forEach(this.list,e=>e._searchable={id:!1,keyFields:!1,query:!1}),this.sift.isQuery?i.forEach(this.list.filter(Ce(this.query)),e=>e._searchable.query=!0):i.filter(this.list,e=>{if(i.isEmpty(this.search))return!0;const s=[];i.forEach(t,l=>{s.push(this.getValue(e,l,this.resource.displayItem))});let a=0,r=0;for(const l in this.query){const o=this.query[l];a=a+1;let c=i.get(e,l);i.isUndefined(c)===!1&&(i.isArray(c)?i.includes(c,o)&&(r=r+1):c===o&&(r=r+1))}let n=!1;return a>0&&a===r?(n=!0,e._searchable.query=!0):this.doesMatch(this.search,s)?(n=!0,e._searchable.keyFields=!0):new RegExp(this.search,"i").test(e._id)&&(n=!0,e._searchable.id=!0),n})}},watch:{selectedResourceGroup(){this.search=""},search(){this.query=this.flatten(Ne.parse(this.search)),this.sift.isQuery=!1;try{this.search.search("sift:")===0&&(this.sift.isQuery=!0,this.query=we.parse(this.search.substr(5)),this.sift.isValid=!0)}catch{this.sift.isValid=!1,this.query={}}},multiselectItems(){this.localMultiselectItems=i.cloneDeep(this.multiselectItems)}},mounted(){U.events.on("omnibar-display-status",this.onGetOmnibarDisplayStatus)},methods:{onGetOmnibarDisplayStatus(t){this.omnibarDisplayed=t},getShortcuts(){return this.omnibarDisplayed?{}:{esc:["esc"],open:["ctrl","/"]}},getSelectedRecordIds(){return i.map(this.localMultiselectItems,"_id")},allRecordsSelected(){const t=this.getSelectedRecordIds();return i.get(i.filter(this.filteredList,e=>!i.includes(t,e._id)),"length",0)===0},onClickSelectAll(){const t=this.getSelectedRecordIds();i.each(this.filteredList,e=>{i.includes(t,e._id)||this.localMultiselectItems.push(e)}),this.$emit("changeMultiselectItems",this.localMultiselectItems)},onClickDeselectAll(){this.$emit("changeMultiselectItems",[])},toggleViewMode(){this.localMultiselectItems=[],this.$emit("changeMultiselectItems",this.localMultiselectItems),this.$emit("selectMultiselect",!this.multiselect)},isCreatingNewRecord(){return this.selectedItem&&!i.get(this.selectedItem,"_id",!1)},copyIdToClipboard(t){navigator.clipboard.writeText(t)},hasEditableRecords(){return i.get(i.filter(this.filteredList,t=>i.get(t,"_local",!1)),"length",0)!==0},isItemSelected(t){return this.multiselect?i.includes(i.map(this.localMultiselectItems,"_id"),t._id):t===this.selectedItem||i.includes(i.map(this.localMultiselectItems,"_id"),t._id)},getTypePrefix(t){let e="TL_ERROR_ON_RECORD_";return t==="create"?e+="CREATION":t==="update"?e+="UPDATE":t==="delete"&&(e+="DELETE"),e?h.get(e):"Error"},manageError(t,e,s){let a=this.getTypePrefix(e),r=a;if(i.get(t,"response.data.code",500)===400){const n=i.get(t,"response.data");i.get(n,"message",!1)?r=`${a}: ${n.message}`:r=`${a}: ${h.get("TL_UNKNOWN_ERROR")}`}console.error(r,s),this.notify(r,"error")},groupSelected(t){if(!this.resource)return!1;const e=i.get(this.resource,"group.enUS",i.get(this.resource,"group",!1)),s=i.get(t,"name.enUS",t.name);return s==="TL_OTHERS"&&!e?!0:s===e},getResourceTitle(t){return t?t.displayname?h.get(t.displayname):t.title:""},selectAll(){this.localMultiselectItems.length===this.filteredList.length?this.localMultiselectItems=[]:this.localMultiselectItems=this.filteredList,this.$emit("changeMultiselectItems",this.localMultiselectItems)},dive(t,e,s){for(let a in e)if(a in e){let r=a,n=e[a];t.length>0&&(r=t+"."+a),typeof n=="object"?this.dive(r,n,s):s[r]=n}},flatten(t){let e={};return this.dive("",t,e),e},async interactiveSearch(t){const e=i.get(t,"srcKey",!1),s=i.get(this.$refs,"['search']",!1);if(!(!e||!s))return e==="esc"?s.blur():s.focus()},select(t,e=!1){if(!t._local)return this.$emit("selectItem",t);if(this.lastSelectedItem=t._id,!e)this.localMultiselectItems=[t],this.$emit("selectItem",t);else{if(this.selectedItem&&this.selectedItem._id===t._id)return;this.isItemSelected(t)?this.localMultiselectItems=i.filter(this.localMultiselectItems,s=>s._id!==t._id):this.localMultiselectItems.push(t)}this.$emit("changeMultiselectItems",this.localMultiselectItems)},checkIndex(t){return t+1<=this.filteredList.length?t+1:-1},selectTo(t,e=!1){if(!this.multiselect)return;if(e||t._id===this.lastSelectedItem)return i.isUndefined(i.find(this.localMultiselectItems,{_id:t._id}))?this.localMultiselectItems.push(t):this.localMultiselectItems=i.filter(this.localMultiselectItems,c=>c._id!==t._id),this.$emit("changeMultiselectItems",this.localMultiselectItems);this.lastSelectedItem||(this.lastSelectedItem=t._id);const s=i.isUndefined(i.find(this.localMultiselectItems,{_id:t._id}))?"check":"uncheck",a=i.findIndex(this.filteredList,c=>c._id===t._id),r=i.findIndex(this.filteredList,c=>c._id===this.lastSelectedItem),n=a<=r?a:r,l=this.checkIndex(a<=r?r:a),o=i.slice(this.filteredList,n,l);if(s==="check")i.each(o,c=>{i.isUndefined(i.find(this.localMultiselectItems,{_id:c._id}))&&this.localMultiselectItems.push(c)});else{const c=i.map(o,"_id");this.localMultiselectItems=i.filter(this.localMultiselectItems,d=>!i.includes(c,d._id))}this.lastSelectedItem=t._id,this.$emit("changeMultiselectItems",this.localMultiselectItems)},onClickNew(){this.localMultiselectItems=[],this.$emit("changeMultiselectItems",this.localMultiselectItems),this.$emit("selectMultiselect",!1),this.$emit("selectItem",{_local:!0})},getSearchableFields(){return i.filter(this.resource.schema,t=>t.searchable===!0)},doesMatch(t,e){return i.find(e,s=>!!new RegExp(this.search,"i").test(s))}}};var cs=function(){var e=this,s=e._self._c;return e.maxCount!=1?s("div",{staticClass:"record-list"},[s("div",{staticClass:"record-list-top-bar"},[e.selectedResourceGroup&&e.groupedList?s(q,{attrs:{auto:"","content-class":"resources-menu sidebar","offset-y":"","close-on-content-click":!0},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:r}){return[s("div",e._g(e._b({staticClass:"resource-selector",class:{opened:e.menuOpened}},"div",r,!1),a),[s("div",{staticClass:"resource-title"},[e._v(e._s(e.getResourceTitle(e.resource)))]),s(m,{attrs:{large:""}},[e._v("mdi-chevron-down")])],1)]}}],null,!1,341021591),model:{value:e.menuOpened,callback:function(a){e.menuOpened=a},expression:"menuOpened"}},[s(J,{attrs:{rounded:""}},e._l(e.selectedResourceGroup.list,function(a){return s(Z,{key:a.name,class:{selected:a===e.resource},attrs:{dense:""},on:{click:function(r){a!==e.resource&&e.selectResourceCallback(a)}}},[s(ee,[e._v(e._s(e.getResourceTitle(a)))])],1)}),1)],1):e._e(),s("div",{directives:[{name:"shortkey",rawName:"v-shortkey",value:e.getShortcuts(),expression:"getShortcuts()"}],staticClass:"search",class:{"is-query":e.sift.isQuery,"is-valid":e.sift.isQuery&&e.sift.isValid==!0,"is-invalid":e.sift.isQuery&&e.sift.isValid==!1},on:{shortkey:e.interactiveSearch}},[s(Q,{ref:"search",staticClass:"search-bar",attrs:{"prepend-inner-icon":"mdi-magnify",flat:"",filled:"",rounded:"","hide-details":"",dense:"",placeholder:e._f("translate")("TL_SEARCH"),type:"text",name:"search"},model:{value:e.search,callback:function(a){e.search=a},expression:"search"}}),e.maxCount<=0||e.listCount<e.maxCount?s(y,{staticClass:"new-record",class:{active:e.isCreatingNewRecord()},attrs:{elevation:"0",icon:""},on:{click:e.onClickNew}},[e.selectedItem&&!e.multiselect?s(m,[e._v("mdi-note-edit-outline")]):s(m,[e._v("mdi-note-plus-outline")])],1):e._e()],1)],1),e.hasEditableRecords()?s("div",{staticClass:"records-top-bar"},[s("div",{staticClass:"toggle-view-mode",on:{click:function(a){return e.toggleViewMode()}}},[s(m,{class:{selected:!e.multiselect},attrs:{small:""}},[e._v("mdi-note-edit-outline")]),s(m,{class:{selected:e.multiselect},attrs:{small:""}},[e._v("mdi-format-list-checks")])],1),e.multiselect?s("div",{staticClass:"multiselect-buttons"},[s("span",{class:{disabled:e.allRecordsSelected()},on:{click:e.onClickSelectAll}},[e._v(e._s(e._f("translate")("TL_SELECT_ALL")))]),s("span",{class:{disabled:e.multiselectItems.length===0},on:{click:e.onClickDeselectAll}},[e._v(e._s(e._f("translate")("TL_DESELECT_ALL")))])]):e._e()]):e._e(),s("div",{directives:[{name:"shortkey",rawName:"v-shortkey",value:e.multiselect?["ctrl","a"]:!1,expression:"multiselect ? ['ctrl', 'a'] : false"}],staticClass:"records",on:{shortkey:function(a){return e.selectAll()}}},[s("RecycleScroller",{staticClass:"list",attrs:{items:e.filteredList,"item-size":58,"key-field":"_id"},scopedSlots:e._u([{key:"default",fn:function({item:a}){return[s("div",{staticClass:"item",class:{selected:e.isItemSelected(a),frozen:!a._local},on:{click:[function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey?null:e.select(a)},function(r){return r.shiftKey?e.selectTo(a):null},function(r){return r.ctrlKey?e.selectTo(a,!0):null}]}},[s("div",{staticClass:"item-info"},[e.multiselect?s("div",{staticClass:"checkbox",class:{"blink-background":e.isItemSelected(a)},on:{click:function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey?null:e.select(a,!0)}}},[a._local?[s(m,{class:{displayed:e.isItemSelected(a)},attrs:{small:""}},[e._v("mdi-check-bold")])]:e._e()],2):e._e(),s("div",{staticClass:"infos-wrapper"},[a?s("div",{staticClass:"main"},[s(N,{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function({on:r,attrs:n}){return[s("span",e._g(e._b({},"span",n,!1),r),[e._v(e._s(e._f("truncate")(e.getName(a),15)))])]}}],null,!0)},[s("span",[e._v(e._s(e.getName(a)))])])],1):e._e(),s("div",{staticClass:"meta"},[s("div",{staticClass:"ts"},[a._updatedBy?[e._v(" "+e._s(a._updatedBy)+" - ")]:[e._v(" "+e._s(e._f("translate")("TL_UPDATED")))],e._v(" "),s("span",{staticClass:"time-ago",on:{click:function(r){return e.copyIdToClipboard(a._id)}}},[s("timeago",{attrs:{since:a._updatedAt,locale:e.TranslateService.locale}})],1)],2)])])])])]}}],null,!1,2047505766)})],1)]):e._e()},ds=[],us=p(os,cs,ds,!1,null,null,null,null);const hs=us.exports;let K;window.TranslateService?K=window.TranslateService:K=h;const oe=t=>{const e={},s=i.get(t,"model","").split(".");return i.get(t,"localised",!1)&&(e.locale=s.shift()),e.key=s.join("."),e},ms=t=>String(t).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),Y={url:t=>{try{return!!new URL(t)}catch{return!1}},number:t=>i.isNumber(t),integer:t=>i.isNumber(t)&&i.isInteger(t),double:t=>i.isNumber(t)&&(i.isInteger(t)||t===+t&&t!==(t|0)),text:t=>i.isString(t),array:t=>i.isArray(t),email:t=>ms(t)},D={fieldIsRequired:K.get("TL_FIELD_IS_REQUIRED"),invalidFormat:K.get("TL_INVALID_FORMAT")},ae=(t,e,s,a)=>{if(i.get(t,"required",!1)&&!i.isNumber(e))return D.fieldIsRequired;const r=i.get(Y,a,!1);return r?r(Number(e||0),t,s,D):(console.error(`checkNumber - No validator found for type '${a}'`),!1)},k={array:t=>i.isArray(t),email:t=>new RegExp("/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/").test(t),text:(t,e,s)=>{if(i.get(e,"required",!1)&&(!i.isString(t)||i.isEmpty(t)))return D.fieldIsRequired;const a=i.head(i.get(e,"model","").split("."));if(i.get(e,"regex.value",!1)===!1&&i.get(e,`regex['${a}'].value`,!1)===!1)return!0;let r=!1,n=!1;if(e.localised&&a&&(r=i.get(e,`regex['${a}'].value`,!1),n=i.get(e,`regex['${a}'].description`,!1)),r===!1&&(r=i.get(e,"regex.value",!1),n=i.get(e,"regex.description",!1)),n===!1&&(n=r),r&&i.isString(r)){const l=r.match(/\/(.*?)\/([gimy])?$/);if(!new RegExp(l[1],l[2]||"").test(t))return`${D.invalidFormat} (${K.get(n)})`}return!0},number:(t,e,s)=>ae(e,t,s,"number"),double:(t,e,s)=>ae(e,t,s,"double"),integer:(t,e,s)=>(i.isUndefined(t)&&(t=""),t.toString().indexOf(".")!==-1?!1:ae(e,t,s,"integer")),image:(t,e,s)=>{const{key:a,locale:r}=oe(e),n=i.find(i.get(s,"_attachments",[]),l=>!(l._name!==a||r&&l._fields.locale!==r));return i.get(e,"required",!1)&&!n?D.fieldIsRequired:!0},file:(t,e,s)=>{const{key:a,locale:r}=oe(e),n=i.find(i.get(s,"_attachments",[]),l=>!(l._name!==a||r&&l._fields.locale!==r));return i.get(e,"required",!1)&&!n?D.fieldIsRequired:!0},select:(t,e,s)=>i.get(e,"required",!1)&&i.isEmpty(t)?D.fieldIsRequired:!0,pillbox:(t,e,s)=>i.get(e,"required",!1)&&(!i.isArray(t)||i.isEmpty(t))?D.fieldIsRequired:!0};let xe={string:{type:"input",overrideType:"CustomInput",validator:k.text},text:{type:"textarea",overrideType:"CustomTextarea",rows:5,validator:k.text},password:{type:"input",inputFieldType:"password",overrideType:"CustomInput"},email:{type:"input",overrideType:"CustomInput",inputFieldType:"email",validator:Y.email},url:{type:"input",overrideType:"CustomInput",validator:Y.url},number:{type:"input",overrideType:"CustomInput",inputFieldType:"number",validator:k.number},double:{type:"input",overrideType:"CustomInput",inputFieldType:"number",validator:k.double},integer:{type:"input",overrideType:"CustomInput",inputFieldType:"number",validator:k.integer},checkbox:{type:"switch",overrideType:"CustomCheckbox"},date:{type:"CustomDatetimePicker",format:"YYYY-MM-DD",customDatetimePickerOptions:{format:"YYYY-MM-DD"}},time:{type:"CustomDatetimePicker",format:"hh:mm:ss a",customDatetimePickerOptions:{format:"hh:mm:ss a"}},datetime:{type:"CustomDatetimePicker",format:"YYYY-MM-DD hh:mm:ss a",customDatetimePickerOptions:{format:"YYYY-MM-DD hh:mm:ss a"}},pillbox:{type:"CustomInputTag",selectOptions:{multiple:!0,searchable:!0,onNewTag(t,e,s,a){s.push(t),a.push(t)}},values:[],validator:k.pillbox},select:{type:"CustomMultiSelect",selectOptions:{multiple:!1,trackBy:"_id",customLabel:(t,e)=>i.get(e,t,t),searchable:!0},validator:k.select},multiselect:{type:"CustomMultiSelect",selectOptions:{multiple:!0,listBox:!0,trackBy:"_id",customLabel:(t,e)=>i.get(e,t,t),searchable:!0},validator:Y.array},json:{type:"TreeView",overrideType:"CustomTreeView",treeViewOptions:{maxDepth:4,rootObjectKey:"root",modifiable:!1}},code:{type:"Code",overrideType:"CustomCode",options:{}},wysiwyg:{type:"Wysiwyg",overrideType:"WysiwygField"},image:{type:"ImageView",validator:k.image},file:{type:"AttachmentView",validator:k.file},paragraph:{type:"ParagraphView"},group:{type:"group",overrideType:"Group"},object:{type:"JsonEditor"},color:{type:"ColorPicker",colorPickerOptions:{}},paragraphImage:{type:"paragraphAttachmentView",overrideType:"ParagraphAttachmentView",fileType:"image",validator:k.image},paragraphFile:{type:"paragraphAttachmentView",overrideType:"ParagraphAttachmentView",validator:k.file}};i.each(xe,t=>{t.dense=!0,t.rounded=!0,t.filled=!0});class ps{constructor(){this.typeMapper=xe}getKeyLocale(e){return oe(e)}}const fe=new ps;let T;window.TranslateService?T=window.TranslateService:T=h;class fs{constructor(){this.typeMapper=fe.typeMapper}getSchemaFields(e,s,a,r,n,l,o){let c=i.map(e,d=>{const _=s.locales&&(d.localised||i.isUndefined(d.localised)),b=d.label&&T.get(d.label);let g=i.extend({},this.typeMapper[d.input],{label:`${b||d.field}${_?` (${T.get(`TL_${a.toUpperCase()}`)})`:""}`,model:_?`${a}.${d.field}`:d.field,originalModel:d.field,placeholder:`${b||d.field}${_?` (${T.get(`TL_${a.toUpperCase()}`)})`:""}`,disabled:n||i.get(d,"options.disabled",!1),readonly:i.get(d,"options.readonly",!1),required:!!d.required,options:d.options,resource:s,locale:a,userLocale:r,rootView:o});if(g=i.merge({},d.options,g),d.input==="file"&&i.get(g,"maxCount",!1)===!1)g.maxCount=1/0;else if(d.input==="select"&&i.get(g,"labels",!1))g.selectOptions.label=i.map(g.labels,(E,I)=>({value:I,text:i.get(E,`${a}`,E)}));else if(d.input==="multiselect"&&i.get(g,"labels",!1)&&!i.isObject(i.first(d.source))){const E=[];i.forEach(d.source,I=>{E.push({text:i.get(g,`labels.${I}`,I),value:I})}),d.source=E}return(d.input==="select"||d.input==="pillbox")&&(g.selectOptions.selectLabel=T.get("TL_MULTISELECT_SELECT_LABEL"),g.selectOptions.selectGroupLabel=T.get("TL_MULTISELECT_SELECT_GROUP_LABEL"),g.selectOptions.selectedLabel=T.get("TL_MULTISELECT_SELECTED_LABEL"),g.selectOptions.deselectLabel=T.get("TL_MULTISELECT_DESELECT_LABEL"),g.selectOptions.deselectGroupLabel=T.get("TL_MULTISELECT_DESELECT_GROUP_LABEL"),g.selectOptions.tagPlaceholder=T.get("TL_MULTISELECT_TAG_PLACEHOLDER")),d.input==="pillbox"&&(g.selectOptions.min=d.min,g.selectOptions.max=d.max),g});for(const d in e){const _=e[d];i.isArray(_.source)?c[d].values=_.source:i.isString(_.source)&&this.updateFieldSchema(c,_,d,a,l),c[d].localised=s.locales&&(_.localised||i.isUndefined(_.localised))}return c}updateFieldSchema(e,s,a,r,n){const l=L.get(s.source);n=i.extend({},n,i.get(s,"options.extraSources")),i.each(n,(_,b)=>{const g=L.get(_);i.each(l,E=>{const I=i.get(E,b);i.isString(I)&&i.set(E,b,i.find(g,{_id:I}))})});const o=L.getSchema(s.source),c=o&&i.first(o.schema);let d="_id";c&&(d=c.field,o.locales&&r&&(c.localised||i.isUndefined(c.localised))&&(d=`${r}.${d}`)),e[a].values=l||[],e[a].type==="CustomMultiSelect"&&(e[a].selectOptions=e[a].selectOptions||{},e[a].selectOptions=i.clone(e[a].selectOptions),e[a].selectOptions.key="_id",e[a].selectOptions.customLabel=_=>{const b=i.isString(_)?i.find(l,{_id:_}):_;return e[a].customLabel?le.render(e[a].customLabel,b):i.get(b,d)})}getKeyLocale(e){return fe.getKeyLocale(e)}getNestedGroups(e,s,a,r,n){let l=i.groupBy(s,o=>{let c=o.originalModel;return n&&(c=c.replace(n,"")),c=c.split("."),c[a]});return l=i.map(l,(o,c)=>{if(i.uniqBy(o,"originalModel").length===1){const b=i.first(o);return o.length>1&&console.warn(`duplicated field '${b.model}' detected in resource '${e.displayname||e.title}'`),b}let d=`${r}.${c}`;i.isUndefined(r)&&(d=c);let _=i.get(e,`groups.${d}.label`,c);return _=T.get(_),i.extend({},this.typeMapper.group,{label:_,key:c,path:r,groupOptions:{fields:this.getNestedGroups(e,o,a+1,r,n)}})}),l}}const X=new fs,ge=window.TranslateService||h,Te={mixins:[F],methods:{async uploadAttachments(t,e){this.$loading.start("uploadAttachments");try{for(const s of e){const a=new FormData;a.append(s._name,s.file),s._fields.locale&&a.append("locale",s._fields.locale),s._filename&&a.append("_filename",s._filename),s._fields.fileItemId&&a.append("fileItemId",s._fields.fileItemId),i.get(s,"cropOptions",!1)&&(console.warn("detected cropOptions, will add it to the request"),a.append("cropOptions",JSON.stringify(s.cropOptions))),i.get(s,"orderUpdated",!1)&&i.get(s,"order",!1)&&a.append("order",s.order),await $.post(`../api/${this.resource.title}/${t}/attachments`,a)}}catch(s){console.error("Error happen during uploadAttachments:",s)}this.$loading.stop("uploadAttachments")},async updateAttachments(t,e){this.$loading.start("updateAttachments");try{for(const[s,a]of e.entries()){const r=i.omit(i.get(a,"cropOptions",{}),["updated"]),n=i.get(a,"order",s+1);await $.put(`../api/${this.resource.title}/${t}/attachments/${a._id}`,{cropOptions:r,order:n})}}catch(s){console.error("Error happen during updateAttachments:",s)}this.$loading.stop("updateAttachments")},async removeAttachments(t,e){this.$loading.start("remove-attachments");try{for(const s of e)await $.delete(`../api/${this.resource.title}/${t}/attachments/${s._id}`)}catch(s){console.error("Error happen during removeAttachments:",s)}this.$loading.stop("remove-attachments")},getTypePrexix(t){let e="TL_ERROR_ON_RECORD_";return t==="create"?e+="CREATION":t==="update"?e+="UPDATE":t==="delete"&&(e+="DELETE"),e?ge.get(e):"Error"},manageError(t,e,s){let a=this.getTypePrexix(e),r=a;if(i.get(t,"response.data.code",500)===400){const n=i.get(t,"response.data");i.get(n,"message",!1)?r=`${a}: ${n.message}`:r=`${a}: ${ge.get("TL_UNKNOWN_ERROR")}`}console.error(r,s),this.notify(r,"error")},formatSchemaLayout(t){if(!i.get(t,"layout.lines",!1))return t;const e=[];return i.each(t.layout.lines,s=>{s.slots=s.slots||i.get(s,"fields.length",1),i.each(s.fields,a=>{a.schema=i.find(t.fields,{model:a.model}),i.isUndefined(a.schema)&&(a.schema=i.find(t.fields,{originalModel:a.model})),i.isUndefined(a.schema)?console.error(`Couldn't find schema for field ${a.model}`):e.push(a.model)})}),i.each(t.fields,s=>{!i.includes(e,s.model)&&!i.includes(e,s.originalModel)&&t.layout.lines.push({fields:[{model:s.model,schema:s}]})}),t},async updateSchema(){try{const t=!(this.record&&this.record._local);this.$loading.start("loading-schema");const e=X.getSchemaFields(this.resource.schema,this.resource,this.locale||this.userLocale,this.userLocale,t,this.resource.extraSources),s=X.getNestedGroups(this.resource,e,0);this.schema=this.formatSchemaLayout({fields:s,layout:i.cloneDeep(this.resource.layout)}),this.$loading.stop("loading-schema"),this.originalFieldList=e}catch(t){console.error("AbstractEditorView - updateSchema - Error happen during updateSchema:",t)}}}},gs={mixins:[Te,F],props:{resource:{type:Object,default:()=>{}},record:{type:Object,default:()=>{}},locale:{type:String,default:()=>"enUS"},userLocale:{type:String,default:()=>"enUS"}},data(){return{scrolledToBottom:!1,randomId:Math.random(),formValid:!1,fileInputTypes:["file","img","image","imageView","attachmentView"],cachedMap:{},editingRecord:{},originalFieldList:[],schema:{fields:[]},isReady:!1,formElem:!1,formOptions:{validateAfterLoad:!0,validateAfterChanged:!0}}},watch:{async locale(){await this.updateSchema(),this.editingRecord=i.clone(this.editingRecord),this.checkDirty()},async record(){await this.updateSchema(),this.cloneEditingRecord()},async userLocale(){await this.updateSchema(),this.editingRecord=i.clone(this.editingRecord),this.checkDirty()}},async mounted(){await this.updateSchema(),this.cloneEditingRecord(),this.isReady=!0,G.events.on("select",this.onFieldSelected),this.$nextTick(()=>{this.formElem=document.getElementById(this.randomId)})},beforeDestroy(){G.events.off("select",this.onFieldSelected)},methods:{onScroll({target:{scrollTop:t,clientHeight:e,scrollHeight:s}}){this.scrolledToBottom=t+e>=s-50},toggleLocale(){this.selectLocale(i.find(this.resource.locales,t=>t!==this.locale))},getLocaleTranslation(t){return h.get("TL_"+t.toUpperCase())},getFieldRealOffset(t){return i.get(t,"$el.offsetTop",t.offsetTop)-50},onFieldSelected(t){this.schema.fields=i.map(this.schema.fields,e=>{const s=`${e.localised?`${h.locale}.`:""}${t.field}`;if(e.model===s){const a=document.getElementById(`${s}-${this.randomId}`),r=this.getFieldRealOffset(a);this.formElem.scrollTo({top:r})}return e})},back(){this.$emit("back")},onError(t){console.log(999,"error",t)},selectLocale(t){this.$emit("update:locale",t)},cloneEditingRecord(){const t={};i.each(this.resource.schema,e=>{if(i.includes(this.fileInputTypes,e.input))return;if(this.resource.locales&&(e.localised||i.isUndefined(e.localised)))i.each(this.resource.locales,a=>{const r=`${a}.${e.field}`;let n=i.get(this.record,r);e.input==="pillbox"?n=n||[]:e.input==="json"&&(n=n||{}),i.isPlainObject(n)&&(n=i.cloneDeep(n)),i.set(t,r,n)});else{const a=e.field;let r=i.get(this.record,a);e.input==="pillbox"&&(r=r||[]),e.input==="json"&&(r=r||{}),i.isPlainObject(r)&&(r=i.cloneDeep(r)),i.set(t,a,r)}}),this.editingRecord=i.clone(t),this.editingRecord._id=this.record._id;try{this.editingRecord._attachments=i.cloneDeep(this.record._attachments||[])}catch(e){console.error("Error during cloneEditingRecord:",e),this.editingRecord._attachments=[]}this.removeDirtyFlags()},async deleteRecord(){if(window.confirm(h.get("TL_ARE_YOU_SURE_TO_DELETE"),h.get("TL_YES"),h.get("TL_NO")))if(i.isUndefined(this.editingRecord._id))this.editingRecord={},this.$emit("update:record",null);else{this.$loading.start("delete-record");try{await $.delete(`../api/${this.resource.title}/${this.editingRecord._id}`),this.notify(h.get("TL_RECORD_DELETED",null,{id:this.editingRecord._id})),this.$emit("updateRecordList",null)}catch(t){console.error("Error happen during deleteRecord:",t),this.manageError(t,"delete",this.editingRecord)}this.$loading.stop("delete-record")}},checkFormValid(){let t=!1;try{t=this.$refs.vfg.validate()}catch(s){console.error("Not valid: ",s),t=!1}const e=i.find(this.$refs.vfg.inputs,s=>!s.valid);if(i.isUndefined(e)||(t=!1,e.focus()),this.formValid=t,!this.formValid){const s=this.editingRecord._id?h.get("TL_ERROR_CREATING_RECORD_ID",null,{id:this.editingRecord._id}):h.get("TL_ERROR_CREATING_RECORD");this.notify(s,"error")}},fieldValueOrDefault(t,e){return t.input==="pillbox"?e||[]:t.input==="json"?e||{}:e},updateLocalisedField(t,e){i.each(this.resource.locales,s=>{if(!this.formValid)return this.handleFormNotValid();const a=`${s}.${e.field}`,r=this.fieldValueOrDefault(e,i.get(this.editingRecord,a));if(s!==this.locale&&e.required&&(i.isUndefined(r)||e.input==="string"&&r.length===0)){this.selectLocale(s),this.formValid=!1,this.$forceUpdate(),this.$nextTick(()=>{this.checkFormValid()}),console.warn("required field empty",e,this.formValid);return}i.isEqual(r,i.get(this.record,a))||i.set(t,a,r)})},handleFormNotValid(){console.info("form not valid")},async createUpdateClicked(){if(this.checkFormValid(),!this.formValid)return this.handleFormNotValid();const t={};i.each(this.resource.schema,s=>{if(!this.formValid||i.includes(this.fileInputTypes,s.input))return;if(this.resource.locales&&(s.localised||i.isUndefined(s.localised)))this.updateLocalisedField(t,s);else{const r=s.field,n=this.fieldValueOrDefault(s,i.get(this.editingRecord,r));i.isEqual(n,i.get(this.record,r))||i.set(t,r,n)}});const e=i.filter(this.editingRecord._attachments,s=>!s._id);if(i.isEmpty(e)||console.warn("NEW ATTACHMENTS = ",e),!this.formValid)return this.handleFormNotValid();if(i.isUndefined(this.editingRecord._id))return this.createRecord(t,e);this.updateRecord(t,e)},async createRecord(t,e){this.$loading.start("create-record");try{const{data:s}=await $.post(`../api/${this.resource.title}`,t);await this.uploadAttachments(s._id,e),this.notify(h.get("TL_RECORD_CREATED",null,{id:s._id})),this.$emit("updateRecordList",s)}catch(s){console.error("Error happen during createRecord:",s),this.manageError(s,"create")}this.$loading.stop("create-record")},async updateRecord(t,e){this.$loading.start("update-record");try{let s=this.editingRecord;console.info("Will send",t),i.isEmpty(t)||(s=(await $.put(`../api/${this.resource.title}/${this.editingRecord._id}`,t)).data),await this.uploadAttachments(s._id,e);const a=i.map(e,"_id"),r=i.filter(this.editingRecord._attachments,l=>l._id&&!i.includes(a,l._id)&&(i.get(l,"cropOptions.updated",!1)||i.get(l,"orderUpdated",!1)));i.isEmpty(r)||(console.warn("UPDATED ATTACHMENTS = ",i.map(r,l=>`${l.orderUpdated}-${l.order}-${l._filename}`)),await this.updateAttachments(s._id,r));const n=i.filter(this.record._attachments,l=>!i.find(this.editingRecord._attachments,{_id:l._id}));i.isEmpty(n)||(console.warn("REMOVED ATTACHMENTS = ",i.map(n,l=>`${l.order}-${l._filename}`)),await this.removeAttachments(s._id,n)),this.notify(h.get("TL_RECORD_UPDATED",null,{id:this.editingRecord._id})),this.$emit("updateRecordList",s)}catch(s){console.error("Error happen during updateRecord:",s),this.manageError(s,"update",this.editingRecord)}this.$loading.stop("update-record")},getAttachmentModel(t){const e=[];return i.get(t,"_fields.locale",!1)&&e.push(t._fields.locale),e.push(t._name),i.join(e,".")},updateFields(t,e){if(!this.isAttachmentField(e))return i.set(this.editingRecord,e,t);i.set(this.editingRecord,"_attachments",t),console.info(`Will update attachment ${e}`,t)},onModelUpdated(t,e){this.updateFields(t,e),this.checkDirty()},isAttachmentField(t){const e=i.get(i.find(i.get(this.schema,"fields",[]),{model:t}),"originalModel",!1),s=i.get(i.find(this.resource.schema,{field:e}),"input",!1);return i.includes(this.fileInputTypes,s)},checkDirty(){i.each(this.originalFieldList,t=>{let e=!0;if(i.includes(["AttachmentView","ImageView"],t.type)){const{key:s,locale:a}=this.getKeyLocale(t),r=i.filter(this.record._attachments,l=>l._name===s&&(l._fields&&l._fields.locale)===a),n=i.filter(this.editingRecord._attachments,l=>l._name===s&&(l._fields&&l._fields.locale)===a);e=i.isEqual(r,n)}else e=i.isEqual(i.get(this.record,t.model),i.get(this.editingRecord,t.model));t.labelClasses=e?"":"dirty"})},removeDirtyFlags(){i.each(this.originalFieldList,t=>{delete t.labelClasses})},getKeyLocale(t){const e={},s=t.model.split(".");return t.localised&&(e.locale=s.shift()),e.key=s.join("."),e}}};var _s=function(){var e=this,s=e._self._c;return e.record?s(R,{staticClass:"record-editor",class:{frozen:!e.record._local},attrs:{elevation:"0"}},[s("div",{staticClass:"top-bar"},[s("top-bar-locale-list",{attrs:{locales:e.resource.locales,locale:e.locale,"select-locale":e.selectLocale,back:e.back}}),s("div",{staticClass:"buttons"},[e.editingRecord._id?s(y,{staticClass:"delete",attrs:{elevation:"0",icon:"",rounded:""},on:{click:e.deleteRecord}},[s(m,[e._v("mdi-trash-can-outline")])],1):e._e(),s(y,{staticClass:"update",attrs:{elevation:"0",rounded:""},on:{click:e.createUpdateClicked}},[e._v(e._s(e._f("translate")(e.editingRecord._id?"TL_UPDATE":"TL_CREATE")))])],1)],1),s("div",{staticClass:"scroll-wrapper",class:{"scrolled-to-bottom":e.scrolledToBottom},on:{scroll:e.onScroll}},[s(Ve,{ref:"vfg",staticClass:"record-editor-form",attrs:{id:e.randomId,"lazy-validation":""},model:{value:e.formValid,callback:function(a){e.formValid=a},expression:"formValid"}},[e.isReady?s("custom-form",{attrs:{schema:e.schema,"form-id":e.randomId,"form-options":e.formOptions,model:e.editingRecord,"paragraph-level":1},on:{"update:model":function(a){e.editingRecord=a},error:e.onError,input:e.onModelUpdated}}):e._e()],1)],1)]):e._e()},vs=[],ys=p(gs,_s,vs,!1,null,null,null,null);const Ie=ys.exports,bs={props:["resource","schema","items","locale","options","selectedRecords"],data(){return{localSelectedRecords:[],columns:[],sourceData:[],tableData:[],rowStyleOption:{stripe:!0},filteredColumns:[],sortOption:{multipleSort:!0,sortAlways:!0,sortChange:t=>{this.tableData=i.sortBy(this.tableData,i.keys(t),i.values(t))}},clipboardOption:{copy:!0,paste:!1,cut:!1,delete:!1,beforeCopy:({data:t,selectionRangeIndexes:e,selectionRangeKeys:s})=>(navigator.clipboard.writeText(this.getDataToCopy(e)),!1)},columnWidthResizeOption:{enable:!0,minWidth:50}}},computed:{orderedItem(){return this.items},schemaFields(){let t=this.schema.fields,e=[];i.forEach(t,a=>{i.get(a,"options.breakdown",!1)&&i.forEach(this.resource.locales,(r,n)=>{if(a.model===`${r}.${a.originalModel}`)a.localised=!1,a.options.localeIndex=n+1;else{let l=i.cloneDeep(a);l.localised=!1;const o=a.originalModel&&h.get(a.originalModel);l.label=`${o} (${h.get(`TL_${r.toUpperCase()}`)})`,l.model=`${r}.${a.originalModel}`,i.set(l,"options.localeIndex",n+1),e.push(l)}}),a.disabled=!0}),t=t.concat(e);let s=i.filter(t,a=>i.isNumber(i.get(a,"options.index",!1)));return i.isEmpty(s)?this.schema.fields:i.sortBy(s,a=>`${a.options.index}${i.get(a,"options.localeIndex",0)}`)}},watch:{items(){this.resetRecordsFiltering()}},mounted(){this.resetRecordsFiltering(),this.createTableColumns()},methods:{getDataToCopy(t){let e=t.startColIndex,s=t.endColIndex;const a=this.columns.slice(e,s+1).map(l=>l.field),r=this.tableData.slice(t.startRowIndex,t.endRowIndex+1).map(l=>i.map(a,o=>i.get(l,o,"")));let n="";return i.each(r,(l,o)=>{o!==0&&(n+=`
`),n+=l.join("	")}),n},deleteSelectedRecords(){this.$emit("remove-records",i.filter(this.sourceData,t=>i.includes(this.selectedRecords,t._id)))},resetRecordsFiltering(){this.sourceData=this.orderedItem,this.tableData=this.sourceData.slice(0)},createTableColumns(){const t=[{field:"__RECORD_SELECTION__",key:"__RECORD_SELECTION__",fixed:"left",align:"center",disableResizing:!0,width:20,renderBodyCell:({row:e,column:s,rowIndex:a},r)=>r("TableRecordSelection",{props:{row:e,selected:this.isRecordSelected(e),onChange:this.onSelectRecord}})}];i.each(this.schemaFields,(e,s)=>{const a=this.getFieldType(e),r="Table"+a,n={field:e.model,key:"a"+s,title:e.label,ellipsis:{showTitle:!0,lineClamp:i.get(e,"options.lineClamp",1)},renderBodyCell:({row:l,column:o,rowIndex:c},d)=>i.includes(["CustomInput","CustomMultiSelect"],a)?i.get(l,o.field,""):r in Vue.options.components?d(r,{props:{row:l,column:o,rowIndex:c,field:e}}):(console.error(`${r} isn't defined as a custom field type, will not render it`),i.get(l,o.field,""))};i.get(e,"options.filter",!1)&&(n.filter={filterList:i.uniqBy(i.map(this.sourceData,(l,o)=>({value:o,label:e.type==="switch"?h.get("TL_"+i.toUpper(i.get(l,e.model,!1))):i.get(l,e.model),realValue:i.get(l,e.model),selected:!1})),"label"),isMultiple:i.get(e,"options.filter",!1)==="multiple",filterConfirm:l=>{const o=l.filter(c=>c.selected).map(c=>c.realValue);this.searchBy(o,e.model),i.includes(this.filteredColumns,n.field)||this.filteredColumns.push(n.field)},filterReset:l=>{this.searchBy([],e.model),this.filteredColumns=i.filter(this.filteredColumns,n.field)},filterIcon:()=>i.includes(this.filteredColumns,n.field)?pe(m,["mdi-filter"]):pe(m,["mdi-filter-outline"]),maxHeight:200}),i.each(["sortBy","align"],l=>{const o=i.get(e,`options.${l}`,!1);o!==!1&&i.set(n,l,o)}),t.push(n)}),t.push({field:"__ACTIONS__",key:"__ACTIONS__",title:h.get("TL_ACTIONS"),fixed:"right",disableResizing:!0,width:75,renderBodyCell:({row:e,column:s,rowIndex:a},r)=>r("TableRowActions",{props:{row:e,column:s,rowIndex:a,remove:n=>this.$emit("remove",n),edit:n=>this.$emit("edit",n)}})}),this.columns=t},isRecordSelected(t){return i.includes(this.localSelectedRecords,i.get(t,"_id",!1))},onSelectRecord(t,e){e?this.localSelectedRecords.push(t):this.localSelectedRecords=i.filter(this.localSelectedRecords,s=>s!==t),this.$emit("update:selectedRecords",this.localSelectedRecords)},searchBy(t,e){this.tableData=this.sourceData.filter(s=>t.length===0||t.includes(i.get(s,e)))},editRow(t){console.warn("editRow",t)},getFieldType(t){return i.get(t,"overrideType",i.get(t,"type",!1))}}};var Cs=function(){var e=this,s=e._self._c;return s("div",{ref:"excel-container",staticClass:"vue-table-generator vue-form-generator table"},[s("ve-table",{ref:"tableRef",attrs:{"scroll-width":"0","sort-option":e.sortOption,"virtual-scroll-option":{enable:!0},"column-width-resize-option":e.columnWidthResizeOption,columns:e.columns,"table-data":e.tableData,"fixed-header":!0,"border-around":!0,"border-x":!0,"border-y":!0,"clipboard-option":e.clipboardOption,"row-style-option":e.rowStyleOption,"max-height":"100%","row-key-field-name":"_id"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length===0,expression:"tableData.length === 0"}],staticClass:"empty-data"},[e._v(e._s(e._f("translate")("TL_NO_DATA_FOUND")))])],1)},ws=[],$s=p(bs,Cs,ws,!1,null,"0d37d050",null,null);const Ss=$s.exports,Ls={components:{VueTableGenerator:Ss,RecordEditor:Ie},mixins:[Te,F],props:{groupedList:{type:Array,default:()=>[]},recordList:{type:Array,default:()=>[]},locale:{type:String,default:"enUS"},selectedResourceCallback:{type:Function,default:()=>{}},resource:{type:Object,default:()=>{}},record:{type:Object,default:()=>{}}},data(){return{page:1,menuOpened:!1,isReady:!1,omnibarDisplayed:!1,search:null,cachedMap:{},selectedRecords:[],schema:{fields:[]},TranslateService:h,localLocale:!1,localRecord:{},clonedRecordList:null}},computed:{selectedResourceGroup(){return i.find(this.groupedList,t=>this.groupSelected(t))},options(){return{paging:i.get(this.resource,"options.paging",10),displayId:i.get(this.resource,"options.displayId",!0),displayUpdatedAt:i.get(this.resource,"options.displayUpdatedAt",!0)}},pageCount(){return Math.ceil(this.listCount/this.options.paging)},maxCount(){return i.get(this.resource,"maxCount",0)},listCount(){return i.get(this.clonedRecordList,"length",0)},filteredList(){let t=this.getSearchableFields();return t.length===0&&(t=[i.first(this.resource.schema)]),i.filter(this.clonedRecordList,(e,s)=>{if(i.isEmpty(this.search))return s>=this.options.paging*(this.page-1)&&s<this.options.paging*this.page;const a=[];return i.forEach(t,r=>{a.push(this.getValue(e,r))}),this.doesMatch(this.search,a)||new RegExp(this.search,"i").test(e._id)})}},watch:{async locale(){this.isReady=!1,this.localLocale=this.locale,this.$emit("update:locale",this.localLocale),await this.updateSchema(),this.isReady=!0},async record(){this.localRecord=i.cloneDeep(this.record)},async recordList(){this.clonedRecordList=i.cloneDeep(this.recordList),this.isReady=!1,await this.updateSchema(),this.isReady=!0,this.$forceUpdate()},async userLocale(){this.isReady=!1,await this.updateSchema(),this.isReady=!0}},mounted(){U.events.on("omnibar-display-status",this.onGetOmnibarDisplayStatus)},methods:{onGetOmnibarDisplayStatus(t){this.omnibarDisplayed=t},getShortcuts(){return this.omnibarDisplayed?{}:{esc:["esc"],open:["ctrl","/"]}},async interactiveSearch(t){const e=i.get(t,"srcKey",!1),s=i.get(this.$refs,"['search']",!1);if(!(!e||!s))return e==="esc"?s.blur():s.focus()},getResourceTitle(t){return t?t.displayname?h.get(t.displayname):t.title:""},groupSelected(t){if(!this.resource)return!1;const e=i.get(this.resource,"group.enUS",i.get(this.resource,"group",!1)),s=i.get(t,"name.enUS",t.name);return s==="TL_OTHERS"&&!e?!0:s===e},onPaginationClick(){console.warn("onPaginationClick ---",arguments)},updateRecordList(t){this.$emit("updateRecordList",t)},selectRecord(t){this.localLocale=this.locale,this.$emit("update:record",t)},editRecord(t){this.selectRecord(t)},askConfirmation(t=!1){return window.confirm(h.get(`TL_ARE_YOU_SURE_TO_DELETE${t?"_SELECTED_RECORDS":""}`),h.get("TL_YES"),h.get("TL_NO"))},async removeRecords(){this.askConfirmation(!0)&&await Promise.all(i.map(this.selectedRecords,t=>this.removeRecord({_id:t},!0)))},async removeRecord(t,e=!1){if(!(!e&&!this.askConfirmation())){if(i.isUndefined(t._id))t={},this.$emit("update:record",null);else{this.$loading.start("delete-record");try{await $.delete(`../api/${this.resource.title}/${t._id}`),this.notify(h.get("TL_RECORD_DELETED",null,{id:t._id})),this.$emit("updateRecordList",null)}catch(s){console.error("Error happen during deleteRecord:",s),this.manageError(s,"delete",this.editingRecord)}this.$loading.stop("delete-record")}this.clonedRecordList=i.filter(this.clonedRecordList,s=>t!==s)}},doesMatch(t,e){let s=!1;return i.forEach(e,a=>{if(s=new RegExp(this.search,"i").test(a),s)return!1}),s},async updateRecord(t){const e={};let s=i.find(this.recordList,{_id:t._id});i.each(this.resource.schema,n=>{if(n.input==="file"||n.input==="image")return;if(this.resource.locales&&(n.localised||i.isUndefined(n.localised)))i.each(this.resource.locales,o=>{const c=`${o}.${n.field}`;let d=i.get(t,c);n.input==="pillbox"?d=d||[]:n.input==="json"&&(d=d||{}),!i.isEqual(d,i.get(s,c))&&i.set(e,c,d)});else{const o=n.field;let c=i.get(t,o);if(n.input==="pillbox"?c=c||[]:n.input==="json"&&(c=c||{}),i.isEqual(c,i.get(s,o)))return;i.set(e,o,c)}});const a=i.filter(t._attachments,n=>!n._id),r=i.filter(s&&s._attachments,n=>!i.find(t._attachments,{_id:n._id}));if(i.isUndefined(t._id)){this.$loading.start("create-record");try{const n=await $.post(`../api/${this.resource.title}`,e);await this.uploadAttachments(n.data._id,a),this.notify(h.get("TL_RECORD_CREATED",null,{id:n.data._id})),this.$emit("updateRecordList",n.data)}catch(n){console.error("Error happend during updateRecord/create:",n),this.manageError(n,"create")}this.$loading.stop("create-record")}else{this.$loading.start("update-record");try{let n;i.isEmpty(e)?n={data:t}:n=await $.put(`../api/${this.resource.title}/${t._id}`,e),await this.uploadAttachments(n.data._id,a),await this.removeAttachments(n.data._id,r),(!i.isEmpty(e)||!i.isEmpty(a)||!i.isEmpty(r))&&this.notify(h.get("TL_RECORD_UPDATED",null,{id:t._id})),this.$emit("updateRecordList",n.data)}catch(n){console.error("Error happend during updateRecord/create:",n),this.manageError(n,"update",t)}this.$loading.stop("update-record")}},async updateRecords(){try{const t=[];this.$loading.start("update-records");let e=i.filter(this.recordList,s=>!i.find(this.clonedRecordList,{_id:s._id}));for(const s of e)t.push(async()=>{this.$loading.start("delete-record"),await $.delete(`../api/${this.resource.title}/${s._id}`),this.notify(h.get("TL_RECORD_DELETED",null,{id:s._id})),this.$emit("updateRecordList",null),this.$loading.stop("delete-record")});for(const s of i.reverse(this.clonedRecordList))t.push(async()=>await this.updateRecord(s));await W(t,{concurrency:10})}catch(t){console.error("Error happens during updateRecords:",t)}this.$loading.stop("update-records")},createRecord(){let t={_local:!0};i.each(this.schema.fields,e=>{i.set(t,e.model,void 0)}),this.clonedRecordList.push(t),this.selectRecord(t)},getSearchableFields(){return i.filter(this.resource.schema,t=>t.searchable===!0)},selectLocale(t){this.$emit("update:locale",t)},getValue(t,e){let s="";if(e)if(e.input==="file"){const a=i(t).get("_attachments",[]).find(r=>r._name===e.field);s=a&&a._filename}else this.resource.locales&&(e.localised||i.isUndefined(e.localised))?s=i.get(t,`${this.locale}.${e.field}`):s=i.get(t,e.field);return s},back(){this.$emit("unsetRecord")}}};var Rs=function(){var e=this,s=e._self._c;return s("div",{staticClass:"record-table-wrapper"},[e.selectedResourceGroup&&e.groupedList?s(q,{attrs:{auto:"","content-class":"resources-menu full-width","offset-y":"","close-on-content-click":!0},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:r}){return[s("div",e._g(e._b({staticClass:"resource-selector",class:{opened:e.menuOpened}},"div",r,!1),a),[s("div",{staticClass:"resource-title"},[e._v(e._s(e.getResourceTitle(e.resource)))]),s(m,{attrs:{large:""}},[e._v("mdi-chevron-down")])],1)]}}],null,!1,341021591),model:{value:e.menuOpened,callback:function(a){e.menuOpened=a},expression:"menuOpened"}},[s(J,{attrs:{rounded:""}},e._l(e.selectedResourceGroup.list,function(a){return s(Z,{key:a.name,class:{selected:a===e.resource},attrs:{dense:""},on:{click:function(r){a!==e.resource&&e.selectResourceCallback(a)}}},[s(ee,[e._v(e._s(e.getResourceTitle(a)))])],1)}),1)],1):e._e(),s(R,{staticClass:"record-table",class:{"has-back-button":e.record},attrs:{elevation:"0"}},[e.record?e._e():s("div",{staticClass:"top-bar"},[s("top-bar-locale-list",{attrs:{locales:e.resource.locales,locale:e.locale,"select-locale":e.selectLocale,back:e.back}}),s("div",{directives:[{name:"shortkey",rawName:"v-shortkey",value:e.getShortcuts(),expression:"getShortcuts()"}],staticClass:"search",on:{shortkey:e.interactiveSearch}},[s(Q,{ref:"search",staticClass:"search-bar",attrs:{"prepend-inner-icon":"mdi-magnify",flat:"",filled:"",rounded:"","hide-details":"",dense:"",placeholder:e._f("translate")("TL_SEARCH"),type:"text",name:"search"},model:{value:e.search,callback:function(a){e.search=a},expression:"search"}})],1),s("div",{staticClass:"buttons"},[e.selectedRecords.length>0?s(y,{staticClass:"delete-selected-records",attrs:{elevation:"0",rounded:""},on:{click:e.removeRecords}},[e._v(e._s(e._f("translate")("TL_DELETE_SELECTED_RECORDS")))]):e._e(),e.maxCount<=0||e.listCount<e.maxCount?s(y,{staticClass:"new",attrs:{elevation:"0",rounded:""},on:{click:e.createRecord}},[e._v(e._s(e._f("translate")("TL_ADD_NEW_RECORD")))]):e._e()],1)],1),e.record?e._e():[e.isReady?s("vue-table-generator",{attrs:{options:e.options,"selected-records":e.selectedRecords,resource:e.resource,schema:e.schema,items:e.filteredList,locale:e.localLocale},on:{"update:selectedRecords":function(a){e.selectedRecords=a},"update:selected-records":function(a){e.selectedRecords=a},"update:locale":function(a){e.localLocale=a},remove:e.removeRecord,edit:e.editRecord}}):e._e()],e.record?s("record-editor",{key:e.record._id,attrs:{record:e.localRecord,resource:e.resource,locale:e.localLocale,"user-locale":e.TranslateService.locale},on:{"update:record":function(a){e.localRecord=a},"update:locale":function(a){e.localLocale=a},updateRecordList:e.updateRecordList,back:e.back}}):e._e()],2)],1)},xs=[],Ts=p(Ls,Rs,xs,!1,null,null,null,null);const Is=Ts.exports;const ks={components:{NavBar:ns,RecordList:hs,RecordEditor:Ie,Loading:Re,LocaleList:Nt,RecordTable:Is},mixins:[F],data(){return{config:!1,locale:"enUS",resourceList:[],selectedResource:null,localeList:[],recordList:[],notification:{},toolbarTitle:!1,selectedResourceGroup:null,selectedRecord:null,selectedPlugin:null,LoadingService:de,TranslateService:h,user:null,multiselect:!1,multiselectItems:[]}},computed:{groupedList(){const t={name:"TL_OTHERS"},e={name:"TL_PLUGINS"};let s=[t,e],a=i.union(this.resourceList,i.map(this.pluginList,r=>i.extend(r,{type:"plugin"})));return i.each(a,r=>{i.isEmpty(r.group)||i.isString(r.group)||i.find(s,l=>{if(i.isEqual(l.name,r.group))return l})||s.push({name:r.group})}),i.each(a,r=>{i.isEmpty(r.group)||i.isString(r.group)&&(i.find(s,l=>{if(l===r.group||l.name===r.group||i.includes(i.values(l.name),r.group))return l})||s.push({name:r.group}))}),i.each(a,r=>{const n=i.find(s,l=>{if(i.isEqual(l.name,r.group)||l===r.group||l.name===r.group||i.includes(i.values(l.name),r.group))return l});if(n){n.list=n.list||[],n.list.push(r);return}r.type==="plugin"?(e.list=e.list||[],e.list.push(r)):(t.list=t.list||[],t.list.push(r))}),s=i.orderBy(s,r=>r.name==="CMS"?String.fromCharCode(0):r===t?String.fromCharCode(255):`${h.get(r.name,"enUS")}`.toLowerCase(),"asc"),i.filter(s,r=>r.list&&r.list.length!==0)},pluginList(){return i.filter(window.plugins,e=>i.isUndefined(e.allowed)?!0:i.isEmpty(this.user)?!1:i.includes(e.allowed,this.user.group))}},watch:{$route:function(){this.$route.query.id!=null&&this.selectResource(i.find(i.union(this.pluginList,this.resourceList),{title:this.$route.query.id}))}},destroyed(){U.events.off("notification",this.onGetNotification)},mounted(){this.$loading.start("init"),O.onLogout(()=>{console.info("User logged out"),window.location.reload()}),U.events.on("notification",this.onGetNotification),this.$nextTick(async()=>{if(await P.init(),this.config=P.config,await h.init(),this.setToolbarTitle(),i.get(window,"noLogin",!1))this.user={};else{O.init();try{this.user=await O.getStatus();const e=i.get(this.user,"theme","light")==="dark";this.$vuetify.theme.dark=e,this.$forceUpdate()}catch(e){const s=i.get(e,"response.data.message",e.message);throw this.notify(s,"error"),e}}try{const e=await $.get(`${window.location.pathname}resources`);this.$loading.stop("init");const s=i.sortBy(e.data,a=>a.title);if(this.resourceList=i.filter(s,a=>i.isUndefined(a.allowed)?!0:i.includes(a.allowed,this.user.group)),L.setSchemas(this.resourceList),this.localeList=h.config.locales,this.$route.query.id!=null){const a=i.find(i.union(this.pluginList,this.resourceList),{title:this.$route.query.id});this.selectResource(a)}}catch(e){console.error("Error while getting resources: ",e)}})},methods:{setToolbarTitle(){this.toolbarTitle=i.get(P.config,`toolbarTitle.${h.locale}`,i.get(P.config,"toolbarTitle",!1))},onGetNotification(t){this.notification=t},getNotificationClass(){return`notification-${this.notification.type}`},getThemeClass(){const t={};return i.set(t,`theme--${i.get(this.user,"theme","light")}`,!0),t},async selectResourceGroup(t){this.selectedResourceGroup=t},async selectResource(t){try{if(i.get(this.$router,"history.current.query.id",!1)!==t.title&&this.$router.push({query:{id:t.title}}).catch(s=>console.error("Router throw an error:",s)),t.type==="plugin"){this.selectedResource=null,this.selectedPlugin=t;return}if(this.onCancelMultiselectPage(),this.selectedResource=t,this.selectedPlugin=null,this.recordList=null,this.selectedRecord=null,!this.selectedResource)return;this.locale=i.first(this.selectedResource.locales),this.$loading.start("selectResource"),await this.cacheRelatedResources(t);const e=L.get(t.title);if(this.recordList=i.sortBy(e,s=>-s._updatedAt),i.get(t,"maxCount",0)===1){const s=i.get(this.recordList,"[0]",!1);s?this.selectRecord(s):this.selectRecord({_local:!0})}this.$loading.stop("selectResource")}catch(e){console.error("Error happen during selectResource:",e)}},async cacheRelatedResources(t){let e=i.union([t.title],i.values(t.extraSources));const s=a=>{i.isArray(a)?i.each(a,r=>{s(r)}):i.each(a,(r,n)=>{switch(n){case"input":{const l=i.get(a,"options.extraSources");switch(e.push(...i.values(l)),r){case"select":case"multiselect":const o=i.get(a,"source");if(i.isString(o)){e.push(o);const c=L.getSchema(o);e.push(...i.values(c.extraSources))}break;case"paragraph":i.each(i.get(a,"options.types"),c=>{s(c);const d=i.get(c,"schema");s(d)})}break}case"extraSources":e.push(...i.values(r))}})};s(t.schema),e=i.uniq(e),await W(i.map(e,a=>async()=>await L.cache(a)),{concurrency:10})},selectRecord(t){this.selectedRecord=t},onSelectMultiselect(t){this.multiselect=t,t&&this.unsetSelectedRecord()},onChangeMultiselectItems(t){this.multiselectItems=i.clone(t)},async updateRecordList(t){try{this.$loading.start("updateRecordList");const e=await L.cache(this.selectedResource.title);this.$loading.stop("updateRecordList"),this.recordList=i.sortBy(e,s=>-s._updatedAt),this.selectRecord(i.find(this.recordList,{_id:i.get(t,"_id")}))}catch(e){console.error("Error happen during updateRecordList:",e)}},unsetSelectedRecord(){this.selectedRecord=null},onCancelMultiselectPage(){this.multiselect=!1,this.multiselectItems=[]}}};var Es=function(){var e=this,s=e._self._c;return s($e,[s(Ue,[e.notification.type?s(Pe,{staticClass:"notification",class:e.getNotificationClass(),attrs:{"multi-line":"",top:"",centered:"",elevation:"10",light:e.$vuetify&&e.$vuetify.theme&&!e.$vuetify.theme.isDark,timeout:e.notification.type==="error"?-1:1e3},scopedSlots:e._u([{key:"action",fn:function({attrs:a}){return[s(y,e._b({attrs:{rounded:"",icon:""},on:{click:function(r){e.notification={}}}},"v-btn",a,!1),[s(m,[e._v("mdi-close-circle-outline")])],1)]}}],null,!1,3250718924),model:{value:e.notification,callback:function(a){e.notification=a},expression:"notification"}},[s("p",[e._v(e._s(e.notification.message))])]):e._e()],1),e.user?s("div",{staticClass:"cms-layout"},[s("div",{staticClass:"cms-inner-layout",class:e.getThemeClass()},[e.resourceList.length>0?s("nav-bar",{attrs:{config:e.config,"toolbar-title":e.toolbarTitle,"locale-class":{locale:e.localeList&&e.localeList.length>1},"select-resource-group-callback":e.selectResourceGroup,"select-resource-callback":e.selectResource,"grouped-list":e.groupedList,"selected-resource-group":e.selectedResourceGroup,"selected-item":e.selectedResource||e.selectedPlugin}}):e._e(),s("div",{staticClass:"resources"},[e.localeList?s("locale-list",{attrs:{"locale-list":e.localeList}}):e._e()],1),s("div",{staticClass:"records"},[e.selectedResource&&(!e.selectedResource.view||e.selectedResource.view=="list")?[e.selectedResource?s("record-list",{attrs:{list:e.recordList,locale:e.locale,"selected-item":e.selectedRecord,"grouped-list":e.groupedList,"resource-group":e.selectedResourceGroup,resource:e.selectedResource,"select-resource-callback":e.selectResource,multiselect:e.multiselect,"multiselect-items":e.multiselectItems},on:{selectItem:e.selectRecord,changeMultiselectItems:e.onChangeMultiselectItems,selectMultiselect:e.onSelectMultiselect,updateRecordList:e.updateRecordList}}):e._e(),e.selectedRecord&&!e.multiselect?s("record-editor",{key:e.selectedRecord._id,attrs:{record:e.selectedRecord,resource:e.selectedResource,locale:e.locale,"user-locale":e.TranslateService.locale},on:{"update:record":function(a){e.selectedRecord=a},"update:locale":function(a){e.locale=a},updateRecordList:e.updateRecordList}}):e._e()]:e._e(),e.selectedResource&&e.selectedResource.view=="table"?s("record-table",{attrs:{"grouped-list":e.groupedList,"resource-group":e.selectedResourceGroup,"select-resource-callback":e.selectResource,"record-list":e.recordList,resource:e.selectedResource,record:e.selectedRecord,locale:e.locale,"user-locale":e.TranslateService.locale},on:{"update:record":function(a){e.selectedRecord=a},"update:locale":function(a){e.locale=a},unsetRecord:e.unsetSelectedRecord,updateRecordList:e.updateRecordList}}):e._e(),e.selectedPlugin?s("plugin-page",{attrs:{plugin:e.selectedPlugin}}):e._e(),e.selectedResource&&e.multiselect?s("multiselect-page",{attrs:{"multiselect-items":e.multiselectItems,locale:e.locale,resource:e.selectedResource,"record-list":e.recordList},on:{cancel:e.onCancelMultiselectPage,changeMultiselectItems:e.onChangeMultiselectItems,updateRecordList:e.updateRecordList}}):e._e()],2),e.LoadingService.isShow?s("loading"):e._e()],1)]):e._e()],1)},Ds=[],Os=p(ks,Es,Ds,!1,null,null,null,null);const Ms=Os.exports;const Fs={components:{Loading:Re},mixins:[F],data(){return{username:null,password:null,activeField:!1,loginFailed:!1,loggingIn:!1,showLoginForm:!1,loaded:!1,LoadingService:de,TranslateService:h}},async mounted(){console.warn("Login page mounted"),this.$loading.start("init");try{i.get(window,"noLogin",!1)||O.init(),await P.init(),await h.init(),this.loaded=!0}catch(t){console.error("Error happen during mounted:",t)}this.loaded=!0,this.$nextTick(()=>{setTimeout(()=>{this.showLoginForm=!0},100)}),this.$loading.stop("init")},methods:{async login(){if(!this.loggingIn){if(!this.username)return this.$refs.username.focus();if(!this.password)return this.$refs.password.focus();this.$loading.start("login"),this.loggingIn=!0;try{await $.post(`${window.location.pathname}login`,{username:this.username,password:this.password}),this.$loading.stop("login"),window.location.reload()}catch(t){console.error("Error happen during login:",t),this.loginFailed=!0,this.$loading.stop("login")}this.loggingIn=!1}}}};var As=function(){var e=this,s=e._self._c;return s($e,[e.loaded?s("div",{staticClass:"cms-layout",class:{displayed:e.showLoginForm}},[s("div",{staticClass:"login-canvas"},[s("form",{on:{submit:function(a){return a.preventDefault(),e.login.apply(null,arguments)}}},[s("div",{staticClass:"node-cms-title"},[e._v(" "+e._s(e._f("translate")("TL_LOGIN"))+" ")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],ref:"username",attrs:{autofocus:"",type:"test",name:"nodeCmsUsername",autocomplete:"on",placeholder:e._f("translate")("TL_USERNAME")},domProps:{value:e.username},on:{input:function(a){a.target.composing||(e.username=a.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],ref:"password",attrs:{type:"password",name:"nodeCmsPassword",autocomplete:"on",placeholder:e._f("translate")("TL_PASSWORD")},domProps:{value:e.password},on:{input:function(a){a.target.composing||(e.password=a.target.value)}}}),e.loginFailed?s("span",{staticClass:"error-message"},[e._v(e._s(e._f("translate")("TL_LOGIN_FAIL")))]):e._e(),s("div",{staticClass:"login-btn-wrapper",class:{disabled:!e.username||!e.password||e.loggingIn}},[s("button",{attrs:{disabled:e.loggingIn}},[e._v(" "+e._s(e._f("translate")("TL_CONFIRM"))+" ")])])])])]):e._e(),e.LoadingService.isShow?s("loading"):e._e()],1)},Ns=[],Vs=p(Fs,As,Ns,!1,null,"d22c9055",null,null);const Us=Vs.exports;const Ps={props:["formId","schema","model","formOptions","disabled","paragraphIndex","paragraphLevel"],created(){i.each(this.schema.fields,t=>{const e=this.getFieldType(t);e in Vue.options.components||console.error(`${e} isn't defined as a custom field type, will not render it`),t.focused=!1}),G.events.on("select",this.onFieldSelected)},beforeDestroy(){G.events.off("select",this.onFieldSelected)},methods:{getFieldId(t){return`${i.isUndefined(t.model)?this.getFieldType(t):t.model}-${i.isUndefined(this.formId)?"1":this.formId}`},getParagraphLevel(t){return i.includes(["ParagraphView","Group"],this.getFieldType(t))?this.paragraphLevel:1},getFieldClasses(t){const e=[`width-${i.get(t,"width","1")}`];return t.schema&&t.schema.focused===-1&&e.push("focused"),e},getLineClasses(t){return[`slots-${i.get(t,"slots","1")}`,`nb-fields-${i.get(t,"fields.length",1)}`]},onFieldSelected(t){i.each(this.schema.fields,e=>{e.focused=e.model===`${e.localised?`${h.locale}.`:""}${t.field}`,e.focused&&setTimeout(()=>{e.focused=-1,this.$forceUpdate()},1)}),this.$forceUpdate()},getFieldType(t){return i.get(t,"overrideType",i.get(t,"type",!1))},onInput(t,e){i.isUndefined(e)&&(e=i.get(i.first(t),"parentKey",!1)),this.$emit("input",t,e,this.paragraphIndex)}}};var Bs=function(){var e=this,s=e._self._c;return e.schema!=null?s("div",{staticClass:"vue-form-generator"},[e.schema.fields?s("fieldset",[e.schema.layout&&e.schema.layout.lines?e._l(e.schema.layout.lines,function(a,r){return s("div",{key:r,staticClass:"line-wrapper",class:e.getLineClasses(a),attrs:{id:`${e.formId}-${r}`}},e._l(a.fields,function(n){return s("div",{key:n.model,staticClass:"field-wrapper",class:e.getFieldClasses(n),attrs:{id:e.getFieldId(n),"data-model":n.model}},[n.schema?s(e.getFieldType(n.schema),{key:n.model,tag:"component",attrs:{schema:n.schema,model:e.model,"form-options":e.formOptions,disabled:n.schema&&n.schema.disabled,focused:n.schema.focused},on:{input:e.onInput}}):e._e()],1)}),0)}):e._l(e.schema.fields,function(a){return s("div",{key:a.model,staticClass:"field-wrapper",class:{focused:a.focused===-1},attrs:{id:e.getFieldId(a),"data-model":a.model}},[s(e.getFieldType(a),{key:a.model,tag:"component",attrs:{"paragraph-level":e.getParagraphLevel(a),schema:a,model:e.model,"form-options":e.formOptions,disabled:a.schema&&a.schema.disabled,focused:a.focused},on:{input:e.onInput}})],1)})],2):e._e()]):e._e()},qs=[],js=p(Ps,Bs,qs,!1,null,"fef7e2da",null,null);const Hs=js.exports;const Gs={props:["plugin"]};var Ks=function(){var e=this,s=e._self._c;return s("div",{staticClass:"plugin-page"},[s(e.plugin.component,{tag:"component"})],1)},zs=[],Ys=p(Gs,Ks,zs,!1,null,"284fcf40",null,null);const Ws=Ys.exports;const Xs={data(){return{timer:null,isLoading:!0,sysLog:[],error:!1,scrollBottom:!0,data:"",stickyId:-1,count:0,destroyed:!1,autoscroll:!0,lastId:-1,tempId:0,logLines:[],filterOutLines:[],searchKey:null,warningQty:0,errorQty:0,ignoreNextScrollEvent:!1,fakeData:[],config:null}},async mounted(){const{data:t}=await C.get(`${window.location.pathname}../api/_syslog/config`);this.config=t,this.config.wss&&A.events.on("syslog",e=>{i.isEmpty(e)||(this.error=!1,this.logLines.push(...e),this.lastId=i.last(this.logLines).id,this.updateSysLog()),this.autoscroll&&(this.ignoreNextScrollEvent=!0,this.$refs.scroller.scrollToBottom())}),this.$nextTick(()=>{this.refreshLog(),this.$refs.scroller&&this.$refs.scroller.$el.addEventListener("scroll",this.detectScroll)})},async destroyed(){this.destroyed=!0,this.$refs.scroller&&this.$refs.scroller.$el.removeEventListener("scroll",this.detectScroll),clearTimeout(this.timer)},methods:{filterLevel(t){this.searchKey=`sift:{level: {$gte: ${t}}}`,this.updateSysLog()},detectScroll(t){const e=i.get(t,"srcElement.scrollHeight",0),s=i.get(t,"srcElement.scrollTop",0),a=i.get(t,"srcElement.clientHeight",0);if(this.ignoreNextScrollEvent){this.ignoreNextScrollEvent=!1;return}this.$nextTick(()=>{this.autoscroll===!1&&s+a>=e&&(this.stickyId=-1),this.autoscroll=s+a>=e})},getLogViewerHeight(){return i.get(this.$refs["log-viewer"],"offsetHeight",100)},onInputSearch(){this.updateSysLog()},onClickRefresh(){this.error=!1,this.searchKey=null,this.logLines=[],this.sysLog=[],this.updateSysLog(),this.lastId=-1},onClickClearSearch(){this.searchKey=null,this.updateSysLog()},onClickAutoscroll(){this.autoscroll=!this.autoscroll},onClickClear(){this.searchKey=null,this.logLines=[],this.sysLog=[],this.updateSysLog()},calculateLineNumberSpacing(t){return i.padStart(t,8,"0")+" |"},jumpTo(t){if(!(!this.searchKey&&this.stickyId!==t)){if(this.stickyId===t){this.stickyId=-1,this.autoscroll=!0;return}this.ignoreNextScrollEvent=!0,this.autoscroll=!1,this.onClickClearSearch(),this.$nextTick(()=>{document.querySelector(`[data-line-id='${t}'][data-is-active='true']`)||this.$refs.scroller.scrollToItem(i.findIndex(this.logLines,s=>s.id===t)-14),this.stickyId=t})}},async refreshLog(){try{if(this.config.wss)A.client&&(A.send({action:"syslog",id:this.lastId}),this.isLoading=!1,this.error=!1);else{const t=await C.get(`${window.location.pathname}../api/_syslog`,{params:{id:this.lastId}});this.isLoading=!1,this.error=!1,i.isEmpty(t.data)||(this.error=!1,this.logLines.push(...t.data),this.lastId=i.last(this.logLines).id,this.updateSysLog()),this.autoscroll&&(this.ignoreNextScrollEvent=!0,this.$refs.scroller.scrollToBottom())}}catch(t){console.error(t),this.error=!0}this.destroyed||(this.timer=setTimeout(this.refreshLog,this.error?2e3:200))},updateSysLog(){let t=i.uniqBy(this.logLines,"id");const e=i.groupBy(this.logLines,"level");if(this.warningQty=i.get(e,"[1].length",0),this.errorQty=i.get(e,"[2].length",0),!i.isEmpty(this.searchKey))if(this.searchKey.search("sift:")===0)try{const s=we.parse(this.searchKey.substr(5));t=t.filter(Ce(s))}catch{}else t=i.filter(t,s=>i.includes(i.toLower(s.line),i.toLower(this.searchKey)));this.sysLog=t,this.filterOutLines=i.get(this.logLines,"length",0)-i.get(this.sysLog,"length",0)}}};var Qs=function(){var e=this,s=e._self._c;return s("div",{staticClass:"syslog"},[s("div",{staticClass:"buttons"},[s("button",{staticClass:"item autoscroll",class:{active:e.autoscroll},on:{click:e.onClickAutoscroll}},[e.autoscroll?s(m,[e._v("mdi-lock-outline")]):s(m,[e._v("mdi-unlock")])],1),s("button",{staticClass:"item clear",on:{click:e.onClickClear}},[s(m,[e._v("mdi-trash-can-outline")])],1),s("button",{staticClass:"item refresh",on:{click:e.onClickRefresh}},[s(m,[e._v("mdi-refresh")])],1),s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchKey,expression:"searchKey"}],staticClass:"item search",class:{"is-sift":e.searchKey&&e.searchKey.search("sift:")===0},attrs:{placeholder:e._f("translate")("TL_SEARCH")},domProps:{value:e.searchKey},on:{input:[function(a){a.target.composing||(e.searchKey=a.target.value)},e.onInputSearch]}}),e.searchKey&&e.searchKey.length>0?s("button",{staticClass:"item clear-search",on:{click:e.onClickClearSearch}},[s(m,[e._v("mdi-close")])],1):e._e(),e.filterOutLines>0?s("div",{staticClass:"item filter-out"},[s(m,[e._v("mdi-target")]),e._v(e._s(e.filterOutLines)+" lines are filter out")],1):e._e(),s("div",{staticClass:"item logs-raised-flags"},[e.warningQty>=0?s("span",{staticClass:"flag-item flag-warning",on:{click:function(a){return e.filterLevel(1)}}},[s(m,[e._v("mdi-flag-outline")]),e._v(" "+e._s(e.warningQty))],1):e._e(),e.errorQty>=0?s("span",{staticClass:"flag-item flag-error",on:{click:function(a){return e.filterLevel(2)}}},[s(m,[e._v("mdi-alert-box-outline")]),e._v(" "+e._s(e.errorQty))],1):e._e()])]),e.error?s("div",{staticClass:"error"},[e._v(" "+e._s(e._f("translate")("TL_ERROR_RETRIEVE_SYSLOG"))+" ")]):e._e(),s("div",{ref:"log-viewer",staticClass:"log-viewer-wrapper"},[s("DynamicScroller",{ref:"scroller",staticClass:"scroller",attrs:{items:e.sysLog,"min-item-size":14},scopedSlots:e._u([{key:"default",fn:function({item:a,index:r,active:n}){return[s("DynamicScrollerItem",{attrs:{item:a,active:n,"size-dependencies":[e.calculateLineNumberSpacing(a.id),a.line],"data-index":r}},[s("div",{staticClass:"line-wrapper",attrs:{"data-line-id":a.id,"data-is-active":n}},[s("div",{staticClass:"line-number",class:{stickId:e.stickyId===a.id,search:e.searchKey},on:{click:function(l){return e.jumpTo(a.id)}}},[e._v(e._s(a.id))]),s("div",{staticClass:"line-content",domProps:{innerHTML:e._s(a.html)}})])])]}}])})],1)])},Js=[],Zs=p(Xs,Qs,Js,!1,null,"e330bd3e",null,null);const ei=Zs.exports;const ti={data(){return{config:null,status:null,error:null,type:0,loading:!1,uploadedXlsx:null,dragover:!1}},async mounted(){const t=await C("./config");this.config=t.data.import},methods:{getRules(){return[t=>!t||t.type==="text/xlsx"||t.type==="text/xls"||t.type==="text/csv"||"Only XLSX/XLS/CSV files allowed"]},clickOnFileInput(){this.$refs.xlsxFile.$refs.input.click()},onDrop(t){if(this.dragover=!1,t.dataTransfer.files.length>1)return console.error("Only one file can be uploaded at a time..");this.onChangeXlsxFile(t,t.dataTransfer.files)},async onChangeXlsxFile(t,e=!1){this.uploadedXlsx=null;const s=i.first(e||i.get(t,"target.files",t))||t;s&&(this.uploadedXlsx=s)},openFile(){window.open(`https://docs.google.com/spreadsheets/d/${this.config.gsheetId}/edit`,"_blank").focus()},async checkStatus(){this.loading=!0,this.status=null,this.error=null,this.$loading.start("cms-import"),this.type=0,this.$nextTick(async()=>{try{const t=await C("../import/status");this.status=t.data}catch(t){this.status=null,this.error=i.get(t,"message",t)}this.$loading.stop("cms-import"),this.loading=!1})},async execute(){this.loading=!0,this.status=null,this.error=null,this.type=1,this.$loading.start("cms-import"),this.$nextTick(async()=>{try{const t=await C("../import/execute");this.status=t.data}catch(t){this.status=null,this.error=i.get(t,"message",t)}this.$loading.stop("cms-import"),this.loading=!1})},async checkXlsxStatus(){this.loading=!0,this.status=null,this.error=null,this.$loading.start("xlsx-import"),this.type=0,this.$nextTick(async()=>{try{const t=new FormData;t.append("xlsx",this.uploadedXlsx);const e=await C.post("../import/statusXlsx",t);this.status=e.data}catch(t){this.status=null,this.error=i.get(t,"message",t)}this.$loading.stop("xlsx-import"),this.loading=!1})},async executeXlsx(){this.loading=!0,this.status=null,this.error=null,this.type=1,this.$loading.start("xlsx-import"),this.$nextTick(async()=>{try{const t=new FormData;t.append("xlsx",this.uploadedXlsx);const e=await C.post("../import/executeXlsx",t);this.status=e.data}catch(t){this.status=null,this.error=i.get(t,"message",t)}this.$loading.stop("xlsx-import"),this.loading=!1})}}};var si=function(){var e=this,s=e._self._c;return s("div",{staticClass:"plugin-wrapper"},[e._m(0),s(R,{staticClass:"cms-import",attrs:{elevation:"0"}},[s("div",{staticClass:"main-container"},[s("div",{staticClass:"config-resources"},[s("h5",[e._v("Resources")]),e.config&&e.config.resources?s(Be,{attrs:{column:""}},e._l(e.config.resources,function(a,r){return s(V,{key:r,attrs:{small:"",ripple:!1}},[e._v(" "+e._s(a)+" ")])}),1):e._e()],1),s("div",{staticClass:"divider dashed"}),s("h5",[e._v("Actions")]),s("div",[s(y,{attrs:{rounded:"",dense:""},on:{click:function(a){return e.openFile()}}},[e._v("Edit Google Sheet")]),s("div",{staticClass:"other-actions"},[s(y,{attrs:{rounded:"",dense:"",disabled:e.loading},on:{click:function(a){return e.checkStatus()}}},[e._v("Check Difference")]),s(y,{attrs:{rounded:"",dense:"",disabled:e.loading},on:{click:function(a){return e.execute()}}},[e._v("Import from Remote")])],1)],1),s("div",{staticClass:"divider dashed"}),s("h5",[e._v("Upload Xlsx")]),s("div",{staticClass:"subtext"},[e._v("Import Excel")]),s(R,{staticClass:"file-input-card",class:{"drag-and-drop":e.dragover,bold:e.uploadedXlsx&&e.uploadedXlsx.name},attrs:{elevation:"0"},on:{drop:function(a){return a.preventDefault(),e.onDrop(a)},dragover:function(a){a.preventDefault(),e.dragover=!0},click:function(a){return e.clickOnFileInput()},dragenter:function(a){a.preventDefault(),e.dragover=!0},dragleave:function(a){a.preventDefault(),e.dragover=!1}}},[e.uploadedXlsx?[e._v(e._s(e.uploadedXlsx.name))]:[e._v("Click or drag & drop to import an .xlsx file")],s(j,{ref:"xlsxFile",staticClass:"hidden-field",attrs:{accept:".xlsx, .xls, .csv",rules:e.getRules(),flat:"",dense:"","hide-details":"",type:"file"},on:{change:e.onChangeXlsxFile}})],2),s("div",{staticClass:"other-actions margin-top"},[s(y,{attrs:{rounded:"",dense:"",disabled:e.loading||!e.uploadedXlsx},on:{click:function(a){return e.checkXlsxStatus()}}},[e._v("Check Difference")]),s(y,{attrs:{rounded:"",dense:"",disabled:e.loading||!e.uploadedXlsx},on:{click:function(a){return e.executeXlsx()}}},[e._v("Import from Remote")])],1),e.status||e.error?s("div",[e.type==0?s("h6",[e._v("Difference:")]):s("h6",[e._v("Status:")]),s("pre",{domProps:{innerHTML:e._s(e.status)}}),e._v(" "),s("pre",{domProps:{innerHTML:e._s(e.error)}})]):e._e()],1)])],1)},ii=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"plugin-title"},[e("h5",[t._v("Cms Import")])])}],ai=p(ti,si,ii,!1,null,"72596d4d",null,null);const ri=ai.exports;const ni={data(){return{statusInterval:null,error:null,config:null,selectedResource:null,recordData:{},reportData:{},syncStatus:{},uniqueKeyMap:{},environments:["local","remote"],syncingEnvironment:null,isEmpty:i.isEmpty,get:i.get,includes:i.includes}},destroyed(){this.statusInterval&&clearInterval(this.statusInterval)},async mounted(){let t;t=await C.get(`${window.location.pathname}resources`),i.each(t.data,e=>{let s=i.find(e.schema,{unique:!0});s&&(this.uniqueKeyMap[e.title]=s.field)}),t=await C.get(`${window.location.pathname}/config`),this.config=t.data,this.selectedResource&&this.update(),this.statusInterval=setInterval(async()=>{if(this.selectedResource){try{await W(i.map(["local","remote"],s=>async()=>{try{const a=await C.get(`${window.location.pathname}/sync/${s}/${this.selectedResource}/status`);this.syncStatus[s]=a.data,this.syncStatus=i.clone(this.syncStatus)}catch(a){console.error(a)}}))}catch{}const e=i.find(this.syncStatus,{status:"syncing"});!e&&this.syncingEnvironment&&(this.$loading.stop("deploy-resource"),e&&e.status==="error"&&(this.error=e.error),this.syncingEnvironment=!1,this.update())}},5*1e3)},methods:{onChangeResource(){this.update()},async update(){this.$loading.start("loading-resource");try{const t=this.uniqueKeyMap[this.selectedResource];this.recordData={},this.reportData={},await W(i.map(this.environments,l=>async()=>{try{let o;o=await C.get(`${window.location.pathname}sync/${l}/${this.selectedResource}`),i.set(this.recordData,l,o.data),o=await C.get(`${window.location.pathname}sync/${l}/${this.selectedResource}/status`),i.set(this.syncStatus,l,o.data),this.syncStatus=i.clone(this.syncStatus)}catch(o){console.error(o)}}),{concurrency:1}),this.recordData=i.clone(this.recordData);const e=this.recordData.local,s=this.recordData.remote,a=i.map(e,l=>l[t]),r=i.map(s,l=>l[t]);let n=i.intersection(a,r);n=i.filter(n,l=>{let o=i.find(e,d=>d[t]===l),c=i.find(s,d=>d[t]===l);return o._attachments=i.map(o._attachments,d=>i.omit(d,["url"])),c._attachments=i.map(c._attachments,d=>i.omit(d,["url"])),!i.isEqual(o,c)}),i.isEmpty(n)||i.each(n,l=>{console.log(l,"local",i.find(e,{[t]:l}),"remote",i.find(s,{[t]:l}))}),this.reportData={create:i.difference(a,r).length,remove:i.difference(r,a).length,update:n.length}}catch(t){console.error(t)}this.$loading.stop("loading-resource")},async onClickDeploy(t,e){this.error=null,this.$loading.start("deploy-resource"),this.syncingEnvironment=!0;try{await C.post(`../sync/${this.selectedResource}/from/${t}/to/${e}`),i.set(this.syncStatus,`${e}.status`,"syncing"),this.syncStatus=i.clone(this.syncStatus)}catch(s){console.error(s),this.syncingEnvironment=!1,this.$loading.stop("deploy-resource")}}}};var li=function(){var e=this,s=e._self._c;return s("div",{staticClass:"sync-resources main"},[s("h1",[e._v("Sync Resources")]),e.config?s("div",[s("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedResource,expression:"selectedResource"}],on:{change:[function(a){var r=Array.prototype.filter.call(a.target.options,function(n){return n.selected}).map(function(n){var l="_value"in n?n._value:n.value;return l});e.selectedResource=a.target.multiple?r:r[0]},e.onChangeResource]}},e._l(e.config.sync.resources,function(a){return s("option",{key:a,domProps:{value:a}},[e._v(e._s(a))])}),0),e.isEmpty(e.recordData)?e._e():s("div",{staticClass:"num-records"},[s("span",[e._v("number of records")]),s("div",{staticClass:"num-records-wrapper"},e._l(e.environments,function(a){return s("div",{key:a,staticClass:"num-record",attrs:{num:e.environments.length}},[s("span",[e._v(e._s(a))]),s("span",[e._v(e._s(e.get(e.recordData,`${a}.length`,"N/A")))])])}),0)]),e.isEmpty(e.reportData)?e._e():s("div",{staticClass:"num-records"},[s("span",[e._v("records difference")]),s("div",{staticClass:"num-records-wrapper"},[s("div",{staticClass:"num-record",attrs:{num:"1",set:e.enabled=e.get(e.recordData,"local.length")!==void 0&&e.get(e.recordData,"remote.length")!==void 0}},[e.enabled?[e.get(e.syncStatus,"local.status")!=="syncing"&&e.get(e.syncStatus,"remote.status")!=="syncing"?[s("span",[e._v("local / remote")]),s("span",[e._v("create: "+e._s(e.reportData.create))]),s("span",[e._v("update: "+e._s(e.reportData.update))]),s("span",[e._v("remove: "+e._s(e.reportData.remove))]),e.includes(e.get(e.syncStatus,"remote.allows"),"write")?s("span",[s("button",{on:{click:function(a){return e.onClickDeploy("local","remote")}}},[e._v("push to remote")])]):e._e(),e.includes(e.get(e.syncStatus,"local.allows"),"write")?s("span",[s("button",{on:{click:function(a){return e.onClickDeploy("remote","local")}}},[e._v("pull from remote")])]):e._e()]:e._e(),e.get(e.syncStatus,"local.status")==="syncing"?[s("span",[e._v("resource: "+e._s(e.get(e.syncStatus,"local.resource")))]),s("span",[e._v("created: "+e._s(e.get(e.syncStatus,"local.created"))+" / "+e._s(e.get(e.syncStatus,"local.createTotal")))]),s("span",[e._v("updated: "+e._s(e.get(e.syncStatus,"local.updated"))+" / "+e._s(e.get(e.syncStatus,"local.updateTotal")))]),s("span",[e._v("removed: "+e._s(e.get(e.syncStatus,"local.removed"))+" / "+e._s(e.get(e.syncStatus,"local.removeTotal")))])]:e._e(),e.get(e.syncStatus,"remote.status")==="syncing"?[s("span",[e._v("resource: "+e._s(e.get(e.syncStatus,"remote.resource")))]),s("span",[e._v("created: "+e._s(e.get(e.syncStatus,"remote.created"))+" / "+e._s(e.get(e.syncStatus,"remote.createTotal")))]),s("span",[e._v("updated: "+e._s(e.get(e.syncStatus,"remote.updated"))+" / "+e._s(e.get(e.syncStatus,"remote.updateTotal")))]),s("span",[e._v("removed: "+e._s(e.get(e.syncStatus,"remote.removed"))+" / "+e._s(e.get(e.syncStatus,"remote.removeTotal")))])]:e._e()]:e._e(),e.enabled?e._e():s("span",{staticClass:"na-field"},[e._v(" N/A ")])],2)])])]):e._e(),e.error?s("div",{staticClass:"error"},[e._v(" Error: "+e._s(e.error)+" ")]):e._e()])},oi=[],ci=p(ni,li,oi,!1,null,"90250774",null,null);const di=ci.exports;let w={fieldIsRequired:"This field is required!",invalidFormat:"Invalid format!",numberTooSmall:"The number is too small! Minimum: {0}",numberTooBig:"The number is too big! Maximum: {0}",invalidNumber:"Invalid number",invalidInteger:"The value is not an integer",textTooSmall:"The length of text is too small! Current: {0}, Minimum: {1}",textTooBig:"The length of text is too big! Current: {0}, Maximum: {1}",thisNotText:"This is not a text!",thisNotArray:"This is not an array!",selectMinItems:"Select minimum {0} items!",selectMaxItems:"Select maximum {0} items!",invalidDate:"Invalid date!",dateIsEarly:"The date is too early! Current: {0}, Minimum: {1}",dateIsLate:"The date is too late! Current: {0}, Maximum: {1}",invalidEmail:"Invalid e-mail address!",invalidURL:"Invalid URL!",invalidCard:"Invalid card format!",invalidCardNumber:"Invalid card number!",invalidTextContainNumber:"Invalid text! Cannot contains numbers or special characters",invalidTextContainSpec:"Invalid text! Cannot contains special characters"};function x(t,e,s=w){return!u.isNil(t)&&t!==""?null:e?[v(s.fieldIsRequired)]:[]}function v(t){if(t!=null&&arguments.length>1)for(let e=1;e<arguments.length;e++)t=t.replace("{"+(e-1)+"}",arguments[e]);return t}const z={resources:w,required(t,e,s,a=w){return x(t,e.required,a)},number(t,e,s,a=w){let r=x(t,e.required,a);if(r!=null)return r;let n=[];return u.isFinite(t)?(!u.isNil(e.min)&&t<e.min&&n.push(v(a.numberTooSmall,e.min)),!u.isNil(e.max)&&t>e.max&&n.push(v(a.numberTooBig,e.max))):n.push(v(a.invalidNumber)),n},integer(t,e,s,a=w){let r=x(t,e.required,a);if(r!=null)return r;let n=z.number(t,e,s,a);return u.isInteger(t)||n.push(v(a.invalidInteger)),n},double(t,e,s,a=w){let r=x(t,e.required,a);if(r!=null)return r;if(!u.isNumber(t)||isNaN(t))return[v(a.invalidNumber)]},string(t,e,s,a=w){let r=x(t,e.required,a);if(r!=null)return r;let n=[];return u.isString(t)?(!u.isNil(e.min)&&t.length<e.min&&n.push(v(a.textTooSmall,t.length,e.min)),!u.isNil(e.max)&&t.length>e.max&&n.push(v(a.textTooBig,t.length,e.max))):n.push(v(a.thisNotText)),n},array(t,e,s,a=w){if(e.required){if(!u.isArray(t))return[v(a.thisNotArray)];if(t.length===0)return[v(a.fieldIsRequired)]}if(!u.isNil(t)){if(!u.isNil(e.min)&&t.length<e.min)return[v(a.selectMinItems,e.min)];if(!u.isNil(e.max)&&t.length>e.max)return[v(a.selectMaxItems,e.max)]}},date(t,e,s,a=w){let r=x(t,e.required,a);if(r!=null)return r;let n=new Date(t);if(isNaN(n.getDate()))return[v(a.invalidDate)];let l=[];if(!u.isNil(e.min)){let o=new Date(e.min);n.valueOf()<o.valueOf()&&l.push(v(a.dateIsEarly,M.format(n),M.format(o)))}if(!u.isNil(e.max)){let o=new Date(e.max);n.valueOf()>o.valueOf()&&l.push(v(a.dateIsLate,M.format(n),M.format(o)))}return l},regexp(t,e,s,a=w){let r=x(t,e.required,a);if(r!=null)return r;if(!u.isNil(e.pattern)&&!new RegExp(e.pattern).test(t))return[v(a.invalidFormat)]},email(t,e,s,a=w){let r=x(t,e.required,a);if(r!=null)return r;if(!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t))return[v(a.invalidEmail)]},url(t,e,s,a=w){let r=x(t,e.required,a);if(r!=null)return r;if(!/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,4}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g.test(t))return[v(a.invalidURL)]},creditCard(t,e,s,a=w){let r=x(t,e.required,a);if(r!=null)return r;const n=/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,l=t.replace(/[^0-9]+/g,"");if(!n.test(l))return[v(a.invalidCard)];let o=0,c,d,_;for(let b=l.length-1;b>=0;b--)c=l.substring(b,b+1),d=parseInt(c,10),_?(d*=2,d>=10?o+=d%10+1:o+=d):o+=d,_=!_;if(!(o%10===0&&l))return[v(a.invalidCardNumber)]},alpha(t,e,s,a=w){let r=x(t,e.required,a);if(r!=null)return r;if(!/^[a-zA-Z]*$/.test(t))return[v(a.invalidTextContainNumber)]},alphaNumeric(t,e,s,a=w){let r=x(t,e.required,a);if(r!=null)return r;if(!/^[a-zA-Z0-9]*$/.test(t))return[v(a.invalidTextContainSpec)]}};Object.keys(z).forEach(t=>{const e=z[t];u.isFunction(e)&&(e.locale=s=>(a,r,n)=>e(a,r,n,u.defaults(s,w)))});const ui=(t,e="")=>typeof t.id<"u"?e+t.id:e+(t.inputName||t.label||t.model||"").toString().trim().toLowerCase().replace(/ |_/g,"-").replace(/-{2,}/g,"-").replace(/^-+|-+$/g,"").replace(/([^a-zA-Z0-9-]+)/g,"");function _e(t){return u.isString(t)?z[t]!=null?z[t]:(console.warn(`'${t}' is not a validator function!`),null):t}function re(t,e,s){let a=u.get(s.context,"schema.attributes",{}),r=e.value||"input";u.isString(r)&&(a=u.get(a,r)||a),u.forEach(a,(n,l)=>{t.setAttribute(l,n)})}const S={props:["model","schema","formOptions","disabled","focused"],data(){return{errors:[],debouncedValidateFunc:null,debouncedFormatFunc:null}},directives:{attributes:{bind:re,updated:re,componentUpdated:re}},watch:{focused(){if(this.focused===-1)return;let t=u.get(this.$refs,"input",!1);if(!t)return console.error("no input ref for ",this.schema);u.isFunction(t.focus)&&this.focused&&t.focus()}},computed:{value:{cache:!1,get(){return u.isFunction(u.get(this.schema,"get"))?this.schema.get(this.model):u.get(this.model,this.schema.model)},set(t){let e=this.value;u.isFunction(t)?t(t,e):this.updateModelValue(t,e)}}},methods:{getOpt(t,e){return u.get(this.schema,`options.${t}`,e)},validate(t){this.clearValidationErrors();let e=u.get(this.formOptions,"validateAsync",!1),s=[];if(this.schema.validator&&this.schema.readonly!==!0&&this.disabled!==!0){let r=[];u.isArray(this.schema.validator)?u.forEach(this.schema.validator,n=>{r.push(_e(n).bind(this))}):r.push(_e(this.schema.validator).bind(this)),u.forEach(r,n=>{if(e)s.push(n(this.value,this.schema,this.model));else{let l=n(this.value,this.schema,this.model);l&&u.isFunction(l.then)?l.then(o=>{o&&(this.errors=this.errors.concat(o));let c=this.errors.length===0;this.$emit("validated",c,this.errors,this)}):l&&(s=s.concat(l))}})}let a=r=>{let n=[];u.forEach(u.uniq(r),o=>{u.isArray(o)&&o.length>0?n=n.concat(o):u.isString(o)&&n.push(o)}),u.isFunction(this.schema.onValidated)&&this.schema.onValidated.call(this,this.model,n,this.schema);let l=n.length===0;return t||this.$emit("validated",l,n,this),this.errors=n,n};return e?Promise.all(s).then(a):a(s)},debouncedValidate(){u.isFunction(this.debouncedValidateFunc)||(this.debouncedValidateFunc=u.debounce(this.validate.bind(this),u.get(this.schema,"validateDebounceTime",u.get(this.formOptions,"validateDebounceTime",500)))),this.debouncedValidateFunc()},updateModelValue(t,e){let s=!1;u.isFunction(this.schema.set)?(this.schema.set(this.model,t),s=!0):this.schema.model&&(this.setModelValueByPath(this.schema.model,t),s=!0),s&&(u.isFunction(this.schema.onChanged)&&this.schema.onChanged.call(this,this.model,t,e,this.schema),u.get(this.formOptions,"validateAfterChanged",!1)===!0&&(u.get(this.schema,"validateDebounceTime",u.get(this.formOptions,"validateDebounceTime",0))>0?this.debouncedValidate():this.validate()),this.$emit("input",t,this.schema.model))},clearValidationErrors(){this.errors.splice(0)},setModelValueByPath(t,e){let s=t.replace(/\[(\w+)\]/g,".$1");s=s.replace(/^\./,"");let a=this.model;const r=s.split(".");let n=0;const l=r.length;for(;n<l;){let o=r[n];if(n<l-1)a[o]!==void 0||this.$root.$set(a,o,{}),a=a[o];else{this.$root.$set(a,o,e);return}++n}},getKeyLocale(){const t={},e=this.schema.model.split(".");return this.schema.localised&&(t.locale=e.shift()),t.key=e.join("."),t},getFieldID(t,e=!1){const s=u.get(this.formOptions,"fieldIdPrefix","");return ui(t,s)+(e?"-"+u.uniqueId():"")},getFieldClasses(){return u.get(this.schema,"fieldClasses",[])}}},hi={mixins:[S],data(){return{options:{maxDepth:0,modifiable:!this.disabled,rootObjectKey:this.schema.model}}},watch:{"schema.model":function(){this.options.rootObjectKey=this.schema.model}},methods:{onChangeData(t){console.warn("onChangeData - ",t),i.set(this.model,i.get(this.schema,"model",!1),t)},get:i.get}};var mi=function(){var e=this,s=e._self._c;return e.schema?s("tree-view",{key:e.schema.model,ref:"input",attrs:{data:e.get(e.model,e.schema.model),options:e.options},on:{"change-data":e.onChangeData}}):e._e()},pi=[],fi=p(hi,mi,pi,!1,null,null,null,null);const gi=fi.exports;const _i={components:{codemirror:qe.codemirror},mixins:[S],data(){return{isReady:!1,cmOption:{height:"auto",viewportMargin:1/0,tabSize:this.getOpt("tabSize",2),styleActiveLine:this.getOpt("styleActiveLine",!0),lineNumbers:this.getOpt("lineNumbers",!0),line:this.getOpt("line",!0),foldGutter:this.getOpt("foldGutter",!0),styleSelectedText:this.getOpt("styleSelectedText",!0),mode:this.getOpt("mode","javascript"),keyMap:"sublime",matchBrackets:this.getOpt("matchBrackets",!0),showCursorWhenSelecting:this.getOpt("showCursorWhenSelecting",!0),theme:"dracula",extraKeys:{Ctrl:"autocomplete"},hintOptions:{completeSingle:!1}}}},watch:{},mounted(){i.isObject(this.value)&&(this.value=""),i.get(this.cmOption,"mode",!1)==="json"&&(this.cmOption.mode="javascript"),this.isReady=!0},methods:{getStyle(){return i.merge({height:i.get(this.schema,"options.height","auto"),width:i.get(this.schema,"options.width","auto")},i.get(this.schema,"options.css",{}))},onChangeData(t){i.set(this.model,i.get(this.schema,"model",!1),t)}}};var vi=function(){var e=this,s=e._self._c;return s("div",{staticClass:"code-wrapper"},[s("div",{staticClass:"label"},[e._v(e._s(e.schema.label))]),e.isReady?s("codemirror",{ref:"input",style:e.getStyle(),attrs:{options:e.cmOption},on:{input:e.onChangeData},model:{value:e.value,callback:function(a){e.value=a},expression:"value"}}):e._e()],1)},yi=[],bi=p(_i,vi,yi,!1,null,null,null,null);const Ci=bi.exports,wi={mixins:[S],props:["locale"],data(){return{acceptedModes:["hexa","rgba","hsla","hex","rgb"],color:"",options:{outputModel:"hexa",hideInputs:!1,hideCanvas:!1,hideSliders:!1,hideModeSwitch:!1}}},watch:{color(){i.set(this.model,this.schema.model,this.color)},"schema.model":function(){this.color=this.getColor()}},created(){const t=i.extend(this.options,this.schema);i.indexOf(this.acceptedModes,t.outputModel)===-1&&(console.warn(`Invalid color mode detected: '${t.outputModel}', will default to hexa`),t.outputModel="hexa"),this.options=t},mounted(){this.color=this.getColor()},methods:{getColor(){return i.get(this.model,this.schema.model)}}};var $i=function(){var e=this,s=e._self._c;return s("div",{staticClass:"wrapper-color"},[s("div",{staticClass:"field-label"},[e.schema.required?s("span",{staticClass:"red--text"},[s("strong",[e._v("* ")])]):e._e(),e._v(e._s(e.schema.label))]),e.options.model?s(je,{key:e.schema.model+"custom",ref:"input",class:{disabled:e.disabled},attrs:{"dot-size":e.options.dotSize,"hide-canvas":e.options.hideCanvas,"hide-sliders":e.options.hideSliders,"hide-inputs":e.options.hideInputs,"hide-mode-switch":e.options.hideModeSwitch,model:e.options.outputModel},model:{value:e.color,callback:function(a){e.color=a},expression:"color"}}):e._e()],1)},Si=[],Li=p(wi,$i,Si,!1,null,null,null,null);const Ri=Li.exports,xi={mixins:[S],data(){return{editor:null,originalValue:null}},watch:{"schema.model":function(){const t=i.extend(this.originalValue,i.get(this.model,this.schema.model));this.editor.setValue(t),i.set(this.model,this.schema.model,t)}},mounted(){const t=i.get(this.$refs,"input",!1);this.schema.jsonEditorOptions.title=" ";const e={schema:this.schema.jsonEditorOptions,theme:"cms",iconlib:"foundation3"};this.disabled&&(e.disable_array_delete=!0),ie.JSONEditor.defaults.themes.cms=class extends ie.JSONEditor.AbstractTheme{getRangeInput(a,r,n){return super.getRangeInput(a,r,n)}getGridContainer(){const a=document.createElement("div");return a.className="json-editor-grid-container",a}getGridRow(){const a=document.createElement("div");return a.className="json-editor-grid-row",a}getFormInputLabel(a){const r=super.getFormInputLabel(a);return r.style.display="inline-block",r.style.fontWeight="bold",r.className="json-editor-input-label",r}setGridColumnSize(a,r){a.className=`span${r}`}getSelectInput(a){return super.getSelectInput(a)}getFormInputField(a){return super.getFormInputField(a)}afterInputReady(a){if(!a.controlgroup&&(a.controlgroup=this.closest(a,".control-group"),a.controls=this.closest(a,".controls"),this.closest(a,".compact")&&(a.controlgroup.className=a.controlgroup.className.replace(/control-group/g,"").replace(/[ ]{2,}/g," "),a.controls.className=a.controlgroup.className.replace(/controls/g,"").replace(/[ ]{2,}/g," "),a.style.marginBottom=0),this.queuedInputErrorText)){const r=this.queuedInputErrorText;delete this.queuedInputErrorText,this.addInputError(a,r)}}getIndentedPanel(){return document.createElement("div")}getModal(){const a=document.createElement("div");return a.style.backgroundColor="white",a.style.border="1px solid black",a.style.boxShadow="3px 3px black",a.style.position="absolute",a.style.zIndex="10",a.style.display="none",a.style.width="auto",a}getInfoButton(a){const r=document.createElement("span");r.className="icon-info-sign pull-right",r.style.padding=".25rem",r.style.position="relative",r.style.display="inline-block";const n=document.createElement("span");return n.style["font-family"]="sans-serif",n.style.visibility="hidden",n.style["background-color"]="rgba(50, 50, 50, .75)",n.style.margin="0 .25rem",n.style.color="#FAFAFA",n.style.padding=".5rem 1rem",n.style["border-radius"]=".25rem",n.style.width="25rem",n.style.transform="translateX(-27rem) translateY(-.5rem)",n.style.position="absolute",n.innerText=a,r.onmouseover=function(){n.style.visibility="visible"},r.onmouseleave=function(){n.style.visibility="hidden"},r.appendChild(n),r}getFormInputDescription(a){const r=document.createElement("p");return r.className="help-inline",r.textContent=a,r}getFormControl(a,r,n,l){const o=document.createElement("div");o.className="control-group";const c=document.createElement("div");return c.className="controls",a&&r.getAttribute("type")==="checkbox"?(o.appendChild(c),a.className+=" checkbox",a.appendChild(r),c.appendChild(a),l&&c.appendChild(l),c.style.height="30px"):(a&&(a.className+=" control-label",o.appendChild(a)),l&&c.appendChild(l),c.appendChild(r),o.appendChild(c)),n&&c.appendChild(n),o}getHeaderButtonHolder(){const a=this.getButtonHolder();return a.className+=" btn-groups",a}getButtonHolder(){const a=document.createElement("div");return a.className="btn-group",a}getButton(a,r,n){const l=super.getButton(a,r,n);return l.className+=" btn btn-default",l}getTable(){const a=document.createElement("table");return a.className="table table-bordered",a}getTableCell(){return document.createElement("td")}addInputError(a,r){if(!a.controlgroup){this.queuedInputErrorText=r;return}!a.controlgroup||!a.controls||(a.controlgroup.className+=" error",a.errmsg?a.errmsg.style.display="":(a.errmsg=document.createElement("p"),a.errmsg.className="help-block errormsg",a.controls.appendChild(a.errmsg)),a.errmsg.textContent=r)}removeInputError(a){a.controlgroup||delete this.queuedInputErrorText,a.errmsg&&(a.errmsg.style.display="none",a.controlgroup.className=a.controlgroup.className.replace(/\s?error/g,""))}getTabHolder(a){const r=typeof a>"u"?"":a,n=document.createElement("div");return n.className="tabbable tabs-left",n.innerHTML=`<ul class='nav nav-tabs'  id='${r}'></ul><div class='tab-content well well-small' id='${r}'></div>`,n}getTopTabHolder(a){const r=typeof a>"u"?"":a,n=document.createElement("div");return n.className="tabbable tabs-over",n.innerHTML=`<ul class='nav nav-tabs' id='${r}'></ul><div class='tab-content well well-small'  id='${r}'></div>`,n}getTab(a,r){const n=document.createElement("li");n.className="nav-item";const l=document.createElement("a");return l.setAttribute("href",`#${r}`),l.appendChild(a),n.appendChild(l),n}getTopTab(a,r){const n=document.createElement("li");n.className="nav-item";const l=document.createElement("a");return l.setAttribute("href",`#${r}`),l.appendChild(a),n.appendChild(l),n}getTabContentHolder(a){return a.children[1]}getTopTabContentHolder(a){return a.children[1]}getTabContent(){const a=document.createElement("div");return a.className="tab-pane",a}getTopTabContent(){const a=document.createElement("div");return a.className="tab-pane",a}markTabActive(a){a.tab.className=a.tab.className.replace(/\s?active/g,""),a.tab.className+=" active",a.container.className=a.container.className.replace(/\s?active/g,""),a.container.className+=" active"}markTabInactive(a){a.tab.className=a.tab.className.replace(/\s?active/g,""),a.container.className=a.container.className.replace(/\s?active/g,"")}addTab(a,r){a.children[0].appendChild(r)}addTopTab(a,r){a.children[0].appendChild(r)}getProgressBar(){const a=document.createElement("div");a.className="progress";const r=document.createElement("div");return r.className="bar",r.style.width="0%",a.appendChild(r),a}updateProgressBar(a,r){a&&(a.firstChild.style.width=`${r}%`)}updateProgressBarUnknown(a){a&&(a.className="progress progress-striped active",a.firstChild.style.width="100%")}},this.editor=new ie.JSONEditor(t,e),this.disabled&&this.editor.disable(),this.editor.on("ready",()=>{this.originalValue=this.editor.getValue();const s=i.extend(this.originalValue,i.get(this.model,this.schema.model));this.editor.setValue(s),i.set(this.model,this.schema.model,s)}),this.editor.on("change",()=>{const s=this.editor.getValue();i.set(this.model,this.schema.model,s)})},methods:{}};var Ti=function(){var e=this,s=e._self._c;return s("div",{ref:"input",staticClass:"json-editor",attrs:{disabled:e.disabled}})},Ii=[],ki=p(xi,Ti,Ii,!1,null,null,null,null);const Ei=ki.exports;const Di={components:{TiptapVuetify:He},mixins:[S],data(){return{loaded:!1,key:null,extensions:[Ge,Ke,ze,Ye,We,Xe,Qe,Je,Ze,[et,{options:{levels:[1,2,3]}}],tt,st,it,at,rt]}},watch:{model(){this.updateObj()}},mounted(){this.updateObj()},created(){},methods:{getColorForToolbar(){return this.$vuetify.theme.dark?"black":"white"},onInit(){setTimeout(()=>{const t=i.get(this.$refs.wysiwygWrapper,"children[1].children[0].children[0].children[0].children[0].children[0].children",[]);i.each(t,e=>{e.tabIndex=-1,i.each(e.children,s=>{s.tabIndex=-1,i.each(s.children,a=>{a.tabIndex=-1})})})},10)},updateObj(){if(!i.get(this.schema,"model",!1))return!1;this.loaded=!0}}};var Oi=function(){var e=this,s=e._self._c;return s("div",{ref:"wysiwygWrapper",staticClass:"wysiwyg-wrapper"},[s("div",{staticClass:"field-label"},[e._v(e._s(e.schema.label))]),s("div",{staticClass:"border-wrapper"},[s("tiptap-vuetify",{ref:"input",attrs:{"card-props":{flat:!0},extensions:e.extensions,"toolbar-attributes":{color:e.getColorForToolbar(),dense:!0,outlined:!0,elevation:1},disabled:e.schema.disabled,placeholder:e._f("translate")("TL_WYSIWYG_PLACEHOLDER")},on:{init:e.onInit,blur:e.onInit,focus:e.onInit},model:{value:e.value,callback:function(a){e.value=a},expression:"value"}})],1)])},Mi=[],Fi=p(Di,Oi,Mi,!1,null,null,null,null);const Ai=Fi.exports,te={data(){return{dragging:!1,dragOptions:{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}}},methods:{onStartDrag(){this.dragging=!0},viewFile(t=!1){var e=t||this.attachment();const s=i.get(e,"_filename","").split("."),a=s.length>1?`.${i.last(s)}`:"";window.open(window.origin+e.url+a,"_blank").focus(),console.log(e)}}};const Ni=["string","text","password","email","url","number","double","integer","checkbox","date","time","datetime","pillbox","json","code","wysiwyg","object","color","image","file"],Vi={mixins:[te],props:["schema","vfg","model","disabled","paragraphLevel"],data(){return{items:i.cloneDeep(i.get(this.model,this.schema.model,[])),types:[],selectedType:!1,localModel:{},key:B()}},watch:{"schema.model":function(){this.items=i.cloneDeep(i.get(this.model,this.schema.model,[]))}},created(){this.updateLocalData()},mounted(){const t=i.get(this,"schema.types",Ni);this.types=i.map(t,e=>(i.isString(e)&&(e={input:e,parentKey:this.schema.model}),e.label||(e.label=i.includes(["select","multiselect"],e.input)?`${e.input}(${e.source})`:e.input),e)),this.selectedType=i.first(this.types)},methods:{onError(t){console.error("ParagraphView - error",t)},updateLocalData(){this.localModel=i.cloneDeep(this.model)},validate(){return i.each(this.$refs.vfg,t=>{if(!t.validate())throw this.errors=t.errors,new Error("group validation error")}),!0},debouncedValidate(){i.each(this.$refs.vfg,t=>{t.debouncedValidate()})},clearValidationErrors(){i.each(this.$refs.vfg,t=>{t.clearValidationErrors()})},getSchema(t){let e=[];const{resource:s,locale:a,userLocale:r,disabled:n}=this.schema;if(t.input==="group")e=i.map(t.schema,d=>i.extend({},d,{field:`value.${d.field}`,localised:this.schema.localised,label:d.label||d.field}));else{const d=i.extend({},t,{field:"value",localised:this.schema.localised});e.push(d)}i.each(e,d=>{i.includes(["image","file"],d.input)&&(d.input=i.camelCase(`paragraph ${d.input}`))});let l={};i.isString(t.source)&&(l=i.get(L.getSchema(t.source),"extraSources",{}));const o=X.getSchemaFields(e,s,a,r,n,l,this.schema.rootView||this);return{fields:X.getNestedGroups(s,o,0,null,"value.")}},getAttachment(t,e){const s=i.find(this.model._attachments,{_fields:{fileItemId:t}});return e?i.get(s,e):s},onChangeType(t){const e=i.find(this.types,{label:t});if(i.isUndefined(e))return console.warn(`No type found for ${t} in types:`,this.types);this.selectedType=e},onClickAddNewItem(){if(this.selectedType){const t=i.cloneDeep(this.selectedType);this.items.push(t),i.set(this.localModel,this.schema.model,this.items),this.$emit("input",this.items,this.schema.model)}},onClickRemoveItem(t){let e=i.get(this.model,"_attachments",[]);if(i.includes(["image","file","group"],t.input)){const s=r=>{const n=[];return i.each(r,(l,o)=>{if(o==="id")return n.push(l);(i.isPlainObject(l)||i.isArray(l))&&n.push(...s(l))}),n},a=s(t);console.warn("IDS = ",a),i.each(a,r=>{e=i.reject(e,{_fields:{fileItemId:r}})})}this.items=i.difference(this.items,[t]),i.set(this.localModel,this.schema.model,this.items),i.set(this.model,"_attachments",e),this.items=i.clone(this.items),this.key=B(),this.$emit("input",this.items,this.schema.model)},onChange(){i.set(this.localModel,this.schema.model,this.items),this.$emit("input",this.items,this.schema.model)},onEndDrag(){this.dragging=!1,i.set(this.localModel,this.schema.model,this.items),this.key=B(),this.$emit("input",this.items,this.schema.model)},onModelUpdated(t,e,s){i.includes(e,".")&&i.set(this.items,`[${s}].${e}`,t),i.set(this.localModel,this.schema.model,this.items),this.$emit("input",this.items,this.schema.model)}}};var Ui=function(){var e=this,s=e._self._c;return s("div",{staticClass:"paragraph-view"},[e.schema?s("draggable",e._b({key:`${e.schema.model}-${e.key}`,class:{disabled:e.disabled},attrs:{list:e.items,draggable:".item",handle:".handle",group:`${e.schema.model}-${e.key}`,"ghost-class":"ghost"},on:{end:e.onEndDrag,start:function(a){e.dragging=!0}}},"draggable",e.dragOptions,!1),[e._l(e.items,function(a,r){return s(R,{key:`paragraph-item-${r}`,class:`item nested-level-${e.paragraphLevel}`,attrs:{elevation:"0"}},[s(be,{staticClass:"handle paragraph-header"},[s("div",{staticClass:"paragraph-title"},[e._v(e._s(a.label))]),s("div",{staticClass:"add-btn-wrapper"},[s(y,{staticClass:"remove-item",attrs:{disabled:e.disabled||e.schema.disabled,text:"",icon:"",rounded:"",small:""},on:{click:function(n){return e.onClickRemoveItem(a)}}},[s(m,[e._v("mdi-trash-can-outline")])],1)],1)]),s("div",{staticClass:"item-main-wrapper"},[s("div",{staticClass:"item-main"},[s("custom-form",{attrs:{schema:e.getSchema(a),model:a,"paragraph-index":r,"paragraph-level":e.paragraphLevel+1},on:{error:e.onError,input:e.onModelUpdated}})],1)])],1)}),s("div",{staticClass:"paragraph-footer",attrs:{slot:"footer"},slot:"footer"},[s(nt,{ref:"input",attrs:{transition:"none",value:e.selectedType,"menu-props":{bottom:!0,offsetY:!0},items:e.types,"item-text":"label","item-value":"label","hide-details":"",filled:"",rounded:"",dense:"","persistent-placeholder":"",disabled:e.disabled||e.schema.disabled,"append-icon":"mdi-chevron-down"},on:{change:e.onChangeType},scopedSlots:e._u([{key:"prepend",fn:function(){return[e.schema.required?s("span",{staticClass:"red--text"},[s("strong",[e._v("* ")])]):e._e(),e._v(e._s(e.schema.label)+" ")]},proxy:!0},{key:"label",fn:function(){},proxy:!0}],null,!1,1758761004)}),s("div",{staticClass:"add-btn-wrapper"},[s(y,{staticClass:"add-new-item",attrs:{elevation:"0",rounded:"",disabled:e.disabled||e.schema.disabled},on:{click:e.onClickAddNewItem}},[s("span",[e._v(e._s(e._f("translate")("TL_ADD")))])])],1)],1)],2):e._e()],1)},Pi=[],Bi=p(Vi,Ui,Pi,!1,null,"dfdf7180",null,null);const qi=Bi.exports,ue={data(){return{dragover:!1,attachments:[],localModel:!1}},mounted(){this.localModel=i.cloneDeep(this.model),this.attachments=this.getAttachments()},methods:{onEndDrag({newIndex:t,oldIndex:e}){this.dragging=!1;const s=i.map(this.getAttachments(),(r,n)=>(r.order!==n+1&&(r.order=n+1,r.orderUpdated=!0),r));let a=i.map(this.localModel._attachments,r=>{if(!this.isSameAttachment(r))return r;const n=i.get(i.find(s,{orderUpdated:!0,_filename:r._filename,_size:r._size,url:r.url}),"order",0);return n!==0&&n!==i.get(r,"order",-1)&&(r.order=n,r.orderUpdated=!0),r});a=i.orderBy(a,["order"],["asc"]),this.attachments=i.filter(a,r=>this.isSameAttachment(r)),this.isForParagraph?this.value=this.items:this.$emit("input",a,this.schema.model)},getImageSrc(t=!1){const e=t||this.attachment();return e.data?e.data:this.getPreviewUrl(e)},isImage(t=!1){const e=t||this.attachment();return e&&/image/g.test(e._contentType||e.file&&e.file.type)},getPreviewUrl(t=!1){const e=t||this.attachment();return e._contentType.indexOf("svg")!==-1?e.url:`${e.url}?resize=autox100`},isSameAttachment(t){const{key:e,locale:s}=this.getKeyLocale();return t._name===e&&(t._fields&&t._fields.locale)===s},attachment(){return i.find(this.localModel._attachments,t=>this.isSameAttachment(t))},getAttachments(){return i.get(this.attachments,"length",0)!==0?this.attachments:i.filter(this.localModel._attachments,t=>this.isSameAttachment(t))},imageSize(t=!1){const e=t||this.attachment();return this.bytesToSize(i.get(e,"_size",i.get(e,"file.size",!1)))},bytesToSize(t){if(t===0)return"0 Byte";const e=["Bytes","KB","MB","GB","TB"],s=parseInt(Math.floor(Math.log(t)/Math.log(1024))),a=Math.round(t/Math.pow(1024,s),2);return i.isNaN(a)?"Unknown":`${a} ${e[s]}`},isForMultipleImages(){if(this.schema.width&&this.schema.height)return!1;const t=this.getMaxCount();return t===-1?!0:t>1},isFieldDisabled(){const t=this.getMaxCount();return t===-1?!1:this.getAttachments().length>=t?!0:this.disabled||i.get(this.schema,"disabled",!1)},getFieldType(){return i.toUpper(i.get(this.schema,"type","ImageView")==="ImageView"?"image":"file")},getRules(){const t=[];return this.schema.required&&t.push(e=>!!e||i.get(this.getAttachments(),"length",0)!==0||h.get(`TL_${this.getFieldType()}_IS_MANDATORY`)),this.isForMultipleImages()?(t.push(e=>{const s=this.getMaxCount();return s===-1||i.get(this.getAttachments(),"length",0)+i.get(e,"length",0)<=s+1?!0:h.get(`TL_TOO_MANY_${this.getFieldType()}S`)}),i.get(this.schema,"options.limit",!1)&&t.push(e=>!e||!e.some(s=>s.size>this.schema.limit)||h.get(`TL_${this.getFieldType()}_IS_TOO_BIG`))):i.get(this.schema,"options.limit",!1)&&t.push(e=>!e||e.size<=this.schema.limit||h.get(`TL_${this.getFieldType()}_IS_TOO_BIG`)),t},getPlaceholder(){return`TL_CLICK_OR_DRAG_AND_DROP_TO_ADD_${this.getFieldType()}${this.isForMultipleImages()?"S":""}`},getMaxCount(){return i.get(this.schema,"options.maxCount",-1)},getFileSizeLimit(t){const e=t/1024;return e>1e3?`${e/1e3} MB`:`${e} KB`},removeImage(t){this.$refs.input.internalValue=null,this.$refs.input.$refs.input.value=null,this.localModel._attachments=i.filter(this.localModel._attachments,s=>s!==t),this.attachments=i.filter(this.localModel._attachments,s=>this.isSameAttachment(s)),this.$forceUpdate(),this.$emit("input",this.localModel._attachments,this.schema.model);const e=this.schema.label;this.schema.label=null,this.schema.label=e},onDrop(t){this.dragover=!1;const e=this.getMaxCount();if(e!==-1&&e<=1&&t.dataTransfer.files.length>1)return console.error("Only one file can be uploaded at a time..");this.onUploadChanged(t.dataTransfer.files)},async onUploadChanged(t){if(this.$refs.input.validate(),!this.$refs.input.valid||(t=i.isNull(t)?[]:t,i.isArray(t)||(t=[t]),!t.length))return;const e=this.getMaxCount(),s=this.getAttachments().length+t.length;e>1&&s>e?(console.info(`Reached max number of files for ${this.schema.model}`,s,e),t=i.take(t,t.length-(s-e))):e===1&&s>1&&(this.isForParagraph||(this.localModel._attachments=i.filter(this.localModel._attachments,r=>!this.isSameAttachment(r))));const a=await this.readAllFiles(t);this.isForParagraph?this.value=this.items:(this.attachments=i.filter(a,r=>this.isSameAttachment(r)),this.$forceUpdate(),this.$emit("input",this.localModel._attachments,this.schema.model))},addAttachment(t,e){const{key:s,locale:a}=this.getKeyLocale(),r={_filename:i.get(t,"[0].name",t.name),_name:s,_fields:{locale:a},field:this.schema.model,localised:this.schema.localised,file:i.get(t,"[0]",t),data:e.target.result};if(this.isForParagraph){const n=B(),l={id:n};this.items.push(l),this.items=i.clone(this.items),r._fields.fileItemId=n}this.isForParagraph?this.schema.rootView.model._attachments.push(r):this.localModel._attachments.push(r)},async readAllFiles(t){let e=i.get(t,"length",1);return new Promise((s,a)=>{i.each(t,(r,n)=>{const l=new FileReader,o=this;l.onload=c=>{o.addAttachment(r,c),o.$forceUpdate(),e--,e===0&&(this.isForMultipleImages()&&i.each(o.localModel._attachments,(d,_)=>{d.order=_+1,d.orderUpdated=!0}),s(this.isForParagraph?o.items:o.localModel._attachments))};try{l.readAsDataURL(i.get(r,"[0]",r))}catch(c){console.error("Error while reading file:",c)}})})}}};const ji={components:{Cropper:lt},mixins:[S,ue,te],data(){return{firstCropUpdate:!0,stencilProps:{class:"cropper-stencil",previewClass:"cropper-stencil__preview",draggingClass:"cropper-stencil--dragging",handlersClasses:{default:"cropper-handler",eastNorth:"cropper-handler--east-north",westNorth:"cropper-handler--west-north",eastSouth:"cropper-handler--east-south",westSouth:"cropper-handler--west-south"}}}},methods:{getDefaultCropPosition({imageSize:t,visibleArea:e,coordinates:s}){const a=this.attachment();if(i.get(a,"cropOptions",!1))return{left:a.cropOptions.left,top:a.cropOptions.top};console.warn("no crop options");const r=e||t;return{left:(e?e.left:0)+r.width/2-s.width/2,top:(e?e.top:0)+r.height/2-s.height/2}},getDefaultCropSize(){return{width:i.get(this.schema,"options.width",500),height:i.get(this.schema,"options.height",500)}},onCropperChange(t){const e=this.attachment();i.each(this.localModel._attachments,s=>{s._id===e._id&&(s.cropOptions=t.coordinates,this.firstCropUpdate?this.firstCropUpdate=!1:s.cropOptions.updated=!0)}),this.$emit("input",this.localModel._attachments,this.schema.model)},imageUrl(){const t=this.attachment();return t&&(t.url||t.data)}}};var Hi=function(){var e=this,s=e._self._c;return s("div",{staticClass:"image-view",class:{"full-width":!(e.schema.width&&e.schema.height)}},[s("form",{attrs:{enctype:"multipart/form-data"}},[s("div",{staticClass:"field-label"},[e.schema.required?s("span",{staticClass:"red--text"},[s("strong",[e._v("* ")])]):e._e(),e._v(e._s(e.schema.label))]),e.schema.disabled?s(R,{staticClass:"file-input-card",class:{"drag-and-drop":e.dragover},attrs:{elevation:"0"},on:{drop:function(a){return a.preventDefault(),e.onDrop(a)},dragover:function(a){a.preventDefault(),e.dragover=!0},dragenter:function(a){a.preventDefault(),e.dragover=!0},dragleave:function(a){a.preventDefault(),e.dragover=!1}}},[s(j,{ref:"input",attrs:{rules:e.getRules(),"hide-details":"auto","prepend-icon":"",placeholder:e._f("translate")(e.getPlaceholder()),clearable:!1,dense:"",filled:"",rounded:"","persistent-placeholder":"","persistent-hint":"",multiple:e.isForMultipleImages(),accept:e.schema.accept,disabled:!0},on:{change:e.onUploadChanged},scopedSlots:e._u([{key:"selection",fn:function({index:a}){return[a===0?s("div",{staticClass:"v-file-input__text v-file-input__text--placeholder"},[e._v(" "+e._s(e._f("translate")(e.getPlaceholder()))+" ")]):e._e()]}}],null,!1,3100899402)})],1):s(R,{staticClass:"file-input-card",class:{"drag-and-drop":e.dragover},attrs:{elevation:"0"},on:{drop:function(a){return a.preventDefault(),e.onDrop(a)},dragover:function(a){a.preventDefault(),e.dragover=!0},dragenter:function(a){a.preventDefault(),e.dragover=!0},dragleave:function(a){a.preventDefault(),e.dragover=!1}}},[s(j,{ref:"input",attrs:{rules:e.getRules(),"hide-details":"auto","prepend-icon":"",placeholder:e._f("translate")(e.getPlaceholder()),clearable:!1,dense:"",filled:"",rounded:"","persistent-placeholder":"","persistent-hint":"",multiple:e.isForMultipleImages(),accept:e.schema.accept,disabled:e.isForMultipleImages()&&e.isFieldDisabled()},on:{change:e.onUploadChanged},scopedSlots:e._u([{key:"selection",fn:function({index:a}){return[a===0?s("div",{staticClass:"v-file-input__text v-file-input__text--placeholder"},[e._v(" "+e._s(e._f("translate")(e.getPlaceholder()))+" ")]):e._e()]}}])})],1)],1),e.isForMultipleImages()?s("div",{staticClass:"preview-multiple"},[e.schema?s("draggable",e._b({key:`${e.schema.model}`,class:{disabled:e.disabled},attrs:{list:e.getAttachments(),draggable:".preview-attachment",handle:".row-handle","ghost-class":"ghost"},on:{end:e.onEndDrag,start:e.onStartDrag}},"draggable",e.dragOptions,!1),e._l(e.getAttachments(),function(a,r){return s(R,{key:`${a._filename}-${r}`,staticClass:"preview-attachment",attrs:{elevation:"0"}},[s("div",{staticClass:"row-handle"},[s(H,{attrs:{cover:"",src:e.getImageSrc(a)}})],1),s(N,{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function({on:n}){return[s(V,e._g({staticClass:"filename",attrs:{outlined:"",close:"","close-icon":"mdi-close-circle-outline",disabled:e.disabled||e.schema.disabled},on:{"click:close":function(l){return e.removeImage(a)}}},n),[e._v("#"+e._s(r+1)+" - "+e._s(e._f("truncate")(a._filename,10))+" ("+e._s(e.imageSize(a))+")")])]}}],null,!0)},[s("span",[e._v(e._s(a._filename))])])],1)}),1):e._e()],1):e.attachment()&&e.isImage()?[e.schema.width&&e.schema.height?[s("cropper",{ref:"cropper",staticClass:"cropper",attrs:{src:e.imageUrl(),transitions:!0,"image-restriction":"fill-area","image-class":"cropper__image","default-boundaries":"fill","default-size":e.schema.options.width&&e.schema.options.height?e.getDefaultCropSize():!1,"default-position":e.getDefaultCropPosition,"min-width":e.schema.options.width,"max-width":e.schema.options.width,"min-height":e.schema.options.height,"max-height":e.schema.options.height,"move-image":!!e.schema.options.moveImage,"resize-image":!!e.schema.options.resizeImage,"stencil-props":e.stencilProps},on:{change:e.onCropperChange}})]:s("div",{staticClass:"preview-single-attachment"},[s(N,{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function({on:a}){return[s(V,e._g({staticClass:"filename",attrs:{close:""},on:{"click:close":function(r){e.removeImage(e.attachment())}}},a),[e._v(e._s(e._f("truncate")(e.attachment()._filename,10))+" ("+e._s(e.imageSize(e.attachment()))+")")])]}}],null,!1,2236971801)},[s("span",[e._v(e._s(e.attachment()._filename))])]),s(H,{staticClass:"preview",attrs:{cover:"",src:e.getImageSrc()}})],1)]:e._e(),e.model._local&&!e.disabled?[e.isForMultipleImages()?[s("div",{staticClass:"help-block"},[s(m,{attrs:{small:""}},[e._v("mdi-information")]),e.getMaxCount()!==-1?s("span",[e._v(e._s(e._f("translate")("TL_MAX_NUMBER_OF_IMAGES",null,{num:e.getMaxCount()})))]):s("span",[e._v(e._s(e._f("translate")("TL_UNLIMITED_NUMBER_OF_IMAGES")))])],1)]:e._e(),e.schema.width&&e.schema.height?s("div",{staticClass:"help-block"},[s(m,{attrs:{small:""}},[e._v("mdi-information")]),s("span",[e._v(e._s(e._f("translate")("TL_THIS_FIELD_REQUIRES_THE_FOLLOWING_SIZE"))+":"+e._s(e.schema.width)+"x"+e._s(e.schema.height))])],1):e._e(),e.schema.limit?s("div",{staticClass:"help-block"},[s(m,{attrs:{small:""}},[e._v("mdi-information")]),s("span",[e._v(e._s(e._f("translate")("TL_THIS_FIELD_REQUIRES_A_FILE_SIZE"))+": "+e._s(e.getFileSizeLimit(e.schema.limit)))])],1):e._e(),e.schema.accept?s("div",{staticClass:"help-block"},[s(m,{attrs:{small:""}},[e._v("mdi-information")]),s("span",[e._v(e._s(e._f("translate")("TL_THIS_FIELD_REQUIRES"))+": "+e._s(e.schema.accept))])],1):e._e()]:e._e()],2)},Gi=[],Ki=p(ji,Hi,Gi,!1,null,"a57fc11b",null,null);const zi=Ki.exports;const Yi={mixins:[S,ue,te]};var Wi=function(){var e=this,s=e._self._c;return s("div",{staticClass:"attachment-view"},[e.disabled?e._e():s("form",{attrs:{enctype:"multipart/form-data"}},[s("div",{staticClass:"field-label"},[e.schema.required?s("span",{staticClass:"red--text"},[s("strong",[e._v("* ")])]):e._e(),e._v(e._s(e.schema.label))]),s(R,{staticClass:"file-input-card",class:{"drag-and-drop":e.dragover},attrs:{elevation:"0"},on:{drop:function(a){return a.preventDefault(),e.onDrop(a)},dragover:function(a){a.preventDefault(),e.dragover=!0},dragenter:function(a){a.preventDefault(),e.dragover=!0},dragleave:function(a){a.preventDefault(),e.dragover=!1}}},[s(j,{ref:"input",attrs:{rules:e.getRules(),"prepend-icon":"",placeholder:e._f("translate")(e.getPlaceholder()),clearable:!1,"hide-details":"auto",dense:"",filled:"",rounded:"","persistent-placeholder":"","persistent-hint":"",multiple:e.isForMultipleImages(),accept:e.schema.accept,disabled:e.isForMultipleImages()&&e.isFieldDisabled()},on:{change:e.onUploadChanged},scopedSlots:e._u([{key:"selection",fn:function({index:a}){return[a===0?s("div",{staticClass:"v-file-input__text v-file-input__text--placeholder"},[e._v(" "+e._s(e._f("translate")(e.getPlaceholder()))+" ")]):e._e()]}}],null,!1,3100899402)})],1)],1),e.isForMultipleImages()?s("div",{staticClass:"preview-multiple"},[e.schema?s("draggable",e._b({key:`${e.schema.model}`,class:{disabled:e.disabled},attrs:{list:e.getAttachments(),draggable:".preview-attachment",handle:".row-handle","ghost-class":"ghost"},on:{end:e.onEndDrag,start:e.onStartDrag}},"draggable",e.dragOptions,!1),e._l(e.getAttachments(),function(a,r){return s(R,{key:`${a._filename}-${r}`,staticClass:"preview-attachment",class:{odd:r%2!==0},attrs:{elevation:"0"}},[s(N,{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function({on:n}){return[s(V,e._g({staticClass:"filename",attrs:{outlined:"",close:"","close-icon":"mdi-close-circle-outline"},on:{"click:close":function(l){return e.removeImage(a)}}},n),[e._v("#"+e._s(r+1)+" - "+e._s(e._f("truncate")(a._filename,10))+" ("+e._s(e.imageSize(a))+")")])]}}],null,!0)},[s("span",[e._v(e._s(a._filename))])]),s("div",{staticClass:"row-handle"},[e.isImage(a)?s("div",{staticClass:"image-wrapper"},[s(H,{attrs:{cover:"",src:e.getImageSrc(a)}})],1):s(y,{attrs:{small:"",rounded:"",elevation:"0"},on:{click:function(n){return e.viewFile(a)}}},[e._v(e._s(e._f("translate")("TL_VIEW")))])],1)],1)}),1):e._e()],1):e.attachment()?s("div",{staticClass:"preview-single-attachment"},[s(N,{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function({on:a}){return[s(V,e._g({staticClass:"filename",attrs:{close:""},on:{"click:close":function(r){e.removeImage(e.attachment())}}},a),[e._v(e._s(e._f("truncate")(e.attachment()._filename,10))+" ("+e._s(e.imageSize(e.attachment()))+")")])]}}])},[s("span",[e._v(e._s(e.attachment()._filename))])]),e.isImage()?s("div",{staticClass:"image-wrapper"},[s(H,{attrs:{cover:"",src:e.getImageSrc(e.a)}})],1):s(y,{attrs:{small:"",rounded:"",elevation:"0"},on:{click:function(a){return e.viewFile()}}},[e._v(e._s(e._f("translate")("TL_VIEW")))])],1):e._e(),e.model._local&&!e.disabled?[e.isForMultipleImages()?[s("div",{staticClass:"help-block"},[s(m,{attrs:{small:""}},[e._v("mdi-information")]),e.getMaxCount()!==-1?s("span",[e._v(e._s(e._f("translate")("TL_MAX_NUMBER_OF_FILES",null,{num:e.getMaxCount()})))]):s("span",[e._v(e._s(e._f("translate")("TL_UNLIMITED_NUMBER_OF_FILES")))])],1)]:e._e(),e.schema.width&&e.schema.height?s("div",{staticClass:"help-block"},[s(m,{attrs:{small:""}},[e._v("mdi-information")]),s("span",[e._v(e._s(e._f("translate")("TL_THIS_FIELD_REQUIRES_THE_FOLLOWING_SIZE"))+":"+e._s(e.schema.width)+"x"+e._s(e.schema.height))])],1):e._e(),e.schema.limit?s("div",{staticClass:"help-block"},[s(m,{attrs:{small:""}},[e._v("mdi-information")]),s("span",[e._v(e._s(e._f("translate")("TL_THIS_FIELD_REQUIRES_A_FILE_SIZE"))+": "+e._s(e.getFileSizeLimit(e.schema.limit)))])],1):e._e(),e.schema.accept?s("div",{staticClass:"help-block"},[s(m,{attrs:{small:""}},[e._v("mdi-information")]),s("span",[e._v(e._s(e._f("translate")("TL_THIS_FIELD_REQUIRES"))+": "+e._s(e.schema.accept))])],1):e._e()]:e._e()],2)},Xi=[],Qi=p(Yi,Wi,Xi,!1,null,"16848f0e",null,null);const Ji=Qi.exports;const Zi={mixins:[S,ue,te],data(){return{dragover:!1,isForParagraph:!0,items:i.get(this.model,this.schema.model,[]),key:B(),attachments:[]}},watch:{"schema.model":function(){this.items=i.get(this.model,this.schema.model,[]),this.attachments=this.formatItems()}},mounted(){this.attachments=this.formatItems()},methods:{formatItems(){return i.map(this.items,t=>this.getAttachment(t))},getAttachment(t,e){const s=i.find(this.schema.rootView.model._attachments,{_fields:{fileItemId:t.id}});return e?i.get(s,e):s},onClickRemoveFileItem(t){let e=this.schema.rootView.model._attachments=this.schema.rootView.model._attachments||[];e=i.reject(e,{_fields:{fileItemId:t.id}}),this.items=i.difference(this.items,[t]),i.set(this.schema.rootView.model,"_attachments",e),i.set(this.model,this.schema.model,this.items),this.$emit("input",this.model,this.schema.model)}}};var ea=function(){var e=this,s=e._self._c;return s("div",{staticClass:"paragraph-attachment-view"},[s(R,{class:{"drag-and-drop":e.dragover},attrs:{elevation:"0"},on:{drop:function(a){return a.preventDefault(),e.onDrop(a)},dragover:function(a){a.preventDefault(),e.dragover=!0},dragenter:function(a){a.preventDefault(),e.dragover=!0},dragleave:function(a){a.preventDefault(),e.dragover=!1}}},[s(j,{ref:"input",attrs:{rules:e.getRules(),"prepend-icon":"",accept:e.model.input==="image"?"image/*":"*",clearable:!1,placeholder:e._f("translate")(e.getPlaceholder()),dense:"",filled:"",rounded:"","persistent-placeholder":"","persistent-hint":"",multiple:e.isForMultipleImages(),disabled:e.isForMultipleImages()&&e.isFieldDisabled()},on:{change:e.onUploadChanged},scopedSlots:e._u([{key:"selection",fn:function({index:a}){return[a===0?s("div",{staticClass:"v-file-input__text v-file-input__text--placeholder"},[e._v(" "+e._s(e._f("translate")(e.getPlaceholder()))+" ")]):e._e()]}}])})],1),e.schema?s("draggable",e._b({key:`${e.schema.model}-${e.key}`,staticClass:"preview-multiple",class:{disabled:e.disabled},attrs:{group:`${e.schema.model}-${e.key}`,draggable:".preview-attachment",handle:".row-handle","ghost-class":"ghost"},on:{end:e.onEndDrag,start:e.onStartDrag},model:{value:e.items,callback:function(a){e.items=a},expression:"items"}},"draggable",e.dragOptions,!1),e._l(e.items,function(a,r){return s(R,{key:`${a._filename}-${r}`,staticClass:"preview-attachment",class:{odd:r%2!==0},attrs:{elevation:"0"}},[s("div",{staticClass:"row-handle"},[s(N,{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function({on:n}){return[s(V,e._g({staticClass:"filename",attrs:{close:""},on:{"click:close":function(l){return e.onClickRemoveFileItem(a)}}},n),[e._v("#"+e._s(r+1)+" - "+e._s(e._f("truncate")(e.getAttachment(a,"_filename"),10))+" ("+e._s(e.imageSize(e.getAttachment(a)))+")")])]}}],null,!0)},[s("span",[e._v(e._s(e.getAttachment(a,"_filename")))])]),e.isImage(e.getAttachment(a))?s("div",{staticClass:"image-wrapper"},[s(H,{attrs:{cover:"",src:e.getImageSrc(e.getAttachment(a))}})],1):e.getAttachment(a,"url")?s(y,{attrs:{small:"",rounded:"",elevation:"0"},on:{click:function(n){e.viewFile(e.getAttachment(a))}}},[e._v(e._s(e._f("translate")("TL_VIEW")))]):e._e()],1)])}),1):e._e()],1)},ta=[],sa=p(Zi,ea,ta,!1,null,"53b9c0e4",null,null);const ia=sa.exports;const aa={props:["format","name","width","value"],data(){return{hideCal:!0,activePort:null,timeStamp:null,months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Su","Mo","Tu","We","Th","Fr","Sa"],monthIndex:0,hourIndex:0,minuteIndex:0,year:2017,portsHolder:[],minute:0,hour:1,day:1,minuteSelectorVisible:!1,hourSelectorVisible:!1,period:"AM"}},computed:{ports:{get(){let t=[];if(this.portsHolder.length===0)for(let e=0;e<42;e++)t.push("");else t=this.portsHolder;return t},set(t){this.portsHolder=t}},month(){return this.months[this.monthIndex]},dateTime(){return`${this.timeStamp.getFullYear()}-${this.timeStamp.getMonth()+1}-${this.timeStamp.getUTCDay()}`},minutes(){const t=[];for(let e=0;e<60;e++)e<10?t.push(`0${e}`):t.push(`${e}`);return t},hours(){const t=[];for(let e=1;e<=12;e++)e<10?t.push(`0${e}`):t.push(`${e}`);return t},dateFormat(){return this.format||"YYYY-MM-DD hh:mm:ss a"},hideTime(){return this.dateFormat.indexOf("hh:mm:ss")===-1},hideDate(){return this.dateFormat==="hh:mm:ss a"}},created(){let t=new Date;this.value&&(t=new Date(this.value),this.timeStamp=t),this.year=t.getFullYear(),this.monthIndex=t.getMonth(),this.day=t.getDate(),this.period=t.getHours()>=12?"PM":"AM",this.hour=t.getHours(),this.hour===0?this.hour+=12:this.hour>12&&(this.hour-=12),this.minute=t.getMinutes()||0,this.updateCalendar(),document.addEventListener("keydown",this.keyIsDown),document.addEventListener("click",this.documentClicked),this.setDate()},destroyed(){document.removeEventListener("keydown",this.keyIsDown),document.removeEventListener("click",this.documentClicked)},methods:{padZero(t){return i.padStart(t,2,"0")},display(){return this.timeStamp?M(this.timeStamp).format(this.dateFormat):""},leftMonth(){const t=this.months.indexOf(this.month);t===0?this.monthIndex=11:this.monthIndex=t-1,this.updateCalendar()},rightMonth(){const t=this.months.indexOf(this.month);t===11?this.monthIndex=0:this.monthIndex=t+1,this.updateCalendar()},rightYear(){this.year++,this.updateCalendar()},leftYear(){this.year--,this.updateCalendar()},updateCalendar(){const t=this,s=new Date(t.year,t.monthIndex,1,0,0,0).getDay(),a=new Date(t.year,t.monthIndex+1,0).getDate(),r=[];let n=35;(s===6||s===5&&a===31)&&(n=42);let l=!1;for(let o=0;o<n;o++){const c=o-s,d=c<0||c>=a?"":c+1;r.push(d),this.timeStamp&&d===t.day&&this.timeStamp.getMonth()===t.monthIndex&&this.timeStamp.getFullYear()===t.year&&(t.activePort=o,l=!0)}l||(t.activePort=-1),this.ports=r},setDay(t,e){e!==""&&(this.activePort=t,this.day=e,this.timeStamp=new Date(this.year,this.monthIndex,this.day),this.setDate(!0))},setMinute(t,e){this.minuteIndex=t,this.minute=t,e&&(this.minuteSelectorVisible=!1)},setHour(t,e){this.hourIndex=t,this.hour=t+1,e&&(this.hourSelectorVisible=!1)},showHourSelector(){this.hourSelectorVisible=!0,this.minuteSelectorVisible=!1},showMinuteSelector(){this.minuteSelectorVisible=!0,this.hourSelectorVisible=!1},keyIsDown(t){const e=t.which||t.keycode;e===38?this.minuteSelectorVisible&&this.minuteIndex>0?(this.setMinute(this.minuteIndex-1,!1),this.scrollTopMinute()):this.hourSelectorVisible&&this.hourIndex>0&&(this.setHour(this.hourIndex-1,!1),this.scrollTopHour()):e===40?this.minuteSelectorVisible&&this.minuteIndex<this.minutes.length-1?(this.setMinute(this.minuteIndex+1,!1),this.scrollTopMinute()):this.hourSelectorVisible&&this.hourIndex<this.hours.length-1&&(this.setHour(this.hourIndex+1,!1),this.scrollTopHour()):e===13&&(this.minuteSelectorVisible=!1,this.hourSelectorVisible=!1),(this.minuteSelectorVisible||this.hourSelectorVisible)&&(t.preventDefault(),this.minuteSelectorVisible=!1,this.hourSelectorVisible=!1)},scrollTopMinute(){const t=this.$refs.minuteScroller.scrollHeight,e=this.$refs.minuteScrollerWrapper.clientHeight,s=t*(this.minuteIndex/(this.minutes.length-1))-e/2;this.$refs.minuteScroller.scrollTop=s},scrollTopHour(){const t=this.$refs.hourScroller.scrollHeight,e=this.$refs.hourScrollerWrapper.clientHeight,s=t*(this.hourIndex/(this.hours.length-1))-e/2;this.$refs.hourScroller.scrollTop=s},changePeriod(){this.period=this.period==="AM"?"PM":"AM"},calendarClicked(t){t.target.id!=="j-hour"&&t.target.id!=="j-minute"&&(this.minuteSelectorVisible=!1,this.hourSelectorVisible=!1),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()},documentClicked(t){t.target.id!=="tj-datetime-input"&&(this.hideCal=!0)},toggleCal(){this.hideCal=!this.hideCal},clearDate(){this.timeStamp="",this.$emit("input",""),this.hideCal=!0},setDate(t){let e=this.hour;this.hour===12&&this.period==="AM"&&(e=e-12),this.hour!==12&&this.period==="PM"&&(e=e+12);const s=new Date(this.year||1970,this.monthIndex||0,this.day||1,e,this.minute,0);t&&(this.timeStamp=s,this.$emit("input",s.getTime()),this.hideCal=!0)}}};var ra=function(){var e=this,s=e._self._c;return s("div",{staticClass:"datetime-picker",style:{width:e.width},on:{click:function(a){return e.calendarClicked(a)}}},[s("div",[s("input",{ref:"input",attrs:{id:"tj-datetime-input",readonly:"",type:"text",name:e.name,autocomplete:"off"},domProps:{value:e.display()},on:{click:e.toggleCal}}),s("div",{staticClass:"calender-div",class:{noDisplay:e.hideCal}},[s("div",{class:{noDisplay:e.hideDate}},[s("div",{staticClass:"year-month-wrapper"},[s("div",{staticClass:"month-setter"},[s("span",{staticClass:"nav-l",attrs:{type:"button"},on:{click:e.leftYear}},[s(m,[e._v("mdi-chevron-left")])],1),s("span",{staticClass:"year"},[e._v(e._s(e.year))]),s("span",{staticClass:"nav-r",attrs:{type:"button"},on:{click:e.rightYear}},[s(m,[e._v("mdi-chevron-right")])],1)]),s("div",{staticClass:"month-setter"},[s("span",{staticClass:"nav-l",attrs:{type:"button"},on:{click:e.leftMonth}},[s(m,[e._v("mdi-chevron-left")])],1),s("span",{staticClass:"month"},[e._v(e._s(e._f("translate")("TL_"+e.month.toUpperCase())))]),s("span",{staticClass:"nav-r",attrs:{type:"button"},on:{click:e.rightMonth,mousedown:function(a){a.stopPropagation(),a.preventDefault()}}},[s(m,[e._v("mdi-chevron-right")])],1)])]),s("div",{staticClass:"headers"},[e._l(e.days,function(a,r){return[s("span",{key:r,staticClass:"days"},[e._v(e._s(e._f("translate")("TL_"+a.toUpperCase())))])]})],2),s("div",[e._l(e.ports,function(a,r){return[s("span",{key:r,staticClass:"port",class:{activePort:r===e.activePort},on:{click:function(n){return e.setDay(r,a)}}},[e._v(e._s(a))])]})],2)]),s("div",{staticClass:"time-picker",class:{noDisplay:e.hideTime}},[s("div",{staticClass:"hour-selector"},[s("div",{attrs:{id:"j-hour"},on:{click:e.showHourSelector}},[e._v(e._s(e.padZero(e.hour)))]),s("div",{ref:"hourScrollerWrapper",staticClass:"scroll-hider",class:{showSelector:e.hourSelectorVisible}},[s("ul",{ref:"hourScroller"},[e._l(e.hours,function(a,r){return[s("li",{key:r,class:{active:r==e.hourIndex},on:{click:function(n){return e.setHour(r,!0)}}},[e._v(e._s(a))])]})],2)])]),e._m(0),s("div",{staticClass:"minute-selector"},[s("div",{attrs:{id:"j-minute"},on:{click:e.showMinuteSelector}},[e._v(e._s(e.padZero(e.minute)))]),s("div",{ref:"minuteScrollerWrapper",staticClass:"scroll-hider",class:{showSelector:e.minuteSelectorVisible}},[s("ul",{ref:"minuteScroller"},[e._l(e.minutes,function(a,r){return[s("li",{key:r,class:{active:r==e.minuteIndex},on:{click:function(n){return e.setMinute(r,!0)}}},[e._v(e._s(a))])]})],2)])]),e._m(1),s("div",{staticClass:"minute-selector"},[s("div",{on:{click:e.changePeriod}},[e._v(e._s(e._f("translate")("TL_"+e.period.toUpperCase())))])])]),s("span",{staticClass:"okButton",attrs:{type:"button"},on:{click:function(a){return e.setDate(!0)}}},[e._v(e._s(e._f("translate")("TL_OK")))]),s("span",{staticClass:"okButton",attrs:{type:"button"},on:{click:function(a){return e.clearDate()}}},[e._v(e._s(e._f("translate")("TL_CLEAR")))])])])])},na=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"time-separator"},[e("span",[t._v(":")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"time-separator"},[e("span",[t._v(":")])])}],la=p(aa,ra,na,!1,null,"159df4fd",null,null);const oa=la.exports,ca={components:{datetime:oa},mixins:[S],props:["options","customDatetimePickerOptions"],data(){return{}},created(){this.schema.format=this.schema.format||"DD/MM/YYYY h:i:s"},methods:{onChangeData(t){i.set(this.model,this.schema.model,t),this.$emit("model-updated",t,this.schema.model);const e=this.schema.label;this.schema.label=null,this.schema.label=e},get:i.get}};var da=function(){var e=this,s=e._self._c;return s("div",[s("datetime",{ref:"input",attrs:{format:e.schema.format,value:e.get(e.model,e.schema.model)},on:{input:e.onChangeData}})],1)},ua=[],ha=p(ca,da,ua,!1,null,null,null,null);const ma=ha.exports;const pa={mixins:[S],data(){return{objectValue:this.value}},computed:{selectOptions(){return this.schema.selectOptions||{}},options(){let t=this.schema.values;return typeof t=="function"?t.apply(this,[this.model,this.schema]):t},formattedOptions(){const t=this.selectOptions.label||this.options;if(i.isString(i.first(t)))return t;const e=this.customLabel;return i.isFunction(this.customLabel)?i.map(t,s=>{const a=e(s);return i.isString(a)&&(s.text=a),i.isUndefined(i.get(s,"value",void 0))&&(s.value=i.get(s,"_id",void 0)),s}):t},hasCustomLabel(){const t=i.get(this.schema,"selectOptions");return typeof t<"u"&&typeof t.customLabel<"u"&&typeof t.customLabel=="function"},customLabel(){return i.isString(i.first(this.options))?this.options:this.hasCustomLabel?this.schema.selectOptions.customLabel:"text"}},methods:{allOptionsSelected(){return i.get(this.formattedOptions,"length",0)===i.get(this.objectValue,"length",0)},onChangeSelectAll(t){const e=this.allOptionsSelected();this.objectValue=e?[]:i.map(this.formattedOptions,"value"),this.value=this.objectValue,this.$emit("input",this.value,this.schema.model)},getLabel(){return this.disabled?"":i.isString(this.selectOptions.label)?this.selectOptions.label:this.schema.label},updateSelected(t){this.objectValue=t;const e=i.get(this.schema,"selectOptions.key");e?i.isString(this.objectValue)?this.value=this.objectValue:this.value=i.get(this.objectValue,e):this.value=this.objectValue,this.$emit("input",t,this.schema.model)},addTag(t,e){const s=this.selectOptions.onNewTag;typeof s=="function"&&s(t,e,this.options,this.objectValue)},onSearchChange(t,e){const s=this.selectOptions.onSearch;typeof s=="function"&&s(t,e,this.options)}}};var fa=function(){var e=this,s=e._self._c;return s("div",{staticClass:"multiselect-wrapper"},[s(ot,{ref:"input",attrs:{id:e.selectOptions.id,chips:e.selectOptions.chips,value:e.objectValue,items:e.formattedOptions,"deletable-chips":e.selectOptions.deletableChips||e.selectOptions.multiple,"hide-selected":e.selectOptions.hideSelected,disabled:e.disabled||e.schema.disabled,placeholder:e.schema.placeholder,multiple:e.selectOptions.multiple,ripple:!1,clearable:e.selectOptions.clearable,"small-chips":e.selectOptions.multiple,filled:"",dense:"",rounded:"","hide-details":"","append-icon":"mdi-chevron-down"},on:{change:e.updateSelected,"search-change":e.onSearchChange,tag:e.addTag},scopedSlots:e._u([{key:"prepend",fn:function(){return[e.schema.required?s("span",{staticClass:"red--text"},[s("strong",[e._v("* ")])]):e._e(),e._v(e._s(e.getLabel())+" "),e.schema.listBox?s(y,{attrs:{small:"",rounded:"",elevation:"0"},on:{click:e.onChangeSelectAll}},[e._v(e._s(e._f("translate")(e.allOptionsSelected()?"TL_DESELECT_ALL":"TL_SELECT_ALL")))]):e._e()]},proxy:!0},{key:"label",fn:function(){},proxy:!0},{key:"item",fn:function({item:a,attrs:r}){return[e.selectOptions.multiple?s("div",{staticClass:"checkbox"},[s(m,{class:{displayed:r.inputValue},attrs:{small:""}},[e._v("mdi-check-bold")])],1):e._e(),s("div",{staticClass:"label",class:{selected:r.inputValue}},[e._v(e._s(a.text?a.text:a))])]}}])})],1)},ga=[],_a=p(pa,fa,ga,!1,null,null,null,null);const va=_a.exports,ya={mixins:[S],data(){return{}},methods:{onChangeData(t){this.value=t},get(t){return i.get(this.schema,t,!1)},getType(){return i.get(this.schema,"inputFieldType","text")},validateField(t){return this.schema.required&&(i.isNull(t)||i.isUndefined(t)||t==="")?!1:this.schema.validator&&i.isFunction(this.schema.validator)?!!this.schema.validator(t,this.schema.model,this.model):!0}}};var ba=function(){var e=this,s=e._self._c;return s(Q,{ref:"input",class:[e.schema.labelClasses],attrs:{type:e.getType(),value:e.value,"input-value":e.value,"max-length":e.schema.max,"min-length":e.schema.min,autocomplete:"off","validate-on-submit":"",rules:[e.validateField],filled:e.get("filled"),rounded:e.get("rounded"),dense:e.get("dense"),compact:e.get("compact"),disabled:e.disabled,readonly:e.get("readonly"),outlined:e.get("outlined"),"persistent-placeholder":"","hide-details":""},on:{input:e.onChangeData},scopedSlots:e._u([{key:"prepend",fn:function(){return[e.schema.required?s("span",{staticClass:"red--text"},[s("strong",[e._v("* ")])]):e._e(),e._v(e._s(e.schema.label)+" ")]},proxy:!0},{key:"label",fn:function(){},proxy:!0}])})},Ca=[],wa=p(ya,ba,Ca,!1,null,null,null,null);const $a=wa.exports;const Sa={mixins:[S],data(){return{}},methods:{onChangeData(t){this.value=t},getType(){return i.get(this.schema,"inputFieldType","text")}}};var La=function(){var e=this,s=e._self._c;return s("div",{staticClass:"custom-textarea"},[s(ct,{ref:"input",class:[e.schema.labelClasses],attrs:{"multi-line":"",type:e.getType(),value:e.value,"max-length":e.schema.max,"min-length":e.schema.min,dense:!!e.schema.dense,compact:!!e.schema.compact,disabled:!!e.schema.disabled,readonly:!!e.schema.readonly,filled:!!e.schema.filled,"hide-details":"",outlined:!!e.schema.outlined,solo:!!e.schema.solo},on:{input:e.onChangeData},scopedSlots:e._u([{key:"prepend",fn:function(){return[e.schema.required?s("span",{staticClass:"red--text"},[s("strong",[e._v("* ")])]):e._e(),e._v(e._s(e.schema.label)+" ")]},proxy:!0},{key:"label",fn:function(){},proxy:!0}])})],1)},Ra=[],xa=p(Sa,La,Ra,!1,null,null,null,null);const Ta=xa.exports;const Ia={mixins:[S],methods:{getValue(){const t=i.get(this.model,this.schema.model,!1);return i.isNull(t)?!1:t},onChange(){this.value=!this.getValue(),this.$emit("input",this.value,this.schema.model)}}};var ka=function(){var e=this,s=e._self._c;return s("div",{staticClass:"custom-checkbox"},[s("div",{staticClass:"field-label"},[e._v(e._s(e.schema.label))]),s("div",{ref:"input",staticClass:"switch",class:{active:e.getValue()},on:{click:e.onChange}},[s("div",{staticClass:"drag"}),s("div",{staticClass:"labels"},[s("span",{staticClass:"label inactive"},[e._v(e._s(e._f("translate")("TL_NO")))]),s("span",{staticClass:"label active"},[e._v(e._s(e._f("translate")("TL_YES")))])])])])},Ea=[],Da=p(Ia,ka,Ea,!1,null,"54b578bc",null,null);const Oa=Da.exports,Ma={mixins:[S],props:["locale"],data(){return{tags:[],options:{allowDuplicates:this.getOpt("allowDuplicates",!0),readOnly:this.getOpt("disabled",!1),placeholder:this.getOpt("placeholder",""),multiple:this.getOpt("multiple",!1)}}},watch:{tags(){i.set(this.model,this.schema.model,this.tags)},"schema.model":function(){this.tags=i.get(this.model,this.schema.model)}},created(){this.options=i.extend(this.options,this.schema.selectOptions)},mounted(){this.tags=i.get(this.model,this.schema.model)},methods:{get(t){return i.get(this.schema,t,!1)},validateField(t){return this.schema.required&&(i.isNull(t)||i.isUndefined(t)||i.isEmpty(t))||this.schema.selectOptions.min&&i.get(t,"length",0)<this.schema.selectOptions.min||this.schema.selectOptions.max&&i.get(t,"length",0)>this.schema.selectOptions.max?!1:this.schema.validator&&i.isFunction(this.schema.validator)?!!this.schema.validator(t,this.schema.model,this.model):!0},onChangeData(t){i.get(this.options,"limit",-1)!==-1?this.value=i.take(t,this.options.limit):this.value=t}}};var Fa=function(){var e=this,s=e._self._c;return s(dt,{ref:"input",attrs:{clearable:"","hide-details":"","deletable-chips":"","small-chips":"",dense:"",filled:"",rounded:"","validate-on-submit":"",rules:[e.validateField],"hide-selected":!e.options.allowDuplicates,readonly:e.options.readOnly,placeholder:e.options.tagPlaceholder,multiple:e.options.multiple},on:{change:e.onChangeData},scopedSlots:e._u([{key:"prepend",fn:function(){return[e.schema.required?s("span",{staticClass:"red--text"},[s("strong",[e._v("* ")])]):e._e(),e._v(e._s(e.schema.label)+" ")]},proxy:!0},{key:"label",fn:function(){},proxy:!0}]),model:{value:e.tags,callback:function(a){e.tags=a},expression:"tags"}})},Aa=[],Na=p(Ma,Fa,Aa,!1,null,null,null,null);const Va=Na.exports;const Ua={mixins:[S],props:["groupOptions","paragraphLevel"],data(){return{errors:null}},methods:{onError(t){console.log(999,"error",t)},validate(){const t=this.$refs.input.validate();if(!t)throw this.errors=this.$refs.input.errors,new Error("group validation error");return t},debouncedValidate(){return this.$refs.input.debouncedValidate()},clearValidationErrors(){return this.$refs.input.clearValidationErrors()},onModelUpdated(t,e){this.$emit("input",t,e)}}};var Pa=function(){var e=this,s=e._self._c;return s("div",{class:`group nested-level-${e.paragraphLevel}`},[s("div",{staticClass:"header"},[s("div",{staticClass:"field-label"},[e._v(e._s(e.schema.label))])]),s("div",{staticClass:"group-content"},[s("custom-form",{ref:"input",attrs:{schema:e.schema.groupOptions,"paragraph-level":e.paragraphLevel+1,model:e.model},on:{"update:model":function(a){e.model=a},error:e.onError,input:e.onModelUpdated}})],1)])},Ba=[],qa=p(Ua,Pa,Ba,!1,null,"443c84f7",null,null);const ja=qa.exports;const Ha={props:["row","column","rowIndex","field"],methods:{getSrc(){const t=i.get(this.findAttachmentForField(this.row,this.field),"url",!1);return t?t+"?resize=autox50":!1},findAttachmentForField(t,e){return i.find(i.get(t,"_attachments",[]),s=>e.localised?i.get(s,"_fields.locale",!1)===e.locale&&s._name===e.originalModel:s._name===e.originalModel)}}};var Ga=function(){var e=this,s=e._self._c;return e.getSrc()?s("img",{staticClass:"vue-table-generator-field image",attrs:{src:e.getSrc()}}):s("span",[e._v(e._s(e._f("translate")("TL_NO_IMAGE")))])},Ka=[],za=p(Ha,Ga,Ka,!1,null,"7d14c05c",null,null);const Ya=za.exports,Wa={props:["row","column","rowIndex","field"],methods:{getValue(){return i.get(this.row,this.column.field,!1)}}};var Xa=function(){var e=this,s=e._self._c;return s("div",{staticClass:"checkbox"},[s(m,{class:{displayed:e.getValue()},attrs:{small:""}},[e._v("mdi-check-bold")])],1)},Qa=[],Ja=p(Wa,Xa,Qa,!1,null,"cc36c5f9",null,null);const Za=Ja.exports;const er={props:["row","column","rowIndex","edit","remove"]};var tr=function(){var e=this,s=e._self._c;return s("div",{staticClass:"vue-table-generator-field table-column-actions"},[s(y,{attrs:{small:"",icon:""},on:{click:function(a){return e.edit(e.row)}}},[s(m,[e._v("mdi-note-edit-outline")])],1),s(y,{staticClass:"delete-btn",attrs:{small:"",icon:""},on:{click:function(a){return e.remove(e.row)}}},[s(m,[e._v("mdi-trash-can-outline")])],1)],1)},sr=[],ir=p(er,tr,sr,!1,null,"0a1f7af4",null,null);const ar=ir.exports,rr={install(t,e={}){this.installed||(this.installed=!0,this.params=e,t.prototype.$loading=de)}};function nr(t,e,s){return h.get(t,e,s)}function lr(t,e){return i.isString(e)?(i.includes(e,"n")&&console.warn("Truncate - should truncate the text by number of items"),i.truncate(t,{length:i.toNumber(e)})):i.truncate(t,{length:e})}window.Vue=f;f.component("CustomForm",Hs);f.component("AttachmentView",Ji);f.component("ImageView",zi);f.component("CustomInput",$a);f.component("CustomTextarea",Ta);f.component("CustomCheckbox",Oa);f.component("ParagraphAttachmentView",ia);f.component("ParagraphView",qi);f.component("CustomTreeView",gi);f.component("CustomCode",Ci);f.component("ColorPicker",Ri);f.component("JsonEditor",Ei);f.component("WysiwygField",Ai);f.component("CustomDatetimePicker",ma);f.component("Group",ja);f.component("CustomInputTag",Va);f.component("CustomMultiSelect",va);f.component("PluginPage",Ws);f.component("Syslog",ei);f.component("CmsImport",ri);f.component("SyncResource",di);f.component("Draggable",ut);f.component("TableImageView",Ya);f.component("TableCustomCheckbox",Za);f.component("TableRowActions",ar);f.mixin({filters:{translate:nr,truncate:lr}});f.use(rr);f.use(ht);f.use(mt);f.use(pt);f.use(Se);f.use(ft);f.use(gt,{name:"timeago",locale:"enUS",locales:{enUS:_t,zhCN:vt}});function ne(t,e,s="System",a=["admins","imagination"]){window.plugins=window.plugins||[],window.plugins.push({title:t,displayname:e,component:t,group:s,allowed:a,type:"plugin"})}let ke=document.createElement("script");ke.setAttribute("src","./plugins/scripts/bundle.js");document.head.appendChild(ke);window.addEventListener("load",async function(){i.each(window.plugins,a=>{a.type="plugin"}),window.TranslateService=h;const e=(await C.get(`${window.location.pathname}config`)).data;ne("Syslog","Syslog"),e.import&&ne("CmsImport","Cms Import"),e.sync&&!e.sync.disablePlugin&&ne("SyncResource","Sync Resource"),window.disableJwtLogin=i.get(e,"disableJwtLogin",!1),window.noLogin=window.disableJwtLogin&&i.get(e,"disableAuthentication",!1);const s=new Se({});new f({el:"#app",vuetify:Le,router:s,render:function(a){return a(this.$el.getAttribute("type")==="login"?Us:Ms)}})});
