import{V as ue,a as m,i as Se,_ as a,E as he,b,c as $,d as Le,e as D,r as Te,f as me,g as v,h as f,j as pe,k as G,l as Re,m as Ee,n as Ie,o as xe,p as ke,q as ne,s as J,t as fe,u as De,v as ge,w as se,x as Oe,y as Me,z as Fe,A as le,B,C as _e,D as Ae,F as Ne,G as Ve,H as N,I as z,J as u,K as Ue,L as Pe,M as Y,N as Be,O as qe,P as je,Q as He,R as ze,S as Ke,T as Ge,U as Ye,W as We,$ as Qe,X as Xe,Y as Ze,Z as Je,a0 as et,a1 as tt,a2 as st,a3 as P,a4 as O,a5 as it,a6 as at,a7 as rt,a8 as W,a9 as nt,aa as lt,ab as ot,ac as ct,ad as dt,ae as ut,af as ht,ag as ve,ah as mt,ai as pt,aj as ft,ak as gt}from"./vendor-3bc02d2e.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();const ye=new ue({theme:{themes:{light:{primary:"#00095B","node-cms-black":"#00142E","node-cms-blue":"#00095B","node-cms-grabber":"#1700F4","node-cms-twilight":"#00142E","node-cms-grey":"#AFAFAF","node-cms-light-grey":"#DBDBDB","node-cms-light-white-grey":"#EDEDED","node-cms-off-white":"#F6F6F6","node-cms-red":"#C90000"},dark:{primary:"#00142E","node-cms-black":"#00142E","node-cms-blue":"00142E","node-cms-grabber":"00142E","node-cms-twilight":"00142E","node-cms-grey":"00142E","node-cms-light-grey":"00142E","node-cms-light-white-grey":"00142E","node-cms-off-white":"00142E","node-cms-red":"00142E"}}},icons:{iconfont:"mdi"}});m.use(ue);m.use(Se,{vuetify:ye,iconsGroup:"mdi"});class _t{constructor(){this.isShow=!1,this.list=[]}start(e){this.isShow=!0,this.list=a.union(this.list,[e])}stop(e){this.list=a.difference(this.list,[e]),a.isEmpty(this.list)&&(this.isShow=!1)}}const ie=new _t;class vt{constructor(){this.events=new he}send(e,t="success"){this.events.emit("notification",{message:e,type:t})}}const ee=new vt;class yt{constructor(){this.user=null,this.logoutCallbackList=[]}init(){console.info("LoginService - init"),setInterval(async()=>{this.checkStatus()},1e3*15)}async getStatus(){try{const{data:e}=await b.get(`${window.location.pathname}login`);return this.user=e,e}catch{return null}}async checkStatus(){let e;const t=a.cloneDeep(this.user);try{e=await this.getStatus()}catch{}a.isEmpty(e)&&!a.isEmpty(t)&&(console.info("will logout"),await this.logout())}async changeTheme(e){try{const t=a.get(this.user,"theme","dark")==="dark"?"light":"dark";console.warn("changeTheme ",this.user,t),await b.get(`${window.location.pathname}changeTheme/${t}`),console.warn("Successfully changed the theme for user")}catch(t){console.error("Failed to change theme: ",t)}}async logout(){this.user=null;try{await b.get(`${window.location.pathname}logout`),window.location.reload()}catch(e){console.error("Failed to logout: ",e)}a.each(this.logoutCallbackList,e=>{e()})}onLogout(e){this.logoutCallbackList.push(e)}checkPermission(e){return a.includes(this.user.group.modules,e)}}const F=new yt;class Ct{constructor(){this.config={}}async init(){try{const{data:e}=await $.get(`${window.location.pathname}config`);this.config=e}catch(e){console.error("Error during init of ConfigService:",e)}}}const V=new Ct;let bt=class{constructor(){this.dict={},this.locale="enUS"}async init(){const{data:e}=await $.get(`${window.location.pathname}i18n/config.json`);this.config=a.get(e,"config.language",{defaultLocale:"enUS",locales:["enUS"]}),this.locale=a.get(this.config,"defaultLocale","enUS");for(const t of this.config.locales)try{const{data:i}=await $.get(`${window.location.pathname}i18n/${t}.json`);this.dict[t]=i}catch(i){console.warn(`TranslateService wasn't able to pull ${t}: `,i)}}setLocale(e){this.locale=e}get(e,t,i){if(a.isString(e)){const r=this.dict[t||this.locale]&&this.dict[t||this.locale][e];return r?a.template(r)(i):e}return a.isEmpty(e)?"":e[t||this.locale]||""}};const h=new bt;class wt{constructor(){this.cacheMap={}}async cache(e){const{data:t}=await $.get(`${window.location.pathname}../api/${e}`);return a.get(t,"userLoggedOut",!1)?(console.info("Received userLoggedOut from server, will redirect to login page"),window.location.reload(),[]):(this.cacheMap[e]=t,this.get(e))}get(e){const t=this.cacheMap[e];return a.isUndefined(t)&&console.info(`resource (${e}) is not cached`),t}setSchemas(e){this.schemas=e}getSchema(e){return a.find(this.schemas,{title:e})}}const E=new wt;function p(s,e,t,i,r,n,l,o){var c=typeof s=="function"?s.options:s;e&&(c.render=e,c.staticRenderFns=t,c._compiled=!0),i&&(c.functional=!0),n&&(c._scopeId="data-v-"+n);var d;if(l?(d=function(g){g=g||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!g&&typeof __VUE_SSR_CONTEXT__<"u"&&(g=__VUE_SSR_CONTEXT__),r&&r.call(this,g),g&&g._registeredComponents&&g._registeredComponents.add(l)},c._ssrRegister=d):r&&(d=o?function(){r.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:r),d)if(c.functional){c._injectStyles=d;var _=c.render;c.render=function(L,I){return d.call(I),_(L,I)}}else{var C=c.beforeCreate;c.beforeCreate=C?[].concat(C,d):[d]}return{exports:s,options:c}}const $t={data(){return{}},mounted(){},methods:{notify(s,e="success"){a.get(console,e,console.info)(s),ee.send(s,e)}}},St=null,Lt=null;var Tt=p($t,St,Lt,!1,null,null,null,null);const M=Tt.exports,Rt={};var Et=function(){var e=this,t=e._self._c;return t("div",{staticClass:"showbox active"},[t("div",{staticClass:"loader"},[t("svg",{staticClass:"circular",attrs:{viewBox:"25 25 50 50"}},[t("circle",{staticClass:"path",attrs:{cx:"50",cy:"50",r:"20",fill:"none","stroke-width":"2","stroke-miterlimit":"10"}})])])])},It=[],xt=p(Rt,Et,It,!1,null,null,null,null);const Ce=xt.exports,kt={props:{localeList:{type:Array,default:()=>[]}},data(){return{TranslateService:h}},methods:{select(s){h.setLocale(s)}}};var Dt=function(){var e=this,t=e._self._c;return e.localeList&&e.localeList.length>1?t("div",{staticClass:"locale-list"},e._l(e.localeList,function(i,r){return t("div",{key:r,staticClass:"locale",class:{active:e.TranslateService.locale==i},on:{click:function(n){return e.select(i)}}},[e._v(" "+e._s(e._f("translate")("TL_"+i.toUpperCase()))+" ")])}),0):e._e()},Ot=[],Mt=p(kt,Dt,Ot,!1,null,null,null,null);const Ft=Mt.exports;class At{constructor(){Le(this),this.events=new he,this.connection=null,this.clientID=0,this.isConnecting=!1,this.isConnected=!1,this.connecting=!1,this.serverUrl=!1}async init(e){this.serverUrl=`ws://${window.location.hostname}:${a.get(e,"webserver.port",9090)}`,this.connect()}connect(){clearTimeout(this.connecting),!this.isConnecting&&(this.isConnecting=!0,this.isConnected=!1,this.events.emit("connected",!1),setTimeout(()=>{this.client=new WebSocket(this.serverUrl,"json"),console.info(`Created websocket client for ${this.serverUrl}`),this.client.onopen=this.onOpen,this.client.onclose=this.onClose,this.client.onmessage=this.onMessage},150))}onClose(e){console.info("Websocket - onClose",e),this.isConnecting=!1,this.isConnected=!1,this.events.emit("connected",!1),clearTimeout(this.heatbeat),clearTimeout(this.connecting),this.connecting=setTimeout(async()=>{await this.connect()},500)}onOpen(e){this.onHeartbeat(),this.isConnecting=!1,this.isConnected=!0,this.events.emit("connected",!0)}onMessage(e){const t=JSON.parse(e.data),i=a.get(t,"action","??");if(i==="ping")return this.pong();this.events.emit(i,a.get(t,"data",{}))}pong(){this.send({action:"pong",bearer:"9-0123456789"}),this.onHeartbeat()}send(e){try{this.client&&this.client.send(JSON.stringify(e))}catch(t){console.error("WebSocket::send: Error:",t)}}onHeartbeat(){clearTimeout(this.heatbeat),this.heatbeat=setTimeout(()=>{this.client.close()},3e4+5e3)}}const A=new At;D.extend(Te);const Nt={props:{config:{type:[Object,Boolean],default:!1}},data(){return{TranslateService:h,destroyed:!1,type:null,timer:null,system:{cpu:{count:0,usage:0,model:"Unknown"},memory:{totalMemMb:0,usedMemMb:0,freeMemMb:0,freeMemPercentage:0},network:"not supported",drive:"not supported",uptime:0}}},computed:{showLogoutButton(){return!a.get(window,"disableJwtLogin",!1)}},async mounted(){A.events.on("getSystemInfo",s=>{this.system=s,this.$forceUpdate()}),await A.init(this.config),this.getSystemData()},destroyed(){this.destroyed=!0,clearTimeout(this.timer)},methods:{getTheme(){return a.get(F,"user.theme","light")==="dark"},async onChangeTheme(s){this.$vuetify.theme.dark=s},async logout(){await F.logout()},async getSystemData(){try{A.send({action:"getSystemInfo"})}catch(s){console.error(s)}this.destroyed||(this.timer=setTimeout(this.getSystemData,this.error?1e4:5e3))},select(s){this.$emit("selectItem",s)},timeAgo(s){return D().subtract(parseInt(s,10),"second").fromNow()},convertBytes(s){const e=["MB","GB","TB"];if(s===0)return"0 MB";if(Math.log(s)<=0)return`${s.toFixed(1)} MB`;const t=parseInt(Math.floor(Math.log(s)/Math.log(1024)));return t<=0?s+" "+e[t]:(s/Math.pow(1024,t)).toFixed(1)+" "+e[t]}}};var Vt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"system-info"},[t(me,{attrs:{"content-class":"system-info-menu","offset-y":"","close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:r}){return[t(v,e._g(e._b({attrs:{icon:""}},"v-btn",r,!1),i),[t(f,[e._v("mdi-cog-outline")])],1)]}}])},[t("div",{staticClass:"system-info-wrapper"},[t("div",{staticClass:"theme-switch"},[t("div",{staticClass:"theme-switch-container"},[t(f,[e._v("mdi-theme-light-dark")]),t(pe,{attrs:{"input-value":e.getTheme(),compact:"",dense:"","hide-details":"",solo:""},on:{change:e.onChangeTheme}})],1)]),t("div",{staticClass:"node-cms-title flex"},[e._v(" "+e._s(e._f("translate")("TL_SYSTEM"))+" "),e.showLogoutButton?t(v,{attrs:{color:"error",small:""},on:{click:function(i){return e.logout()}}},[t(f,{attrs:{small:"",color:"black"}},[e._v("mdi-link-variant-off")]),e._v(e._s(e._f("translate")("TL_LOGOUT")))],1):e._e()],1),t("div",{staticClass:"stats cpu"},[t("div",{staticClass:"node-cms-title"},[t("small",[t("b",[e._v("CPU Usage")])])]),t(G,{attrs:{color:"#6af",rounded:"",value:e.system.cpu.usage}}),t("small",{staticClass:"text"},[e._v(e._s(e.system.cpu.count)+" cores ("+e._s(e.system.cpu.model)+")")])],1),t("div",{staticClass:"stats ram"},[t("div",{staticClass:"node-cms-title"},[t("small",[t("b",[e._v("Memory Usage")])])]),t(G,{attrs:{color:"#6af",rounded:"",value:100-e.system.memory.freeMemPercentage}}),t("small",{staticClass:"text"},[e._v(e._s(e.convertBytes(e.system.memory.usedMemMb))+" / "+e._s(e.convertBytes(e.system.memory.totalMemMb)))])],1),e.system.drive!="not supported"?t("div",{staticClass:"stats drive"},[t("div",{staticClass:"node-cms-title"},[t("small",[t("b",[e._v("Disk Usage")])])]),t(G,{attrs:{color:"#6af",rounded:"",value:100-e.system.drive.usedPercentage}}),t("small",{staticClass:"text"},[e._v(e._s(e.convertBytes(e.system.drive.usedGb*1024))+" / "+e._s(e.convertBytes(e.system.drive.totalGb*1024)))])],1):e._e(),t("div",{staticClass:"stats two-by-two"},[e.system.network!="not supported"?t("div",{staticClass:"stats network"},[t("div",{staticClass:"node-cms-title"},[t("small",[t("b",[e._v("Network Usage")])])]),t("small",{staticClass:"text"},[e._v(e._s(e.convertBytes(e.system.network.total.outputMb))+" "),t(f,[e._v("mdi-arrow-up")]),e._v(" / "+e._s(e.convertBytes(e.system.network.total.inputMb))+" "),t(f,[e._v("mdi-arrow-down")])],1)]):e._e(),t("div",{staticClass:"stats uptime"},[t("div",{staticClass:"node-cms-title"},[t("small",[t("b",[e._v("Uptime")])])]),t("small",{staticClass:"text"},[e._v(e._s(e.timeAgo(e.system.uptime)))])])])])])],1)},Ut=[],Pt=p(Nt,Vt,Ut,!1,null,"72b13096",null,null);const Bt=Pt.exports;const qt={props:{selectResourceCallback:{type:Function,default:()=>{}},resourceList:{type:Array,default:()=>[]},plugins:{type:Array,default:()=>[]},selectedItem:{type:Object,default:()=>{}}},computed:{groupedList(){const s={name:"TL_OTHERS"},e={name:"TL_PLUGINS"};let t=[s,e],i=a.union(this.resourceList,a.map(this.plugins,r=>a.extend(r,{type:"plugin"})));return a.each(i,r=>{a.isEmpty(r.group)||a.isString(r.group)||a.find(t,l=>{if(a.isEqual(l.name,r.group))return l})||t.push({name:r.group})}),a.each(i,r=>{a.isEmpty(r.group)||a.isString(r.group)&&(a.find(t,l=>{if(l===r.group||l.name===r.group||a.includes(a.values(l.name),r.group))return l})||t.push({name:r.group}))}),a.each(i,r=>{const n=a.find(t,l=>{if(a.isEqual(l.name,r.group)||l===r.group||l.name===r.group||a.includes(a.values(l.name),r.group))return l});if(n){n.list=n.list||[],n.list.push(r);return}r.type==="plugin"?(e.list=e.list||[],e.list.push(r)):(s.list=s.list||[],s.list.push(r))}),t=a.orderBy(t,r=>r.name==="CMS"?String.fromCharCode(0):r===s?String.fromCharCode(255):`${h.get(r.name,"enUS")}`.toLowerCase(),"asc"),a.filter(t,r=>r.list&&r.list.length!==0)}},mounted(){this.$nextTick(()=>{a.isEmpty(this.selectedItem)&&this.selectResourceCallback(a.first(a.get(a.first(this.groupedList),"list",[])))})},methods:{getResourceTitle(s){return s.displayname?h.get(s.displayname):s.title},groupSelected(s){if(!this.selectedItem)return!1;const e=a.get(this.selectedItem,"group.enUS",a.get(this.selectedItem,"group",!1)),t=a.get(s,"name.enUS",s.name);return t==="TL_OTHERS"&&!e?!0:t===e}}};var jt=function(){var e=this,t=e._self._c;return e.groupedList?t("div",{staticClass:"resources-content"},[t("div",{staticClass:"resource-list"},e._l(e.groupedList,function(i,r){return t("div",{key:`resource-group-${r}`,staticClass:"resource"},[t(me,{attrs:{"open-on-hover":"","offset-y":""},scopedSlots:e._u([{key:"activator",fn:function({on:n,attrs:l}){return[t(v,e._g(e._b({class:{selected:e.groupSelected(i)},attrs:{outlined:e.groupSelected(i),text:"",small:""}},"v-btn",l,!1),n),[e._v(" "+e._s(e._f("translate")(i.name))+" ")])]}}],null,!0)},[t(Re,{attrs:{dense:"",nav:""}},e._l(i.list,function(n){return t(Ee,{key:n.name,class:{selected:e.selectedItem===n},attrs:{dense:""},on:{click:function(l){return e.selectResourceCallback(n)}}},[t(Ie,[e._v(e._s(e.getResourceTitle(n)))])],1)}),1)],1)],1)}),0)]):e._e()},Ht=[],zt=p(qt,jt,Ht,!1,null,"22877e5c",null,null);const Kt=zt.exports;const Gt={components:{SystemInfo:Bt,ResourceList:Kt},props:{toolbarTitle:{type:[String,Boolean],default:!1},config:{type:[Object,Boolean],default:!1},localeClass:{type:Object,default:()=>{}},selectResourceCallback:{type:Function,default:()=>{}},resourceList:{type:Array,default:()=>[]},plugins:{type:Array,default:()=>[]},selectedItem:{type:Object,default:()=>{}}},methods:{getPageTitle(){const s=[];this.toolbarTitle&&s.push(this.toolbarTitle);const e=this.getSelectedItemName();return e&&s.push(e),a.join(s," - ")},getSelectedItemName(){return a.get(this.selectedItem,"displayname",!1)?h.get(this.selectedItem.displayname):a.get(this.selectedItem,"name",!1)}}};var Yt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"nav-bar-wrapper"},[t(xe,{staticClass:"nav-bar",class:e.localeClass,attrs:{"min-width":"100%",width:"100%"}},[t(ke,[e._v(e._s(e.getPageTitle()))]),t(ne),t("resource-list",{attrs:{"select-resource-callback":e.selectResourceCallback,"resource-list":e.resourceList,plugins:e.plugins,"selected-item":e.selectedItem}}),t(ne),e.config?t("system-info",{attrs:{config:e.config}}):e._e()],1)],1)},Wt=[],Qt=p(Gt,Yt,Wt,!1,null,null,null,null);const Xt=Qt.exports,be={methods:{getName(s){return this.getValue(s,a.first(this.resource.schema),this.resource.displayItem)},getValue(s,e,t){let i="";if(e){if(e.input==="file"){const r=a(s).get("_attachments",[]).find(n=>n._name===e.field);i=r&&r._filename}else if(e.input==="select"){let r=a.get(s,e.field);a.isString(r)&&(r=a.find(E.get(e.source),{_id:r}),r&&a.each(e.options&&e.options.extraSources,(n,l)=>{const o=a.get(r,l);a.isString(o)&&a.set(r,l,a.find(E.get(n),{_id:o}))})),e.options&&e.options.customLabel?i=J.render(e.options.customLabel,r||{}):i=a.get(r,a.chain(r).keys().first().value(),"")}i===""&&(this.resource.locales&&(e.localised||a.isUndefined(e.localised))?i=a.get(s,`${this.locale}.${e.field}`):i=a.get(s,e.field))}if(t){const r=a.clone(s);a.each(this.getExtraRessources(),(n,l)=>{const o=E.get(n);if(o){const c=a.find(o,{_id:a.get(r,l)});c&&a.set(r,l,c)}}),i=J.render(t,r)}return i},getExtraRessources(){return a.extend(a.get(this.resource,"extraSources",{}),a.get(this.resource,"schema[0].options.extraSources"))}}};const Zt={mixins:[be],props:{list:{type:[Array,Boolean],default:()=>[]},resource:{type:[Object,Boolean],default:()=>{}},selectedItem:{type:Object,default:()=>{}},locale:{type:String,default:"enUS"},multiselect:{type:Boolean,default:!1},multiselectItems:{type:[Array,Boolean],default:()=>[]}},data(){return{cachedMap:{},search:null,TranslateService:h,sift:{isQuery:!1,isValid:!1},query:{},localMultiselectItems:[],includes:a.includes}},computed:{maxCount(){return a.get(this.resource,"maxCount",0)},listCount(){return a.get(this.list,"length",0)},filteredList(){let s=this.getSearchableFields();return s.length===0&&(s=[a.first(this.resource.schema)]),a.forEach(this.list,e=>e._searchable={id:!1,keyFields:!1,query:!1}),this.sift.isQuery?a.forEach(this.list.filter(fe(this.query)),e=>e._searchable.query=!0):a.filter(this.list,e=>{if(a.isEmpty(this.search))return!0;const t=[];a.forEach(s,l=>{t.push(this.getValue(e,l,this.resource.displayItem))});let i=0,r=0;for(const l in this.query){const o=this.query[l];i=i+1;let c=a.get(e,l);a.isUndefined(c)===!1&&(a.isArray(c)?a.includes(c,o)&&(r=r+1):c===o&&(r=r+1))}let n=!1;return i>0&&i===r?(n=!0,e._searchable.query=!0):this.doesMatch(this.search,t)?(n=!0,e._searchable.keyFields=!0):new RegExp(this.search,"i").test(e._id)&&(n=!0,e._searchable.id=!0),n})}},watch:{search:function(){this.query=this.flatten(De.parse(this.search)),this.sift.isQuery=!1;try{this.search.search("sift:")===0&&(this.sift.isQuery=!0,this.query=ge.parse(this.search.substr(5)),this.sift.isValid=!0)}catch{this.sift.isValid=!1,this.query={}}},multiselectItems(){this.localMultiselectItems=a.cloneDeep(this.multiselectItems)}},async mounted(){},methods:{selectAll(){this.multiselect&&(this.localMultiselectItems.length===this.filteredList.length?this.localMultiselectItems=[]:this.localMultiselectItems=this.filteredList,this.$emit("changeMultiselectItems",this.localMultiselectItems))},dive(s,e,t){for(let i in e)if(i in e){let r=i,n=e[i];s.length>0&&(r=s+"."+i),typeof n=="object"?this.dive(r,n,t):t[r]=n}},flatten(s){let e={};return this.dive("",s,e),e},async interactiveSearch(s){const e=a.get(s,"srcKey",!1),t=a.get(this.$refs,"['search']",!1);if(!(!e||!t))return e==="esc"?t.blur():t.focus()},select(s){this.multiselect?(a.includes(this.multiselectItems,s)?this.localMultiselectItems=a.difference(this.localMultiselectItems,[s]):this.localMultiselectItems.push(s),this.$emit("changeMultiselectItems",this.localMultiselectItems)):this.$emit("selectItem",s)},selectTo(s){if(this.multiselect){const e=a.first(this.localMultiselectItems);let t=!1;for(const i of this.filteredList)i===e&&(this.localMultiselectItems=[i]),t===!0&&this.localMultiselectItems.push(i),i===e&&(t=!0),i===s&&(t=!1);this.$emit("changeMultiselectItems",this.localMultiselectItems)}else this.$emit("selectItem",s)},onClickMultiselect(){this.localMultiselectItems=[],this.$emit("changeMultiselectItems",this.localMultiselectItems),this.$emit("selectMultiselect",!this.multiselect)},onClickNew(){this.localMultiselectItems=[],this.$emit("changeMultiselectItems",this.localMultiselectItems),this.$emit("selectMultiselect",!1),this.$emit("selectItem",{_local:!0})},getSearchableFields(){return a.filter(this.resource.schema,s=>s.searchable===!0)},doesMatch(s,e){let t=!1;return a.forEach(e,i=>{if(t=new RegExp(this.search,"i").test(i),t)return!1}),t}}};var Jt=function(){var e=this,t=e._self._c;return e.maxCount!=1?t("div",{staticClass:"record-list"},[t("div",{staticClass:"top-bar"},[t("div",{directives:[{name:"shortkey",rawName:"v-shortkey",value:{esc:["esc"],open:["/"]},expression:"{esc: ['esc'], open: ['/']}"}],staticClass:"search",class:{"is-query":e.sift.isQuery,"is-valid":e.sift.isQuery&&e.sift.isValid==!0,"is-invalid":e.sift.isQuery&&e.sift.isValid==!1},on:{shortkey:e.interactiveSearch}},[t(se,{ref:"search",staticClass:"search-bar",attrs:{flat:"",outlined:"","hide-details":"",dense:"",placeholder:e._f("translate")("TL_SEARCH"),type:"text",name:"search"},model:{value:e.search,callback:function(i){e.search=i},expression:"search"}}),t("div",{staticClass:"multiselect",class:{active:e.multiselect},on:{click:e.onClickMultiselect}},[t(f,{attrs:{color:"black"}},[e._v("mdi-list-box")])],1),e.maxCount<=0||e.listCount<e.maxCount?[t("div",{staticClass:"new",on:{click:e.onClickNew}},[e._v("+")])]:e._e()],2)]),t("div",{directives:[{name:"shortkey",rawName:"v-shortkey",value:e.multiselect?["ctrl","a"]:!1,expression:"multiselect ? ['ctrl', 'a'] : false"}],staticClass:"records",on:{shortkey:function(i){return e.selectAll()}}},[t("RecycleScroller",{staticClass:"list",attrs:{items:e.filteredList,"item-size":80,"key-field":"_id"},scopedSlots:e._u([{key:"default",fn:function({item:i}){return[t("div",{staticClass:"item",class:{selected:i==e.selectedItem||e.multiselect&&e.includes(e.multiselectItems,i),frozen:!i._local},on:{click:[function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey?null:e.select(i)},function(r){return r.shiftKey?e.selectTo(i):null}]}},[i?t("div",{staticClass:"main"},[t("span",{staticClass:"icon"},[i._searchable?t("span",{staticClass:"searchable"},[i._searchable.query==!0?t(f,[e._v("mdi-target")]):i._searchable.id==!0?t(f,[e._v("mdi-key")]):i._searchable.keyFields==!0?t(f,[e._v("mdi-format-list-bulleted")]):t(f,{staticClass:"default"},[e._v("mdi-format-list-bulleted")])],1):e._e()]),t("span",[e._v(" "+e._s(e.getName(i))+" ")])]):e._e(),t("div",{staticClass:"meta"},[t("span",{staticClass:"id ng-binding"},[t("span",[e._v(e._s(i._id))])]),t("span",{staticClass:"ts"},[e._v(" "+e._s(e._f("translate")("TL_UPDATED"))+" "),t("timeago",{attrs:{since:i._updatedAt,locale:e.TranslateService.locale}})],1)])])]}}],null,!1,1004161279)})],1)]):e._e()},es=[],ts=p(Zt,Jt,es,!1,null,"80947743",null,null);const ss=ts.exports;let q;window.TranslateService?q=window.TranslateService:q=h;const te=s=>{const e={},t=a.get(s,"model","").split(".");return a.get(s,"localised",!1)&&(e.locale=t.shift()),e.key=t.join("."),e},is=s=>String(s).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),U={url:s=>{try{return!!new URL(s)}catch{return!1}},number:s=>a.isNumber(s),integer:s=>a.isNumber(s)&&a.isInteger(s),double:s=>a.isNumber(s)&&(a.isInteger(s)||s===+s&&s!==(s|0)),text:s=>a.isString(s),array:s=>a.isArray(s),email:s=>is(s)},k={fieldIsRequired:q.get("TL_FIELD_IS_REQUIRED"),invalidFormat:q.get("TL_INVALID_FORMAT")},Q=(s,e,t,i)=>{if(a.get(s,"required",!1)&&!a.isNumber(e))return k.fieldIsRequired;const r=a.get(U,i,!1);return r?r(Number(e||0),s,t,k):(console.error(`checkNumber - No validator found for type '${i}'`),!1)},x={array:s=>a.isArray(s),email:s=>new RegExp("/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/").test(s),text:(s,e,t)=>{if(a.get(e,"required",!1)&&(!a.isString(s)||a.isEmpty(s)))return k.fieldIsRequired;const i=a.head(a.get(e,"model","").split("."));if(a.get(e,"regex.value",!1)===!1&&a.get(e,`regex['${i}'].value`,!1)===!1)return!0;let r=!1,n=!1;if(e.localised&&i&&(r=a.get(e,`regex['${i}'].value`,!1),n=a.get(e,`regex['${i}'].description`,!1)),r===!1&&(r=a.get(e,"regex.value",!1),n=a.get(e,"regex.description",!1)),n===!1&&(n=r),r&&a.isString(r)){const l=r.match(/\/(.*?)\/([gimy])?$/);if(!new RegExp(l[1],l[2]||"").test(s))return`${k.invalidFormat} (${q.get(n)})`}return!0},number:(s,e,t)=>Q(e,s,t,"number"),double:(s,e,t)=>Q(e,s,t,"double"),integer:(s,e,t)=>(a.isUndefined(s)&&(s=""),s.toString().indexOf(".")!==-1?!1:Q(e,s,t,"integer")),image:(s,e,t)=>{const{key:i,locale:r}=te(e),n=a.find(a.get(t,"_attachments",[]),l=>!(l._name!==i||r&&l._fields.locale!==r));return a.get(e,"required",!1)&&!n?k.fieldIsRequired:!0},file:(s,e,t)=>{const{key:i,locale:r}=te(e),n=a.find(a.get(t,"_attachments",[]),l=>!(l._name!==i||r&&l._fields.locale!==r));return a.get(e,"required",!1)&&!n?k.fieldIsRequired:!0},select:(s,e,t)=>a.get(e,"required",!1)&&a.isEmpty(s)?k.fieldIsRequired:!0};let we={string:{type:"input",overrideType:"CustomInput",validator:x.text},text:{type:"textarea",overrideType:"CustomTextarea",rows:5,validator:x.text},password:{type:"input",inputFieldType:"password",overrideType:"CustomInput"},email:{type:"input",overrideType:"CustomInput",inputFieldType:"email",validator:U.email},url:{type:"input",overrideType:"CustomInput",validator:U.url},number:{type:"input",overrideType:"CustomInput",inputFieldType:"number",validator:x.number},double:{type:"input",overrideType:"CustomInput",inputFieldType:"number",validator:x.double},integer:{type:"input",overrideType:"CustomInput",inputFieldType:"number",validator:x.integer},checkbox:{type:"switch",overrideType:"CustomSwitch"},date:{type:"CustomDatetimePicker",format:"YYYY-MM-DD",customDatetimePickerOptions:{format:"YYYY-MM-DD"}},time:{type:"CustomDatetimePicker",format:"hh:mm:ss a",customDatetimePickerOptions:{format:"hh:mm:ss a"}},datetime:{type:"CustomDatetimePicker",format:"YYYY-MM-DD hh:mm:ss a",customDatetimePickerOptions:{format:"YYYY-MM-DD hh:mm:ss a"}},pillbox:{type:"CustomInputTag",selectOptions:{taggable:!0,multiple:!0,searchable:!0,onNewTag(s,e,t,i){t.push(s),i.push(s)}},values:[],validator:U.array},select:{type:"CustomMultiSelect",selectOptions:{multiple:!1,trackBy:"_id",customLabel:(s,e)=>a.get(e,s,s),searchable:!0},validator:x.select},multiselect:{type:"CustomChecklist",validator:U.array},json:{type:"TreeView",overrideType:"CustomTreeView",treeViewOptions:{maxDepth:4,rootObjectKey:"root",modifiable:!1}},code:{type:"Code",overrideType:"CustomCode",options:{}},wysiwyg:{type:"Wysiwyg",overrideType:"WysiwygField"},image:{type:"ImageView",validator:x.image},file:{type:"AttachmentView",validator:x.file},paragraph:{type:"ParagraphView"},group:{type:"group",overrideType:"Group"},object:{type:"JsonEditor"},color:{type:"ColorPicker",colorPickerOptions:{}},paragraphImage:{type:"paragraphAttachmentView",overrideType:"ParagraphAttachmentView",fileType:"image",validator:x.image},paragraphFile:{type:"paragraphAttachmentView",overrideType:"ParagraphAttachmentView",validator:x.file}};a.each(we,s=>{s.dense=!0,s.outlined=!0});class as{constructor(){this.typeMapper=we}getKeyLocale(e){return te(e)}}const oe=new as;let R;window.TranslateService?R=window.TranslateService:R=h;class rs{constructor(){this.typeMapper=oe.typeMapper}getSchemaFields(e,t,i,r,n,l,o){let c=a.map(e,d=>{const _=t.locales&&(d.localised||a.isUndefined(d.localised)),C=d.label&&R.get(d.label);let g=a.extend({},this.typeMapper[d.input],{label:`${C||d.field}${_?` (${R.get(`TL_${i.toUpperCase()}`)})`:""}`,model:_?`${i}.${d.field}`:d.field,originalModel:d.field,placeholder:`${C||d.field}${_?` (${R.get(`TL_${i.toUpperCase()}`)})`:""}`,disabled:n||a.get(d,"options.disabled",!1),readonly:a.get(d,"options.readonly",!1),required:!!d.required,options:d.options,resource:t,locale:i,userLocale:r,rootView:o});if(g=a.merge({},d.options,g),d.input==="file"&&a.get(g,"maxCount",!1)===!1)g.maxCount=1/0;else if(d.input==="select"&&a.get(g,"labels",!1))g.selectOptions.label=a.map(g.labels,(L,I)=>({value:I,text:a.get(L,`${i}`,L)}));else if(d.input==="multiselect"&&a.get(g,"labels",!1)&&!a.isObject(a.first(d.source))){const L=[];a.forEach(d.source,I=>{L.push({text:a.get(g,`labels.${I}`,I),value:I})}),d.source=L}return(d.input==="select"||d.input==="pillbox")&&(g.selectOptions.selectLabel=R.get("TL_MULTISELECT_SELECT_LABEL"),g.selectOptions.selectGroupLabel=R.get("TL_MULTISELECT_SELECT_GROUP_LABEL"),g.selectOptions.selectedLabel=R.get("TL_MULTISELECT_SELECTED_LABEL"),g.selectOptions.deselectLabel=R.get("TL_MULTISELECT_DESELECT_LABEL"),g.selectOptions.deselectGroupLabel=R.get("TL_MULTISELECT_DESELECT_GROUP_LABEL"),g.selectOptions.tagPlaceholder=R.get("TL_MULTISELECT_TAG_PLACEHOLDER")),g});for(const d in e){const _=e[d];a.isArray(_.source)?c[d].values=_.source:a.isString(_.source)&&this.updateFieldSchema(c,_,d,i,l),c[d].localised=t.locales&&(_.localised||a.isUndefined(_.localised))}return c}updateFieldSchema(e,t,i,r,n){const l=E.get(t.source);n=a.extend({},n,a.get(t,"options.extraSources")),a.each(n,(_,C)=>{const g=E.get(_);a.each(l,L=>{const I=a.get(L,C);a.isString(I)&&a.set(L,C,a.find(g,{_id:I}))})});const o=E.getSchema(t.source),c=o&&a.first(o.schema);let d="_id";c&&(d=c.field,o.locales&&r&&(c.localised||a.isUndefined(c.localised))&&(d=`${r}.${d}`)),e[i].values=l||[],e[i].type==="CustomMultiSelect"?(e[i].selectOptions=e[i].selectOptions||{},e[i].selectOptions=a.clone(e[i].selectOptions),e[i].selectOptions.key="_id",e[i].selectOptions.customLabel=_=>{const C=a.isString(_)?a.find(l,{_id:_}):_;return e[i].customLabel?J.render(e[i].customLabel,C):a.get(C,d)}):e[i].type==="CustomChecklist"&&(e[i].customChecklistOptions=e[i].customChecklistOptions||{},e[i].customChecklistOptions.name=d,e[i].customChecklistOptions.value="_id")}getKeyLocale(e){return oe.getKeyLocale(e)}getNestedGroups(e,t,i,r,n){let l=a.groupBy(t,o=>{let c=o.originalModel;return n&&(c=c.replace(n,"")),c=c.split("."),c[i]});return l=a.map(l,(o,c)=>{if(a.uniqBy(o,"originalModel").length===1){const C=a.first(o);return o.length>1&&console.warn(`duplicated field '${C.model}' detected in resource '${e.displayname||e.title}'`),C}let d=`${r}.${c}`;a.isUndefined(r)&&(d=c);let _=a.get(e,`groups.${d}.label`,c);return _=R.get(_),a.extend({},this.typeMapper.group,{label:_,key:c,path:r,groupOptions:{fields:this.getNestedGroups(e,o,i+1,r,n)}})}),l}}const H=new rs,ce=window.TranslateService||h,ae={mixins:[M],methods:{async uploadAttachments(s,e){this.$loading.start("uploadAttachments");try{for(const t of e){const i=new FormData;i.append(t._name,t.file),t._fields.locale&&i.append("locale",t._fields.locale),t._filename&&i.append("_filename",t._filename),t._fields.fileItemId&&i.append("fileItemId",t._fields.fileItemId),a.get(t,"cropOptions",!1)&&(console.warn("detected cropOptions, will add it to the request"),i.append("cropOptions",JSON.stringify(t.cropOptions))),a.get(t,"orderUpdated",!1)&&a.get(t,"order",!1)&&i.append("order",t.order),await $.post(`../api/${this.resource.title}/${s}/attachments`,i)}}catch(t){console.error("Error happen during uploadAttachments:",t)}this.$loading.stop("uploadAttachments")},async updateAttachments(s,e){this.$loading.start("updateAttachments");try{for(const[t,i]of e.entries()){const r=a.omit(a.get(i,"cropOptions",{}),["updated"]),n=a.get(i,"order",t+1);await $.put(`../api/${this.resource.title}/${s}/attachments/${i._id}`,{cropOptions:r,order:n})}}catch(t){console.error("Error happen during updateAttachments:",t)}this.$loading.stop("updateAttachments")},async removeAttachments(s,e){this.$loading.start("remove-attachments");try{for(const t of e)await $.delete(`../api/${this.resource.title}/${s}/attachments/${t._id}`)}catch(t){console.error("Error happen during removeAttachments:",t)}this.$loading.stop("remove-attachments")},getTypePrexix(s){let e=!1;return s==="create"?e="TL_ERROR_ON_RECORD_CREATION":s==="update"?e="TL_ERROR_ON_RECORD_UPDATE":s==="delete"&&(e="TL_ERROR_ON_RECORD_DELETE"),e?ce.get(e):"Error"},manageError(s,e,t){let i=this.getTypePrexix(e),r=i;if(a.get(s,"response.data.code",500)===400){const n=a.get(s,"response.data");a.get(n,"message",!1)?r=`${i}: ${n.message}`:r=`${i}: ${ce.get("TL_UNKNOWN_ERROR")}`}console.error(r,t),this.notify(r,"error")},async updateSchema(){try{const s=!(this.record&&this.record._local);this.$loading.start("loading-schema");const e=H.getSchemaFields(this.resource.schema,this.resource,this.locale||this.userLocale,this.userLocale,s,this.resource.extraSources);this.$loading.stop("loading-schema");const t=H.getNestedGroups(this.resource,e,0);this.schema.fields=t,this.originalFieldList=e}catch(s){console.error("AbstractEditorView - updateSchema - Error happen during updateSchema:",s)}}}},ns={mixins:[ae,M],props:{resourceList:{type:[Array,Boolean],default:()=>[]},resource:{type:Object,default:()=>{}},record:{type:Object,default:()=>{}},locale:{type:String,default:()=>"enUS"},userLocale:{type:String,default:()=>"enUS"}},data(){return{formValid:!1,fileInputTypes:["file","img","image","imageView","attachmentView"],cachedMap:{},editingRecord:{},activeLocale:a.indexOf(this.resource.locales,this.locale),originalFieldList:[],schema:{fields:[]},isReady:!1,formOptions:{validateAfterLoad:!0,validateAfterChanged:!0},rowOptions:{justify:"start",align:"start",noGutters:!1}}},watch:{async locale(){await this.updateSchema(),this.editingRecord=a.clone(this.editingRecord),this.activeLocale=a.indexOf(this.resource.locales,this.locale),this.checkDirty()},async record(){await this.updateSchema(),this.cloneEditingRecord()},async userLocale(){await this.updateSchema(),this.editingRecord=a.clone(this.editingRecord),this.checkDirty()},model(){console.warn("MODEL CHANGED: ",this.model)}},async mounted(){await this.updateSchema(),this.cloneEditingRecord(),this.isReady=!0,console.warn("EDITING RECORD - ",this.editingRecord)},methods:{back(){this.$emit("back")},onError(s){console.log(999,"error",s)},selectLocale(s){this.activeLocale=a.indexOf(this.resource.locales,s),this.$emit("update:locale",s)},cloneEditingRecord(){const s={};a.each(this.resource.schema,e=>{if(a.includes(this.fileInputTypes,e.input))return;if(this.resource.locales&&(e.localised||a.isUndefined(e.localised)))a.each(this.resource.locales,i=>{const r=`${i}.${e.field}`;let n=a.get(this.record,r);e.input==="pillbox"?n=n||[]:e.input==="json"&&(n=n||{}),a.isPlainObject(n)&&(n=a.cloneDeep(n)),a.set(s,r,n)});else{const i=e.field;let r=a.get(this.record,i);e.input==="pillbox"&&(r=r||[]),e.input==="json"&&(r=r||{}),a.isPlainObject(r)&&(r=a.cloneDeep(r)),a.set(s,i,r)}}),this.editingRecord=a.clone(s),this.editingRecord._id=this.record._id;try{this.editingRecord._attachments=a.cloneDeep(this.record._attachments||[])}catch(e){console.error("Error during cloneEditingRecord:",e),this.editingRecord._attachments=[]}this.removeDirtyFlags()},async deleteRecord(){if(window.confirm(h.get("TL_ARE_YOU_SURE_TO_DELETE"),h.get("TL_YES"),h.get("TL_NO")))if(a.isUndefined(this.editingRecord._id))this.editingRecord={},this.$emit("update:record",null);else{this.$loading.start("delete-record");try{await $.delete(`../api/${this.resource.title}/${this.editingRecord._id}`),this.notify(h.get("TL_RECORD_DELETED",null,{id:this.editingRecord._id})),this.$emit("updateRecordList",null)}catch(s){console.error("Error happen during deleteRecord:",s),this.manageError(s,"delete",this.editingRecord)}this.$loading.stop("delete-record")}},checkFormValid(){let s=!1;try{s=this.$refs.vfg.validate()}catch(t){console.error("Not valid: ",t),s=!1}const e=a.find(this.$refs.vfg.inputs,t=>!t.valid);if(a.isUndefined(e)||(s=!1,e.focus()),this.formValid=s,!this.formValid){const t=this.editingRecord._id?h.get("TL_ERROR_CREATING_RECORD_ID",null,{id:this.editingRecord._id}):h.get("TL_ERROR_CREATING_RECORD");this.notify(t,"error")}},fieldValueOrDefault(s,e){return s.input==="pillbox"?e||[]:s.input==="json"?e||{}:e},updateLocalisedField(s,e){a.each(this.resource.locales,t=>{if(!this.formValid)return this.handleFormNotValid();const i=`${t}.${e.field}`,r=this.fieldValueOrDefault(e,a.get(this.editingRecord,i));if(t!==this.locale&&e.required&&(a.isUndefined(r)||e.input==="string"&&r.length===0)){this.selectLocale(t),this.formValid=!1,this.$forceUpdate(),this.$nextTick(()=>{this.checkFormValid()}),console.warn("required field empty",e,this.formValid);return}a.isEqual(r,a.get(this.record,i))||a.set(s,i,r)})},handleFormNotValid(){console.info("form not valid")},async createUpdateClicked(){if(this.checkFormValid(),!this.formValid)return this.handleFormNotValid();const s={};a.each(this.resource.schema,t=>{if(!this.formValid||a.includes(this.fileInputTypes,t.input))return;if(this.resource.locales&&(t.localised||a.isUndefined(t.localised)))this.updateLocalisedField(s,t);else{const r=t.field,n=this.fieldValueOrDefault(t,a.get(this.editingRecord,r));a.isEqual(n,a.get(this.record,r))||a.set(s,r,n)}});const e=a.filter(this.editingRecord._attachments,t=>!t._id);if(a.isEmpty(e)||console.warn("NEW ATTACHMENTS = ",e),!this.formValid)return this.handleFormNotValid();if(a.isUndefined(this.editingRecord._id))return this.createRecord(s,e);this.updateRecord(s,e)},async createRecord(s,e){this.$loading.start("create-record");try{const{data:t}=await $.post(`../api/${this.resource.title}`,s);await this.uploadAttachments(t._id,e),this.notify(h.get("TL_RECORD_CREATED",null,{id:t._id})),this.$emit("updateRecordList",t)}catch(t){console.error("Error happen during createRecord:",t),this.manageError(t,"create")}this.$loading.stop("create-record")},async updateRecord(s,e){this.$loading.start("update-record");try{let t=this.editingRecord;console.warn("Will send",s),a.isEmpty(s)||(t=(await $.put(`../api/${this.resource.title}/${this.editingRecord._id}`,s)).data),await this.uploadAttachments(t._id,e);const i=a.map(e,"_id"),r=a.filter(this.editingRecord._attachments,l=>l._id&&!a.includes(i,l._id)&&(a.get(l,"cropOptions.updated",!1)||a.get(l,"orderUpdated",!1)));a.isEmpty(r)||(console.warn("UPDATED ATTACHMENTS = ",a.map(r,l=>`${l.orderUpdated}-${l.order}-${l._filename}`)),await this.updateAttachments(t._id,r));const n=a.filter(this.record._attachments,l=>!a.find(this.editingRecord._attachments,{_id:l._id}));a.isEmpty(n)||(console.warn("REMOVED ATTACHMENTS = ",a.map(n,l=>`${l.order}-${l._filename}`)),await this.removeAttachments(t._id,n)),this.notify(h.get("TL_RECORD_UPDATED",null,{id:this.editingRecord._id})),this.$emit("updateRecordList",t)}catch(t){console.error("Error happen during updateRecord:",t),this.manageError(t,"update",this.editingRecord)}this.$loading.stop("update-record")},getAttachmentModel(s){const e=[];return a.get(s,"_fields.locale",!1)&&e.push(s._fields.locale),e.push(s._name),a.join(e,".")},updateFields(s,e){if(!this.isAttachmentField(e))return a.set(this.editingRecord,e,s);a.set(this.editingRecord,"_attachments",s),console.info(`Will update attachment ${e}`,s)},onModelUpdated(s,e){this.updateFields(s,e),console.info("editingRecord =",this.editingRecord),this.$refs.vfg.validate(),this.checkDirty()},isAttachmentField(s){const e=a.get(a.find(a.get(this.schema,"fields",[]),{model:s}),"originalModel",!1),t=a.get(a.find(this.resource.schema,{field:e}),"input",!1);return a.includes(this.fileInputTypes,t)},checkDirty(){a.each(this.originalFieldList,s=>{let e=!0;if(a.includes(["AttachmentView","ImageView"],s.type)){const{key:t,locale:i}=this.getKeyLocale(s),r=a.filter(this.record._attachments,l=>l._name===t&&(l._fields&&l._fields.locale)===i),n=a.filter(this.editingRecord._attachments,l=>l._name===t&&(l._fields&&l._fields.locale)===i);e=a.isEqual(r,n)}else e=a.isEqual(a.get(this.record,s.model),a.get(this.editingRecord,s.model));s.labelClasses=e?"":"dirty"})},removeDirtyFlags(){a.each(this.originalFieldList,s=>{delete s.labelClasses})},getKeyLocale(s){const e={},t=s.model.split(".");return s.localised&&(e.locale=t.shift()),e.key=t.join("."),e}}};var ls=function(){var e=this,t=e._self._c;return e.record?t("div",{staticClass:"record-editor",class:{frozen:!e.record._local}},[t(Oe,{directives:[{name:"show",rawName:"v-show",value:e.resource.locales,expression:"resource.locales"}],attrs:{"fixed-tabs":"","background-color":"white",dark:"",height:"39","hide-slider":""},model:{value:e.activeLocale,callback:function(i){e.activeLocale=i},expression:"activeLocale"}},e._l(e.resource.locales,function(i){return t(Me,{key:i,staticClass:"locale",on:{click:function(r){return e.selectLocale(i)}}},[e._v(" "+e._s(e._f("translate")("TL_"+i.toUpperCase()))+" ")])}),1),t(Fe,{ref:"vfg",attrs:{"lazy-validation":""},model:{value:e.formValid,callback:function(i){e.formValid=i},expression:"formValid"}},[e.isReady?t("custom-form",{attrs:{schema:e.schema,"form-options":e.formOptions,model:e.editingRecord,row:e.rowOptions},on:{"update:model":function(i){e.editingRecord=i},error:e.onError,input:e.onModelUpdated}}):e._e()],1),t("div",{staticClass:"buttons"},[t(v,{staticClass:"back",on:{click:e.back}},[e._v(e._s(e._f("translate")("TL_BACK")))]),t(v,{staticClass:"update",attrs:{color:"primary"},on:{click:e.createUpdateClicked}},[e._v(e._s(e._f("translate")(e.editingRecord._id?"TL_UPDATE":"TL_CREATE")))]),t(v,{staticClass:"delete",attrs:{color:"error"},on:{click:e.deleteRecord}},[e._v(e._s(e._f("translate")("TL_DELETE")))])],1)],1):e._e()},os=[],cs=p(ns,ls,os,!1,null,null,null,null);const $e=cs.exports,ds={props:["resource","schema","items","locale","options"],data(){return{selectedRecords:[],showRecordsSelection:!1,columns:[],sourceData:[],tableData:[],filteredColumns:[],sortOption:{multipleSort:!0,sortAlways:!0,sortChange:s=>{console.log("sortChange::",a.keys(s),a.values(s)),this.tableData=a.sortBy(this.tableData,a.keys(s),a.values(s))}},columnHiddenOption:{defaultHiddenColumnKeys:["__RECORD_SELECTION__"]},clipboardOption:{copy:!0,paste:!1,cut:!1,delete:!1,beforeCopy:({data:s,selectionRangeIndexes:e,selectionRangeKeys:t})=>(navigator.clipboard.writeText(this.getDataToCopy(e)),!1)},columnWidthResizeOption:{enable:!0,minWidth:50}}},computed:{orderedItem(){return this.items},schemaFields(){let s=this.schema.fields,e=[];a.forEach(s,i=>{a.get(i,"options.breakdown",!1)&&a.forEach(this.resource.locales,r=>{if(i.model===`${r}.${i.originalModel}`)i.localised=!1;else{let n=a.clone(i);n.localised=!1;const l=i.originalModel&&h.get(i.originalModel);n.label=`${l} (${h.get(`TL_${r.toUpperCase()}`)})`,n.model=`${r}.${i.originalModel}`,e.push(n)}}),i.disabled=!0}),s=s.concat(e);let t=a.filter(s,i=>a.isNumber(a.get(i,"options.index",!1)));return a.isEmpty(t)?this.schema.fields:a.sortBy(t,i=>i.options.index)}},watch:{items(){this.resetRecordsFiltering()}},mounted(){this.resetRecordsFiltering(),this.createTableColumns()},methods:{getDataToCopy(s){let e=s.startColIndex,t=s.endColIndex;this.showRecordsSelection||(e++,t++);const i=this.columns.slice(e,t+1).map(l=>l.field),r=this.tableData.slice(s.startRowIndex,s.endRowIndex+1).map(l=>a.map(i,o=>a.get(l,o,"")));let n="";return a.each(r,(l,o)=>{o!==0&&(n+=`
`),n+=l.join("	")}),n},deleteSelectedRecords(){this.$emit("remove-records",a.filter(this.sourceData,s=>a.includes(this.selectedRecords,s._id)))},toggleSelection(){return this.showRecordsSelection=!this.showRecordsSelection,this.showRecordsSelection?this.$refs.tableRef.showColumnsByKeys(["__RECORD_SELECTION__"]):this.$refs.tableRef.hideColumnsByKeys(["__RECORD_SELECTION__"])},resetRecordsFiltering(){this.sourceData=this.orderedItem,this.tableData=this.sourceData.slice(0)},createTableColumns(){const s=[{field:"__RECORD_SELECTION__",key:"__RECORD_SELECTION__",title:h.get("TL_RECORD_SELECTION"),fixed:"left",align:"center",disableResizing:!0,width:50,renderBodyCell:({row:e,column:t,rowIndex:i},r)=>r("TableRecordSelection",{props:{row:e,selected:this.isRecordSelected(e),onChange:this.onSelectRecord}})}];a.each(this.schemaFields,(e,t)=>{const i=this.getFieldType(e),r="Table"+i,n={field:e.model,key:"a"+t,title:e.label,ellipsis:{showTitle:!0,lineClamp:a.get(e,"options.lineClamp",1)},renderBodyCell:({row:l,column:o,rowIndex:c},d)=>a.includes(["CustomInput","CustomMultiSelect"],i)?a.get(l,o.field,""):r in Vue.options.components?d(r,{props:{row:l,column:o,rowIndex:c,field:e}}):(console.error(`${r} isn't defined as a custom field type, will not render it`),a.get(l,o.field,""))};a.get(e,"options.filter",!1)&&(n.filter={filterList:a.uniqBy(a.map(this.sourceData,(l,o)=>({value:o,label:e.type==="switch"?h.get("TL_"+a.toUpper(a.get(l,e.model,!1))):a.get(l,e.model),realValue:a.get(l,e.model),selected:!1})),"label"),isMultiple:a.get(e,"options.filter",!1)==="multiple",filterConfirm:l=>{const o=l.filter(c=>c.selected).map(c=>c.realValue);this.searchBy(o,e.model),a.includes(this.filteredColumns,n.field)||this.filteredColumns.push(n.field)},filterReset:l=>{this.searchBy([],e.model),this.filteredColumns=a.filter(this.filteredColumns,n.field)},filterIcon:()=>a.includes(this.filteredColumns,n.field)?le(f,["mdi-filter"]):le(f,["mdi-filter-outline"]),maxHeight:200}),a.each(["sortBy","align"],l=>{const o=a.get(e,`options.${l}`,!1);o!==!1&&a.set(n,l,o)}),s.push(n)}),s.push({field:"__ACTIONS__",key:"__ACTIONS__",title:h.get("TL_ACTIONS"),fixed:"right",disableResizing:!0,width:180,renderBodyCell:({row:e,column:t,rowIndex:i},r)=>r("TableRowActions",{props:{row:e,column:t,rowIndex:i,remove:n=>{this.$emit("remove",n)},edit:n=>{this.$emit("edit",n)}}})}),this.columns=s},isRecordSelected(s){return a.includes(this.selectedRecords,a.get(s,"_id",!1))},onSelectRecord(s,e){s?this.selectedRecords.push(e):this.selectedRecords=a.filter(this.selectedRecords,t=>t!==e),console.warn("this.selectedRecords = ",this.selectedRecords)},searchBy(s,e){this.tableData=this.sourceData.filter(t=>s.length===0||s.includes(a.get(t,e)))},editRow(s){console.warn("editRow",s)},getFieldType(s){return a.get(s,"overrideType",a.get(s,"type",!1))}}};var us=function(){var e=this,t=e._self._c;return t("div",{ref:"excel-container",staticClass:"vue-table-generator vue-form-generator table"},[t("div",{attrs:{id:"table-top"}},[t(v,{on:{click:function(i){return e.toggleSelection()}}},[e._v(e._s(e._f("translate")(`TL_${e.showRecordsSelection?"HIDE":"SHOW"}_RECORD_SELECTION`)))]),e.selectedRecords.length>0?t(v,{attrs:{color:"node-cms-red"},on:{click:function(i){return e.deleteSelectedRecords()}}},[e._v(e._s(e._f("translate")("TL_DELETE_SELECTED_RECORDS")))]):e._e()],1),t("ve-table",{ref:"tableRef",attrs:{"scroll-width":"0","sort-option":e.sortOption,"virtual-scroll-option":{enable:!0},"column-width-resize-option":e.columnWidthResizeOption,columns:e.columns,"table-data":e.tableData,"fixed-header":!0,"border-around":!0,"border-x":!0,"border-y":!0,"clipboard-option":e.clipboardOption,"column-hidden-option":e.columnHiddenOption,"max-height":"100%","row-key-field-name":"_id"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length===0,expression:"tableData.length === 0"}],staticClass:"empty-data"},[e._v(e._s(e._f("translate")("TL_NO_DATA_FOUND")))])],1)},hs=[],ms=p(ds,us,hs,!1,null,"8ab39179",null,null);const ps=ms.exports,fs={components:{VueTableGenerator:ps,RecordEditor:$e},mixins:[ae,M],props:{resourceList:{type:Array,default:()=>[]},recordList:{type:Array,default:()=>[]},locale:{type:String,default:"enUS"},resource:{type:Object,default:()=>{}},record:{type:Object,default:()=>{}}},data(){return{page:1,isReady:!1,search:null,cachedMap:{},schema:{fields:[]},TranslateService:h,localLocale:!1,localRecord:{},clonedRecordList:null}},computed:{options(){return{paging:a.get(this.resource,"options.paging",10),displayId:a.get(this.resource,"options.displayId",!0),displayUpdatedAt:a.get(this.resource,"options.displayUpdatedAt",!0)}},pageCount(){return Math.ceil(this.listCount/this.options.paging)},maxCount(){return a.get(this.resource,"maxCount",0)},listCount(){return a.get(this.clonedRecordList,"length",0)},filteredList(){let s=this.getSearchableFields();return s.length===0&&(s=[a.first(this.resource.schema)]),a.filter(this.clonedRecordList,(e,t)=>{if(a.isEmpty(this.search))return t>=this.options.paging*(this.page-1)&&t<this.options.paging*this.page;const i=[];return a.forEach(s,r=>{i.push(this.getValue(e,r))}),this.doesMatch(this.search,i)||new RegExp(this.search,"i").test(e._id)})}},watch:{async locale(){this.isReady=!1,this.localLocale=this.locale,this.$emit("update:locale",this.localLocale),await this.updateSchema(),this.isReady=!0},async record(){this.localRecord=a.cloneDeep(this.record)},async recordList(){this.clonedRecordList=a.cloneDeep(this.recordList),this.isReady=!1,await this.updateSchema(),this.isReady=!0,this.$forceUpdate()},async userLocale(){this.isReady=!1,await this.updateSchema(),this.isReady=!0}},methods:{onPaginationClick(){console.warn("onPaginationClick ---",arguments)},updateRecordList(s){this.$emit("updateRecordList",s)},selectRecord(s){this.localLocale=this.locale,this.$emit("update:record",s)},editRecord(s){this.selectRecord(s)},askConfirmation(s=!1){return window.confirm(h.get(`TL_ARE_YOU_SURE_TO_DELETE${s?"_SELECTED_RECORDS":""}`),h.get("TL_YES"),h.get("TL_NO"))},async removeRecords(s){if(!this.askConfirmation(!0))return;console.warn("will delete selected records");const e=a.map(s,t=>this.removeRecord(t,!0));await Promise.all(e),console.warn("all selected records deleted !")},async removeRecord(s,e=!1){if(!(!e&&this.askConfirmation())){if(a.isUndefined(s._id))s={},this.$emit("update:record",null);else{this.$loading.start("delete-record");try{await $.delete(`../api/${this.resource.title}/${s._id}`),this.notify(h.get("TL_RECORD_DELETED",null,{id:s._id})),this.$emit("updateRecordList",null)}catch(t){console.error("Error happen during deleteRecord:",t),this.manageError(t,"delete",this.editingRecord)}this.$loading.stop("delete-record")}this.clonedRecordList=a.filter(this.clonedRecordList,t=>s!==t)}},doesMatch(s,e){let t=!1;return a.forEach(e,i=>{if(t=new RegExp(this.search,"i").test(i),t)return!1}),t},async updateRecord(s){const e={};let t=a.find(this.recordList,{_id:s._id});a.each(this.resource.schema,n=>{if(n.input==="file"||n.input==="image")return;if(this.resource.locales&&(n.localised||a.isUndefined(n.localised)))a.each(this.resource.locales,o=>{const c=`${o}.${n.field}`;let d=a.get(s,c);n.input==="pillbox"?d=d||[]:n.input==="json"&&(d=d||{}),!a.isEqual(d,a.get(t,c))&&a.set(e,c,d)});else{const o=n.field;let c=a.get(s,o);if(n.input==="pillbox"?c=c||[]:n.input==="json"&&(c=c||{}),a.isEqual(c,a.get(t,o)))return;a.set(e,o,c)}});const i=a.filter(s._attachments,n=>!n._id),r=a.filter(t&&t._attachments,n=>!a.find(s._attachments,{_id:n._id}));if(a.isUndefined(s._id)){this.$loading.start("create-record");try{const n=await $.post(`../api/${this.resource.title}`,e);await this.uploadAttachments(n.data._id,i),this.notify(h.get("TL_RECORD_CREATED",null,{id:n.data._id})),this.$emit("updateRecordList",n.data)}catch(n){console.error("Error happend during updateRecord/create:",n),this.manageError(n,"create")}this.$loading.stop("create-record")}else{this.$loading.start("update-record");try{let n;a.isEmpty(e)?n={data:s}:n=await $.put(`../api/${this.resource.title}/${s._id}`,e),await this.uploadAttachments(n.data._id,i),await this.removeAttachments(n.data._id,r),(!a.isEmpty(e)||!a.isEmpty(i)||!a.isEmpty(r))&&this.notify(h.get("TL_RECORD_UPDATED",null,{id:s._id})),this.$emit("updateRecordList",n.data)}catch(n){console.error("Error happend during updateRecord/create:",n),this.manageError(n,"update",s)}this.$loading.stop("update-record")}},async updateRecords(){try{const s=[];this.$loading.start("update-records");let e=a.filter(this.recordList,t=>!a.find(this.clonedRecordList,{_id:t._id}));for(const t of e)s.push(async()=>{this.$loading.start("delete-record"),await $.delete(`../api/${this.resource.title}/${t._id}`),this.notify(h.get("TL_RECORD_DELETED",null,{id:t._id})),this.$emit("updateRecordList",null),this.$loading.stop("delete-record")});for(const t of a.reverse(this.clonedRecordList))s.push(async()=>await this.updateRecord(t));await B(s,{concurrency:10})}catch(s){console.error("Error happens during updateRecords:",s)}this.$loading.stop("update-records")},createRecord(){let s={_local:!0};a.each(this.schema.fields,e=>{a.set(s,e.model,void 0)}),this.clonedRecordList.push(s),this.selectRecord(s)},getSearchableFields(){return a.filter(this.resource.schema,s=>s.searchable===!0)},selectLocale(s){this.$emit("update:locale",s)},getValue(s,e){let t="";if(e)if(e.input==="file"){const i=a(s).get("_attachments",[]).find(r=>r._name===e.field);t=i&&i._filename}else this.resource.locales&&(e.localised||a.isUndefined(e.localised))?t=a.get(s,`${this.locale}.${e.field}`):t=a.get(s,e.field);return t},back(){this.$emit("unsetRecord")}}};var gs=function(){var e=this,t=e._self._c;return t("div",{staticClass:"record-table"},[e.record?e._e():[t("ul",{directives:[{name:"show",rawName:"v-show",value:e.resource.locales,expression:"resource.locales"}],staticClass:"locales"},e._l(e.resource.locales,function(i){return t("li",{key:i,class:{selected:i==e.locale},on:{click:function(r){return e.selectLocale(i)}}},[e._v(" "+e._s(e._f("translate")("TL_"+i.toUpperCase()))+" ")])}),0),t("div",{attrs:{id:"top-actions"}},[t("div",{staticClass:"search"},[t(se,{attrs:{flat:"",dense:"",compact:"",outlined:"",solo:"","hide-details":"",clearable:"",placeholder:e._f("translate")("TL_SEARCH"),type:"text",name:"search"},model:{value:e.search,callback:function(i){e.search=i},expression:"search"}})],1),e.maxCount<=0||e.listCount<e.maxCount?t("div",{staticClass:"new",on:{click:e.createRecord}},[e._v("+")]):e._e()]),e.isReady?t("vue-table-generator",{attrs:{options:e.options,resource:e.resource,schema:e.schema,items:e.filteredList,locale:e.localLocale},on:{"update:locale":function(i){e.localLocale=i},remove:e.removeRecord,"remove-records":e.removeRecords,edit:e.editRecord}}):e._e()],e.record?t("record-editor",{key:e.record._id,staticClass:"has-back-button",attrs:{"resource-list":e.resourceList,record:e.localRecord,resource:e.resource,locale:e.localLocale,"user-locale":e.TranslateService.locale},on:{"update:record":function(i){e.localRecord=i},"update:locale":function(i){e.localLocale=i},updateRecordList:e.updateRecordList,back:e.back}}):e._e()],2)},_s=[],vs=p(fs,gs,_s,!1,null,null,null,null);const ys=vs.exports;const Cs={components:{NavBar:Xt,RecordList:ss,RecordEditor:$e,Loading:Ce,LocaleList:Ft,RecordTable:ys},mixins:[M],data(){return{config:!1,locale:"enUS",resourceList:[],selectedResource:null,localeList:[],recordList:[],notification:{},toolbarTitle:!1,selectedResourceGroup:null,selectedRecord:null,selectedPlugin:null,LoadingService:ie,TranslateService:h,user:null,multiselect:!1,multiselectItems:[]}},computed:{pluginList(){return a.filter(window.plugins,e=>a.isUndefined(e.allowed)?!0:a.isEmpty(this.user)?!1:a.includes(e.allowed,this.user.group))}},watch:{$route:function(){this.$route.query.id!=null&&this.selectResource(a.find(a.union(this.pluginList,this.resourceList),{title:this.$route.query.id}))}},destroyed(){ee.events.off("notification",this.onGetNotification)},mounted(){this.$loading.start("init"),F.onLogout(()=>{console.info("User logged out"),window.location.reload()}),ee.events.on("notification",this.onGetNotification),this.$nextTick(async()=>{if(await V.init(),this.config=V.config,await h.init(),this.setToolbarTitle(),a.get(window,"noLogin",!1))this.user={};else{F.init();try{this.user=await F.getStatus();const e=a.get(this.user,"theme","light")==="dark";this.$vuetify.theme.dark=e,this.$forceUpdate()}catch(e){const t=a.get(e,"response.data.message",e.message);throw this.notify(t,"error"),e}}try{const e=await $.get(`${window.location.pathname}resources`);this.$loading.stop("init");const t=a.sortBy(e.data,i=>i.title);if(this.resourceList=a.filter(t,i=>a.isUndefined(i.allowed)?!0:a.includes(i.allowed,this.user.group)),E.setSchemas(this.resourceList),this.localeList=h.config.locales,this.$route.query.id!=null){const i=a.find(a.union(this.pluginList,this.resourceList),{title:this.$route.query.id});this.selectResource(i)}}catch(e){console.error("Error while getting resources: ",e)}})},methods:{setToolbarTitle(){this.toolbarTitle=a.get(V.config,`toolbarTitle.${h.locale}`,a.get(V.config,"toolbarTitle",!1))},onGetNotification(s){this.notification=s},getNotificationClass(){return`notification-${this.notification.type}`},getThemeClass(){const s={};return a.set(s,`theme--${a.get(this.user,"theme","light")}`,!0),s},async selectResourceGroup(s){this.selectedResourceGroup=s},async selectResource(s){try{if(a.get(this.$router,"history.current.query.id",!1)!==s.title&&this.$router.push({query:{id:s.title}}).catch(t=>console.error("Router throw an error:",t)),s.type==="plugin"){this.selectedResource=null,this.selectedPlugin=s;return}if(this.onCancelMultiselectPage(),this.selectedResource=s,this.selectedPlugin=null,this.recordList=null,this.selectedRecord=null,!this.selectedResource)return;this.locale=a.first(this.selectedResource.locales),this.$loading.start("selectResource"),await this.cacheRelatedResources(s);const e=E.get(s.title);if(this.recordList=a.sortBy(e,t=>-t._updatedAt),a.get(s,"maxCount",0)===1){const t=a.get(this.recordList,"[0]",!1);t?this.selectRecord(t):this.selectRecord({_local:!0})}this.$loading.stop("selectResource")}catch(e){console.error("Error happen during selectResource:",e)}},async cacheRelatedResources(s){let e=a.union([s.title],a.values(s.extraSources));const t=i=>{a.isArray(i)?a.each(i,r=>{t(r)}):a.each(i,(r,n)=>{switch(n){case"input":{const l=a.get(i,"options.extraSources");switch(e.push(...a.values(l)),r){case"select":case"multiselect":const o=a.get(i,"source");if(a.isString(o)){e.push(o);const c=E.getSchema(o);e.push(...a.values(c.extraSources))}break;case"paragraph":a.each(a.get(i,"options.types"),c=>{t(c);const d=a.get(c,"schema");t(d)})}break}case"extraSources":e.push(...a.values(r))}})};t(s.schema),e=a.uniq(e),await B(a.map(e,i=>async()=>await E.cache(i)),{concurrency:10})},selectRecord(s){this.selectedRecord=s},onSelectMultiselect(s){this.multiselect=s,s&&this.unsetSelectedRecord()},onChangeMultiselectItems(s){this.multiselectItems=a.clone(s)},async updateRecordList(s){try{this.$loading.start("updateRecordList");const e=await E.cache(this.selectedResource.title);this.$loading.stop("updateRecordList"),this.recordList=a.sortBy(e,t=>-t._updatedAt),this.selectRecord(a.find(this.recordList,{_id:a.get(s,"_id")}))}catch(e){console.error("Error happen during updateRecordList:",e)}},unsetSelectedRecord(){this.selectedRecord=null},onCancelMultiselectPage(){this.multiselect=!1,this.multiselectItems=[]}}};var bs=function(){var e=this,t=e._self._c;return t(_e,[t(Ae,[e.notification.type?t(Ne,{staticClass:"notification",class:e.getNotificationClass(),attrs:{"multi-line":"",top:"",centered:"",timeout:e.notification.type==="error"?-1:1e3},scopedSlots:e._u([{key:"action",fn:function({attrs:i}){return[e.notification.type==="error"?t(v,e._b({attrs:{text:""},on:{click:function(r){e.notification={}}}},"v-btn",i,!1),[e._v(" "+e._s(e._f("translate")("TL_CLOSE"))+" ")]):e._e()]}}],null,!1,3083842718),model:{value:e.notification,callback:function(i){e.notification=i},expression:"notification"}},[t("p",[e._v(e._s(e.notification.message))])]):e._e()],1),e.user?t("div",{staticClass:"cms-layout"},[t("div",{staticClass:"cms-inner-layout",class:e.getThemeClass()},[e.resourceList.length>0?t("nav-bar",{attrs:{config:e.config,"toolbar-title":e.toolbarTitle,"locale-class":{locale:e.localeList&&e.localeList.length>1},"select-resource-group-callback":e.selectResourceGroup,"select-resource-callback":e.selectResource,"resource-list":e.resourceList,plugins:e.pluginList,"selected-resource-group":e.selectedResourceGroup,"selected-item":e.selectedResource||e.selectedPlugin}}):e._e(),t("div",{staticClass:"resources"},[e.localeList?t("locale-list",{attrs:{"locale-list":e.localeList}}):e._e()],1),t("div",{staticClass:"records"},[e.selectedResource&&(!e.selectedResource.view||e.selectedResource.view=="list")?[e.selectedResource?t("record-list",{attrs:{list:e.recordList,locale:e.locale,"selected-item":e.selectedRecord,resource:e.selectedResource,multiselect:e.multiselect,"multiselect-items":e.multiselectItems},on:{selectItem:e.selectRecord,changeMultiselectItems:e.onChangeMultiselectItems,selectMultiselect:e.onSelectMultiselect}}):e._e(),e.selectedRecord?t("record-editor",{key:e.selectedRecord._id,attrs:{"resource-list":e.resourceList,record:e.selectedRecord,resource:e.selectedResource,locale:e.locale,"user-locale":e.TranslateService.locale},on:{"update:record":function(i){e.selectedRecord=i},"update:locale":function(i){e.locale=i},updateRecordList:e.updateRecordList}}):e._e()]:e._e(),e.selectedResource&&e.selectedResource.view=="table"?t("record-table",{attrs:{"record-list":e.recordList,"resource-list":e.resourceList,resource:e.selectedResource,record:e.selectedRecord,locale:e.locale,"user-locale":e.TranslateService.locale},on:{"update:record":function(i){e.selectedRecord=i},"update:locale":function(i){e.locale=i},unsetRecord:e.unsetSelectedRecord,updateRecordList:e.updateRecordList}}):e._e(),e.selectedPlugin?t("plugin-page",{attrs:{plugin:e.selectedPlugin}}):e._e(),e.selectedResource&&e.multiselect?t("multiselect-page",{attrs:{"multiselect-items":e.multiselectItems,locale:e.locale,resource:e.selectedResource,"record-list":e.recordList},on:{cancel:e.onCancelMultiselectPage,changeMultiselectItems:e.onChangeMultiselectItems,updateRecordList:e.updateRecordList}}):e._e()],2),e.LoadingService.isShow?t("loading"):e._e()],1)]):e._e()],1)},ws=[],$s=p(Cs,bs,ws,!1,null,null,null,null);const Ss=$s.exports;const Ls={components:{Loading:Ce},mixins:[M],data(){return{username:null,password:null,activeField:!1,loginFailed:!1,loggingIn:!1,showLoginForm:!1,loaded:!1,LoadingService:ie,TranslateService:h}},async mounted(){console.warn("Login page mounted"),this.$loading.start("init");try{a.get(window,"noLogin",!1)||F.init(),await V.init(),await h.init(),this.loaded=!0}catch(s){console.error("Error happen during mounted:",s)}this.loaded=!0,this.$nextTick(()=>{setTimeout(()=>{this.showLoginForm=!0},100)}),this.$loading.stop("init")},methods:{async login(){if(!this.loggingIn){if(!this.username)return this.$refs.username.focus();if(!this.password)return this.$refs.password.focus();this.$loading.start("login"),this.loggingIn=!0;try{await $.post(`${window.location.pathname}login`,{username:this.username,password:this.password}),this.$loading.stop("login"),window.location.reload()}catch(s){console.error("Error happen during login:",s),this.loginFailed=!0,this.$loading.stop("login")}this.loggingIn=!1}}}};var Ts=function(){var e=this,t=e._self._c;return t(_e,[e.loaded?t("div",{staticClass:"cms-layout",class:{displayed:e.showLoginForm}},[t("div",{staticClass:"login-canvas"},[t("form",{on:{submit:function(i){return i.preventDefault(),e.login.apply(null,arguments)}}},[t("div",{staticClass:"node-cms-title"},[e._v(" "+e._s(e._f("translate")("TL_LOGIN"))+" ")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],ref:"username",attrs:{autofocus:"",type:"test",name:"nodeCmsUsername",autocomplete:"on",placeholder:e._f("translate")("TL_USERNAME")},domProps:{value:e.username},on:{input:function(i){i.target.composing||(e.username=i.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],ref:"password",attrs:{type:"password",name:"nodeCmsPassword",autocomplete:"on",placeholder:e._f("translate")("TL_PASSWORD")},domProps:{value:e.password},on:{input:function(i){i.target.composing||(e.password=i.target.value)}}}),e.loginFailed?t("span",{staticClass:"error-message"},[e._v(e._s(e._f("translate")("TL_LOGIN_FAIL")))]):e._e(),t("div",{staticClass:"login-btn-wrapper",class:{disabled:!e.username||!e.password||e.loggingIn}},[t("button",{attrs:{disabled:e.loggingIn}},[e._v(" "+e._s(e._f("translate")("TL_CONFIRM"))+" ")])])])])]):e._e(),e.LoadingService.isShow?t("loading"):e._e()],1)},Rs=[],Es=p(Ls,Ts,Rs,!1,null,"d22c9055",null,null);const Is=Es.exports;const xs={mixins:[be,ae,M],props:{resource:{type:Object,default:()=>{}},locale:{type:String,default:"enUS"},multiselectItems:{type:Array,default:()=>[]},recordList:{type:Array,default:()=>[]}},data(){return{size:a.size,isEmpty:a.isEmpty}},methods:{onClickCancel(){this.$emit("cancel")},onClickSelectAll(){this.$emit("changeMultiselectItems",this.recordList)},onClickDeselectAll(){this.$emit("changeMultiselectItems",[])},async onClickDelete(){if(window.confirm(h.get("TL_ARE_YOU_SURE_TO_DELETE_RECORDS",null,{num:a.size(this.multiselectItems)}),h.get("TL_YES"),h.get("TL_NO"))){this.$loading.start("onDeleteMultiselectedItems");try{await B(a.map(this.multiselectItems,s=>async()=>{try{await b.delete(`../api/${this.resource.title}/${s._id}`),this.notify(h.get("TL_RECORD_DELETED",null,{id:s._id}))}catch(e){console.error(e),this.manageError(e,"delete",s)}}),{concurrency:1})}catch(s){console.error(s)}this.multiselect=!1,this.$loading.stop("onDeleteMultiselectedItems"),this.$emit("updateRecordList",null),this.$emit("cancel")}}}};var ks=function(){var e=this,t=e._self._c;return t("div",{staticClass:"multiselect-page"},[t("h3",[e._v(e._s(e._f("translate")("TL_YOU_HAVE_SELECTED_NUM_ITEMS",null,{num:e.size(e.multiselectItems)})))]),t("ul",e._l(e.multiselectItems,function(i){return t("li",{key:i._id},[e._v(" "+e._s(e.getName(i))+" ("+e._s(i._id)+") ")])}),0),t("br"),t("div",{staticClass:"actions"},[t(v,{on:{click:e.onClickSelectAll}},[e._v(e._s(e._f("translate")("TL_SELECT_ALL_ITEMS")))]),t(v,{attrs:{disabled:e.multiselectItems.length===0},on:{click:e.onClickDeselectAll}},[e._v(e._s(e._f("translate")("TL_DESELECT_ALL_ITEMS")))])],1),t("div",{staticClass:"buttons"},[t(v,{staticClass:"back",on:{click:e.onClickCancel}},[e._v(e._s(e._f("translate")("TL_CANCEL")))]),t(v,{staticClass:"delete right",attrs:{disabled:e.isEmpty(e.multiselectItems)},on:{click:e.onClickDelete}},[e._v(e._s(e._f("translate")("TL_DELETE")))])],1)])},Ds=[],Os=p(xs,ks,Ds,!1,null,"55ec3ee9",null,null);const Ms=Os.exports,Fs={props:["schema","model","row","formOptions","disabled"],created(){a.each(this.schema.fields,s=>{const e=this.getFieldType(s);e in Vue.options.components||console.error(`${e} isn't defined as a custom field type, will not render it`)})},methods:{getFieldType(s){return a.get(s,"overrideType",a.get(s,"type",!1))},onInput(s,e){a.isUndefined(e)&&(e=a.get(a.first(s),"parentKey",!1)),this.$emit("input",s,e)}}};var As=function(){var e=this,t=e._self._c;return e.schema!=null?t("div",{staticClass:"vue-form-generator"},[e.schema.fields?t("fieldset",e._l(e.schema.fields,function(i){return t("div",{key:i.model,staticClass:"field-wrapper"},[t(e.getFieldType(i),{key:i.model,tag:"component",attrs:{schema:i,model:e.model,"form-options":e.formOptions,disabled:e.disabled},on:{input:e.onInput}})],1)}),0):e._e()]):e._e()},Ns=[],Vs=p(Fs,As,Ns,!1,null,null,null,null);const Us=Vs.exports,Ps={props:["plugin"],data(){return{}},watch:{},mounted(){},methods:{}};var Bs=function(){var e=this,t=e._self._c;return t("div",{staticClass:"plugin-page"},[t(e.plugin.component,{tag:"component"})],1)},qs=[],js=p(Ps,Bs,qs,!1,null,null,null,null);const Hs=js.exports;const zs={data(){return{timer:null,isLoading:!0,sysLog:[],error:!1,scrollBottom:!0,data:"",stickyId:-1,count:0,destroyed:!1,autoscroll:!0,lastId:-1,tempId:0,logLines:[],filterOutLines:[],searchKey:null,warningQty:0,errorQty:0,ignoreNextScrollEvent:!1,fakeData:[],config:null}},async mounted(){const{data:s}=await b.get(`${window.location.pathname}../api/_syslog/config`);this.config=s,this.config.wss&&A.events.on("syslog",e=>{a.isEmpty(e)||(this.error=!1,this.logLines.push(...e),this.lastId=a.last(this.logLines).id,this.updateSysLog()),this.autoscroll&&(this.ignoreNextScrollEvent=!0,this.$refs.scroller.scrollToBottom())}),this.$nextTick(()=>{this.refreshLog(),this.$refs.scroller&&this.$refs.scroller.$el.addEventListener("scroll",this.detectScroll)})},async destroyed(){this.destroyed=!0,this.$refs.scroller&&this.$refs.scroller.$el.removeEventListener("scroll",this.detectScroll),clearTimeout(this.timer)},methods:{filterLevel(s){this.searchKey=`sift:{level: {$gte: ${s}}}`,this.updateSysLog()},detectScroll(s){const e=a.get(s,"srcElement.scrollHeight",0),t=a.get(s,"srcElement.scrollTop",0),i=a.get(s,"srcElement.clientHeight",0);if(this.ignoreNextScrollEvent){this.ignoreNextScrollEvent=!1;return}this.$nextTick(()=>{this.autoscroll===!1&&t+i>=e&&(this.stickyId=-1),this.autoscroll=t+i>=e})},getLogViewerHeight(){return a.get(this.$refs["log-viewer"],"offsetHeight",100)},onInputSearch(){this.updateSysLog()},onClickRefresh(){this.error=!1,this.searchKey=null,this.logLines=[],this.sysLog=[],this.updateSysLog(),this.lastId=-1},onClickClearSearch(){this.searchKey=null,this.updateSysLog()},onClickAutoscroll(){this.autoscroll=!this.autoscroll},onClickClear(){this.searchKey=null,this.logLines=[],this.sysLog=[],this.updateSysLog()},calculateLineNumberSpacing(s){return a.padStart(s,8,"0")+" |"},jumpTo(s){if(!(!this.searchKey&&this.stickyId!==s)){if(this.stickyId===s){this.stickyId=-1,this.autoscroll=!0;return}this.ignoreNextScrollEvent=!0,this.autoscroll=!1,this.onClickClearSearch(),this.$nextTick(()=>{document.querySelector(`[data-line-id='${s}'][data-is-active='true']`)||this.$refs.scroller.scrollToItem(a.findIndex(this.logLines,t=>t.id===s)-14),this.stickyId=s})}},async refreshLog(){try{if(this.config.wss)A.client&&(A.send({action:"syslog",id:this.lastId}),this.isLoading=!1,this.error=!1);else{const s=await b.get(`${window.location.pathname}../api/_syslog`,{params:{id:this.lastId}});this.isLoading=!1,this.error=!1,a.isEmpty(s.data)||(this.error=!1,this.logLines.push(...s.data),this.lastId=a.last(this.logLines).id,this.updateSysLog()),this.autoscroll&&(this.ignoreNextScrollEvent=!0,this.$refs.scroller.scrollToBottom())}}catch(s){console.error(s),this.error=!0}this.destroyed||(this.timer=setTimeout(this.refreshLog,this.error?2e3:200))},updateSysLog(){let s=a.uniqBy(this.logLines,"id");const e=a.groupBy(this.logLines,"level");if(this.warningQty=a.get(e,"[1].length",0),this.errorQty=a.get(e,"[2].length",0),!a.isEmpty(this.searchKey))if(this.searchKey.search("sift:")===0)try{const t=ge.parse(this.searchKey.substr(5));s=s.filter(fe(t))}catch{}else s=a.filter(s,t=>a.includes(a.toLower(t.line),a.toLower(this.searchKey)));this.sysLog=s,this.filterOutLines=a.get(this.logLines,"length",0)-a.get(this.sysLog,"length",0)}}};var Ks=function(){var e=this,t=e._self._c;return t("div",{staticClass:"syslog"},[t("div",{staticClass:"buttons"},[t("button",{staticClass:"item autoscroll",class:{active:e.autoscroll},on:{click:e.onClickAutoscroll}},[e.autoscroll?t(f,[e._v("mdi-lock-outline")]):t(f,[e._v("mdi-unlock")])],1),t("button",{staticClass:"item clear",on:{click:e.onClickClear}},[t(f,[e._v("mdi-trash-can-outline")])],1),t("button",{staticClass:"item refresh",on:{click:e.onClickRefresh}},[t(f,[e._v("mdi-refresh")])],1),t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchKey,expression:"searchKey"}],staticClass:"item search",class:{"is-sift":e.searchKey&&e.searchKey.search("sift:")===0},attrs:{placeholder:e._f("translate")("TL_SEARCH")},domProps:{value:e.searchKey},on:{input:[function(i){i.target.composing||(e.searchKey=i.target.value)},e.onInputSearch]}}),e.searchKey&&e.searchKey.length>0?t("button",{staticClass:"item clear-search",on:{click:e.onClickClearSearch}},[t(f,[e._v("mdi-close")])],1):e._e(),e.filterOutLines>0?t("div",{staticClass:"item filter-out"},[t(f,[e._v("mdi-target")]),e._v(e._s(e.filterOutLines)+" lines are filter out")],1):e._e(),t("div",{staticClass:"item logs-raised-flags"},[e.warningQty>=0?t("span",{staticClass:"flag-item flag-warning",on:{click:function(i){return e.filterLevel(1)}}},[t(f,[e._v("mdi-flag-outline")]),e._v(" "+e._s(e.warningQty))],1):e._e(),e.errorQty>=0?t("span",{staticClass:"flag-item flag-error",on:{click:function(i){return e.filterLevel(2)}}},[t(f,[e._v("mdi-alert-box-outline")]),e._v(" "+e._s(e.errorQty))],1):e._e()])]),e.error?t("div",{staticClass:"error"},[e._v(" "+e._s(e._f("translate")("TL_ERROR_RETRIEVE_SYSLOG"))+" ")]):e._e(),t("div",{ref:"log-viewer",staticClass:"log-viewer-wrapper"},[t("DynamicScroller",{ref:"scroller",staticClass:"scroller",attrs:{items:e.sysLog,"min-item-size":14},scopedSlots:e._u([{key:"default",fn:function({item:i,index:r,active:n}){return[t("DynamicScrollerItem",{attrs:{item:i,active:n,"size-dependencies":[e.calculateLineNumberSpacing(i.id),i.line],"data-index":r}},[t("div",{staticClass:"line-wrapper",attrs:{"data-line-id":i.id,"data-is-active":n}},[t("div",{staticClass:"line-number",class:{stickId:e.stickyId===i.id,search:e.searchKey},on:{click:function(l){return e.jumpTo(i.id)}}},[e._v(e._s(i.id))]),t("div",{staticClass:"line-content",domProps:{innerHTML:e._s(i.html)}})])])]}}])})],1)])},Gs=[],Ys=p(zs,Ks,Gs,!1,null,"e330bd3e",null,null);const Ws=Ys.exports;const Qs={data(){return{config:null,status:null,error:null,type:0,loading:!1,uploadedXlsx:null}},async mounted(){const s=await b("./config");this.config=s.data.import},methods:{async onChangeXlsxFile(s){this.uploadedXlsx=null;const e=a.first(s.target.files);e&&(this.uploadedXlsx=e)},openFile(){window.open(`https://docs.google.com/spreadsheets/d/${this.config.gsheetId}/edit`,"_blank").focus()},async checkStatus(){this.loading=!0,this.status=null,this.error=null,this.$loading.start("cms-import"),this.type=0,this.$nextTick(async()=>{try{const s=await b("../import/status");this.status=s.data}catch(s){this.status=null,this.error=a.get(s,"message",s)}this.$loading.stop("cms-import"),this.loading=!1})},async execute(){this.loading=!0,this.status=null,this.error=null,this.type=1,this.$loading.start("cms-import"),this.$nextTick(async()=>{try{const s=await b("../import/execute");this.status=s.data}catch(s){this.status=null,this.error=a.get(s,"message",s)}this.$loading.stop("cms-import"),this.loading=!1})},async checkXlsxStatus(){this.loading=!0,this.status=null,this.error=null,this.$loading.start("xlsx-import"),this.type=0,this.$nextTick(async()=>{try{const s=new FormData;s.append("xlsx",this.uploadedXlsx);const e=await b.post("../import/statusXlsx",s);this.status=e.data}catch(s){this.status=null,this.error=a.get(s,"message",s)}this.$loading.stop("xlsx-import"),this.loading=!1})},async executeXlsx(){this.loading=!0,this.status=null,this.error=null,this.type=1,this.$loading.start("xlsx-import"),this.$nextTick(async()=>{try{const s=new FormData;s.append("xlsx",this.uploadedXlsx);const e=await b.post("../import/executeXlsx",s);this.status=e.data}catch(s){this.status=null,this.error=a.get(s,"message",s)}this.$loading.stop("xlsx-import"),this.loading=!1})}}};var Xs=function(){var e=this,t=e._self._c;return t("div",{staticClass:"cms-import"},[t("h3",[e._v("Cms Import")]),t("div",{staticClass:"main-container"},[t("div",{staticClass:"config-resources"},[t("h4",[e._v("Resources")]),e.config&&e.config.resources?t(Ve,{attrs:{column:""}},e._l(e.config.resources,function(i,r){return t(N,{key:r,attrs:{ripple:!1}},[e._v(" "+e._s(i)+" ")])}),1):e._e()],1),t("hr"),t("h4",[e._v("Actions")]),t("div",[t(v,{attrs:{dense:""},on:{click:function(i){return e.openFile()}}},[e._v("Edit Google Sheet")]),t("div",{staticClass:"other-actions"},[t(v,{attrs:{dense:"",disabled:e.loading},on:{click:function(i){return e.checkStatus()}}},[e._v("Check Difference")]),t(v,{attrs:{dense:"",disabled:e.loading},on:{click:function(i){return e.execute()}}},[e._v("Import from Remote")])],1)],1),t("hr"),t("h4",[e._v("Upload Xlsx")]),t(z,{ref:"xlsxFile",attrs:{dense:"","hide-details":"",outlined:"",type:"file"},on:{change:e.onChangeXlsxFile}}),t("div",{staticClass:"other-actions"},[t(v,{attrs:{dense:"",disabled:e.loading||!e.uploadedXlsx},on:{click:function(i){return e.checkXlsxStatus()}}},[e._v("Check Difference")]),t(v,{attrs:{dense:"",disabled:e.loading||!e.uploadedXlsx},on:{click:function(i){return e.executeXlsx()}}},[e._v("Import from Remote")])],1),e.status||e.error?t("div",[e.type==0?t("h4",[e._v("Difference:")]):t("h4",[e._v("Status:")]),t("pre",{domProps:{innerHTML:e._s(e.status)}}),e._v(" "),t("pre",{domProps:{innerHTML:e._s(e.error)}})]):e._e()],1)])},Zs=[],Js=p(Qs,Xs,Zs,!1,null,"84588550",null,null);const ei=Js.exports;const ti={data(){return{statusInterval:null,error:null,config:null,selectedResource:null,recordData:{},reportData:{},syncStatus:{},uniqueKeyMap:{},environments:["local","remote"],syncingEnvironment:null,isEmpty:a.isEmpty,get:a.get,includes:a.includes}},destroyed(){this.statusInterval&&clearInterval(this.statusInterval)},async mounted(){let s;s=await b.get(`${window.location.pathname}resources`),a.each(s.data,e=>{let t=a.find(e.schema,{unique:!0});t&&(this.uniqueKeyMap[e.title]=t.field)}),s=await b.get(`${window.location.pathname}/config`),this.config=s.data,this.selectedResource&&this.update(),this.statusInterval=setInterval(async()=>{if(this.selectedResource){try{await B(a.map(["local","remote"],t=>async()=>{try{const i=await b.get(`${window.location.pathname}/sync/${t}/${this.selectedResource}/status`);this.syncStatus[t]=i.data,this.syncStatus=a.clone(this.syncStatus)}catch(i){console.error(i)}}))}catch{}const e=a.find(this.syncStatus,{status:"syncing"});!e&&this.syncingEnvironment&&(this.$loading.stop("deploy-resource"),e&&e.status==="error"&&(this.error=e.error),this.syncingEnvironment=!1,this.update())}},5*1e3)},methods:{onChangeResource(){this.update()},async update(){this.$loading.start("loading-resource");try{const s=this.uniqueKeyMap[this.selectedResource];this.recordData={},this.reportData={},await B(a.map(this.environments,l=>async()=>{try{let o;o=await b.get(`${window.location.pathname}sync/${l}/${this.selectedResource}`),a.set(this.recordData,l,o.data),o=await b.get(`${window.location.pathname}sync/${l}/${this.selectedResource}/status`),a.set(this.syncStatus,l,o.data),this.syncStatus=a.clone(this.syncStatus)}catch(o){console.error(o)}}),{concurrency:1}),this.recordData=a.clone(this.recordData);const e=this.recordData.local,t=this.recordData.remote,i=a.map(e,l=>l[s]),r=a.map(t,l=>l[s]);let n=a.intersection(i,r);n=a.filter(n,l=>{let o=a.find(e,d=>d[s]===l),c=a.find(t,d=>d[s]===l);return o._attachments=a.map(o._attachments,d=>a.omit(d,["url"])),c._attachments=a.map(c._attachments,d=>a.omit(d,["url"])),!a.isEqual(o,c)}),a.isEmpty(n)||a.each(n,l=>{console.log(l,"local",a.find(e,{[s]:l}),"remote",a.find(t,{[s]:l}))}),this.reportData={create:a.difference(i,r).length,remove:a.difference(r,i).length,update:n.length}}catch(s){console.error(s)}this.$loading.stop("loading-resource")},async onClickDeploy(s,e){this.error=null,this.$loading.start("deploy-resource"),this.syncingEnvironment=!0;try{await b.post(`../sync/${this.selectedResource}/from/${s}/to/${e}`),a.set(this.syncStatus,`${e}.status`,"syncing"),this.syncStatus=a.clone(this.syncStatus)}catch(t){console.error(t),this.syncingEnvironment=!1,this.$loading.stop("deploy-resource")}}}};var si=function(){var e=this,t=e._self._c;return t("div",{staticClass:"sync-resources main"},[t("h1",[e._v("Sync Resources")]),e.config?t("div",[t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedResource,expression:"selectedResource"}],on:{change:[function(i){var r=Array.prototype.filter.call(i.target.options,function(n){return n.selected}).map(function(n){var l="_value"in n?n._value:n.value;return l});e.selectedResource=i.target.multiple?r:r[0]},e.onChangeResource]}},e._l(e.config.sync.resources,function(i){return t("option",{key:i,domProps:{value:i}},[e._v(e._s(i))])}),0),e.isEmpty(e.recordData)?e._e():t("div",{staticClass:"num-records"},[t("span",[e._v("number of records")]),t("div",{staticClass:"num-records-wrapper"},e._l(e.environments,function(i){return t("div",{key:i,staticClass:"num-record",attrs:{num:e.environments.length}},[t("span",[e._v(e._s(i))]),t("span",[e._v(e._s(e.get(e.recordData,`${i}.length`,"N/A")))])])}),0)]),e.isEmpty(e.reportData)?e._e():t("div",{staticClass:"num-records"},[t("span",[e._v("records difference")]),t("div",{staticClass:"num-records-wrapper"},[t("div",{staticClass:"num-record",attrs:{num:"1",set:e.enabled=e.get(e.recordData,"local.length")!==void 0&&e.get(e.recordData,"remote.length")!==void 0}},[e.enabled?[e.get(e.syncStatus,"local.status")!=="syncing"&&e.get(e.syncStatus,"remote.status")!=="syncing"?[t("span",[e._v("local / remote")]),t("span",[e._v("create: "+e._s(e.reportData.create))]),t("span",[e._v("update: "+e._s(e.reportData.update))]),t("span",[e._v("remove: "+e._s(e.reportData.remove))]),e.includes(e.get(e.syncStatus,"remote.allows"),"write")?t("span",[t("button",{on:{click:function(i){return e.onClickDeploy("local","remote")}}},[e._v("push to remote")])]):e._e(),e.includes(e.get(e.syncStatus,"local.allows"),"write")?t("span",[t("button",{on:{click:function(i){return e.onClickDeploy("remote","local")}}},[e._v("pull from remote")])]):e._e()]:e._e(),e.get(e.syncStatus,"local.status")==="syncing"?[t("span",[e._v("resource: "+e._s(e.get(e.syncStatus,"local.resource")))]),t("span",[e._v("created: "+e._s(e.get(e.syncStatus,"local.created"))+" / "+e._s(e.get(e.syncStatus,"local.createTotal")))]),t("span",[e._v("updated: "+e._s(e.get(e.syncStatus,"local.updated"))+" / "+e._s(e.get(e.syncStatus,"local.updateTotal")))]),t("span",[e._v("removed: "+e._s(e.get(e.syncStatus,"local.removed"))+" / "+e._s(e.get(e.syncStatus,"local.removeTotal")))])]:e._e(),e.get(e.syncStatus,"remote.status")==="syncing"?[t("span",[e._v("resource: "+e._s(e.get(e.syncStatus,"remote.resource")))]),t("span",[e._v("created: "+e._s(e.get(e.syncStatus,"remote.created"))+" / "+e._s(e.get(e.syncStatus,"remote.createTotal")))]),t("span",[e._v("updated: "+e._s(e.get(e.syncStatus,"remote.updated"))+" / "+e._s(e.get(e.syncStatus,"remote.updateTotal")))]),t("span",[e._v("removed: "+e._s(e.get(e.syncStatus,"remote.removed"))+" / "+e._s(e.get(e.syncStatus,"remote.removeTotal")))])]:e._e()]:e._e(),e.enabled?e._e():t("span",{staticClass:"na-field"},[e._v(" N/A ")])],2)])])]):e._e(),e.error?t("div",{staticClass:"error"},[e._v(" Error: "+e._s(e.error)+" ")]):e._e()])},ii=[],ai=p(ti,si,ii,!1,null,"90250774",null,null);const ri=ai.exports;let w={fieldIsRequired:"This field is required!",invalidFormat:"Invalid format!",numberTooSmall:"The number is too small! Minimum: {0}",numberTooBig:"The number is too big! Maximum: {0}",invalidNumber:"Invalid number",invalidInteger:"The value is not an integer",textTooSmall:"The length of text is too small! Current: {0}, Minimum: {1}",textTooBig:"The length of text is too big! Current: {0}, Maximum: {1}",thisNotText:"This is not a text!",thisNotArray:"This is not an array!",selectMinItems:"Select minimum {0} items!",selectMaxItems:"Select maximum {0} items!",invalidDate:"Invalid date!",dateIsEarly:"The date is too early! Current: {0}, Minimum: {1}",dateIsLate:"The date is too late! Current: {0}, Maximum: {1}",invalidEmail:"Invalid e-mail address!",invalidURL:"Invalid URL!",invalidCard:"Invalid card format!",invalidCardNumber:"Invalid card number!",invalidTextContainNumber:"Invalid text! Cannot contains numbers or special characters",invalidTextContainSpec:"Invalid text! Cannot contains special characters"};function T(s,e,t=w){return!u.isNil(s)&&s!==""?null:e?[y(t.fieldIsRequired)]:[]}function y(s){if(s!=null&&arguments.length>1)for(let e=1;e<arguments.length;e++)s=s.replace("{"+(e-1)+"}",arguments[e]);return s}const j={resources:w,required(s,e,t,i=w){return T(s,e.required,i)},number(s,e,t,i=w){let r=T(s,e.required,i);if(r!=null)return r;let n=[];return u.isFinite(s)?(!u.isNil(e.min)&&s<e.min&&n.push(y(i.numberTooSmall,e.min)),!u.isNil(e.max)&&s>e.max&&n.push(y(i.numberTooBig,e.max))):n.push(y(i.invalidNumber)),n},integer(s,e,t,i=w){let r=T(s,e.required,i);if(r!=null)return r;let n=j.number(s,e,t,i);return u.isInteger(s)||n.push(y(i.invalidInteger)),n},double(s,e,t,i=w){let r=T(s,e.required,i);if(r!=null)return r;if(!u.isNumber(s)||isNaN(s))return[y(i.invalidNumber)]},string(s,e,t,i=w){let r=T(s,e.required,i);if(r!=null)return r;let n=[];return u.isString(s)?(!u.isNil(e.min)&&s.length<e.min&&n.push(y(i.textTooSmall,s.length,e.min)),!u.isNil(e.max)&&s.length>e.max&&n.push(y(i.textTooBig,s.length,e.max))):n.push(y(i.thisNotText)),n},array(s,e,t,i=w){if(e.required){if(!u.isArray(s))return[y(i.thisNotArray)];if(s.length===0)return[y(i.fieldIsRequired)]}if(!u.isNil(s)){if(!u.isNil(e.min)&&s.length<e.min)return[y(i.selectMinItems,e.min)];if(!u.isNil(e.max)&&s.length>e.max)return[y(i.selectMaxItems,e.max)]}},date(s,e,t,i=w){let r=T(s,e.required,i);if(r!=null)return r;let n=new Date(s);if(isNaN(n.getDate()))return[y(i.invalidDate)];let l=[];if(!u.isNil(e.min)){let o=new Date(e.min);n.valueOf()<o.valueOf()&&l.push(y(i.dateIsEarly,D.format(n),D.format(o)))}if(!u.isNil(e.max)){let o=new Date(e.max);n.valueOf()>o.valueOf()&&l.push(y(i.dateIsLate,D.format(n),D.format(o)))}return l},regexp(s,e,t,i=w){let r=T(s,e.required,i);if(r!=null)return r;if(!u.isNil(e.pattern)&&!new RegExp(e.pattern).test(s))return[y(i.invalidFormat)]},email(s,e,t,i=w){let r=T(s,e.required,i);if(r!=null)return r;if(!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(s))return[y(i.invalidEmail)]},url(s,e,t,i=w){let r=T(s,e.required,i);if(r!=null)return r;if(!/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,4}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g.test(s))return[y(i.invalidURL)]},creditCard(s,e,t,i=w){let r=T(s,e.required,i);if(r!=null)return r;const n=/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,l=s.replace(/[^0-9]+/g,"");if(!n.test(l))return[y(i.invalidCard)];let o=0,c,d,_;for(let C=l.length-1;C>=0;C--)c=l.substring(C,C+1),d=parseInt(c,10),_?(d*=2,d>=10?o+=d%10+1:o+=d):o+=d,_=!_;if(!(o%10===0&&l))return[y(i.invalidCardNumber)]},alpha(s,e,t,i=w){let r=T(s,e.required,i);if(r!=null)return r;if(!/^[a-zA-Z]*$/.test(s))return[y(i.invalidTextContainNumber)]},alphaNumeric(s,e,t,i=w){let r=T(s,e.required,i);if(r!=null)return r;if(!/^[a-zA-Z0-9]*$/.test(s))return[y(i.invalidTextContainSpec)]}};Object.keys(j).forEach(s=>{const e=j[s];u.isFunction(e)&&(e.locale=t=>(i,r,n)=>e(i,r,n,u.defaults(t,w)))});const ni=(s,e="")=>typeof s.id<"u"?e+s.id:e+(s.inputName||s.label||s.model||"").toString().trim().toLowerCase().replace(/ |_/g,"-").replace(/-{2,}/g,"-").replace(/^-+|-+$/g,"").replace(/([^a-zA-Z0-9-]+)/g,"");function de(s){return u.isString(s)?j[s]!=null?j[s]:(console.warn(`'${s}' is not a validator function!`),null):s}function X(s,e,t){let i=u.get(t.context,"schema.attributes",{}),r=e.value||"input";u.isString(r)&&(i=u.get(i,r)||i),u.forEach(i,(n,l)=>{s.setAttribute(l,n)})}const S={props:["model","schema","formOptions","disabled"],data(){return{errors:[],debouncedValidateFunc:null,debouncedFormatFunc:null}},directives:{attributes:{bind:X,updated:X,componentUpdated:X}},computed:{value:{cache:!1,get(){return u.isFunction(u.get(this.schema,"get"))?this.schema.get(this.model):u.get(this.model,this.schema.model)},set(s){let e=this.value;u.isFunction(s)?s(s,e):this.updateModelValue(s,e)}}},methods:{getOpt(s,e){return u.get(this.schema,`options.${s}`,e)},validate(s){this.clearValidationErrors();let e=u.get(this.formOptions,"validateAsync",!1),t=[];if(this.schema.validator&&this.schema.readonly!==!0&&this.disabled!==!0){let r=[];u.isArray(this.schema.validator)?u.forEach(this.schema.validator,n=>{r.push(de(n).bind(this))}):r.push(de(this.schema.validator).bind(this)),u.forEach(r,n=>{if(e)t.push(n(this.value,this.schema,this.model));else{let l=n(this.value,this.schema,this.model);l&&u.isFunction(l.then)?l.then(o=>{o&&(this.errors=this.errors.concat(o));let c=this.errors.length===0;this.$emit("validated",c,this.errors,this)}):l&&(t=t.concat(l))}})}let i=r=>{let n=[];u.forEach(u.uniq(r),o=>{u.isArray(o)&&o.length>0?n=n.concat(o):u.isString(o)&&n.push(o)}),u.isFunction(this.schema.onValidated)&&this.schema.onValidated.call(this,this.model,n,this.schema);let l=n.length===0;return s||this.$emit("validated",l,n,this),this.errors=n,n};return e?Promise.all(t).then(i):i(t)},debouncedValidate(){u.isFunction(this.debouncedValidateFunc)||(this.debouncedValidateFunc=u.debounce(this.validate.bind(this),u.get(this.schema,"validateDebounceTime",u.get(this.formOptions,"validateDebounceTime",500)))),this.debouncedValidateFunc()},updateModelValue(s,e){let t=!1;u.isFunction(this.schema.set)?(this.schema.set(this.model,s),t=!0):this.schema.model&&(this.setModelValueByPath(this.schema.model,s),t=!0),t&&(u.isFunction(this.schema.onChanged)&&this.schema.onChanged.call(this,this.model,s,e,this.schema),u.get(this.formOptions,"validateAfterChanged",!1)===!0&&(u.get(this.schema,"validateDebounceTime",u.get(this.formOptions,"validateDebounceTime",0))>0?this.debouncedValidate():this.validate()),this.$emit("input",s,this.schema.model))},clearValidationErrors(){this.errors.splice(0)},setModelValueByPath(s,e){let t=s.replace(/\[(\w+)\]/g,".$1");t=t.replace(/^\./,"");let i=this.model;const r=t.split(".");let n=0;const l=r.length;for(;n<l;){let o=r[n];if(n<l-1)i[o]!==void 0||this.$root.$set(i,o,{}),i=i[o];else{this.$root.$set(i,o,e);return}++n}},getKeyLocale(){const s={},e=this.schema.model.split(".");return this.schema.localised&&(s.locale=e.shift()),s.key=e.join("."),s},getFieldID(s,e=!1){const t=u.get(this.formOptions,"fieldIdPrefix","");return ni(s,t)+(e?"-"+u.uniqueId():"")},getFieldClasses(){return u.get(this.schema,"fieldClasses",[])}}},li={mixins:[S],data(){return{options:{maxDepth:0,modifiable:!this.disabled,rootObjectKey:this.schema.model}}},watch:{"schema.model":function(){this.options.rootObjectKey=this.schema.model}},methods:{onChangeData(s){console.warn("onChangeData - ",s),a.set(this.model,a.get(this.schema,"model",!1),s)},get:a.get}};var oi=function(){var e=this,t=e._self._c;return e.schema?t("tree-view",{key:e.schema.model,attrs:{data:e.get(e.model,e.schema.model),options:e.options},on:{"change-data":e.onChangeData}}):e._e()},ci=[],di=p(li,oi,ci,!1,null,null,null,null);const ui=di.exports;const hi={components:{codemirror:Ue.codemirror},mixins:[S],data(){return{isReady:!1,cmOption:{height:"auto",viewportMargin:1/0,tabSize:this.getOpt("tabSize",2),styleActiveLine:this.getOpt("styleActiveLine",!0),lineNumbers:this.getOpt("lineNumbers",!0),line:this.getOpt("line",!0),foldGutter:this.getOpt("foldGutter",!0),styleSelectedText:this.getOpt("styleSelectedText",!0),mode:this.getOpt("mode","javascript"),keyMap:"sublime",matchBrackets:this.getOpt("matchBrackets",!0),showCursorWhenSelecting:this.getOpt("showCursorWhenSelecting",!0),theme:"dracula",extraKeys:{Ctrl:"autocomplete"},hintOptions:{completeSingle:!1}}}},watch:{},mounted(){a.isObject(this.value)&&(this.value=""),a.get(this.cmOption,"mode",!1)==="json"&&(this.cmOption.mode="javascript"),this.isReady=!0},methods:{getStyle(){return a.merge({height:a.get(this.schema,"options.height","auto"),width:a.get(this.schema,"options.width","auto")},a.get(this.schema,"options.css",{}))},onChangeData(s){a.set(this.model,a.get(this.schema,"model",!1),s)}}};var mi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"code-wrapper"},[t("div",{staticClass:"label"},[e._v(e._s(e.schema.label))]),e.isReady?t("codemirror",{style:e.getStyle(),attrs:{options:e.cmOption},on:{input:e.onChangeData},model:{value:e.value,callback:function(i){e.value=i},expression:"value"}}):e._e()],1)},pi=[],fi=p(hi,mi,pi,!1,null,null,null,null);const gi=fi.exports,_i={mixins:[S],props:["locale"],data(){return{acceptedModes:["hexa","rgba","hsla","hex","rgb"],color:"",options:{outputModel:"hexa",hideInputs:!1,hideCanvas:!1,hideSliders:!1,hideModeSwitch:!1}}},watch:{color(){a.set(this.model,this.schema.model,this.color)},"schema.model":function(){this.color=this.getColor()}},created(){const s=a.extend(this.options,this.schema);a.indexOf(this.acceptedModes,s.outputModel)===-1&&(console.warn(`Invalid color mode detected: '${s.outputModel}', will default to hexa`),s.outputModel="hexa"),this.options=s},mounted(){this.color=this.getColor()},methods:{getColor(){return a.get(this.model,this.schema.model)}}};var vi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"wrapper-color"},[e.options.model?t(Pe,{key:e.schema.model+"custom",class:{disabled:e.disabled},attrs:{"dot-size":e.options.dotSize,"hide-canvas":e.options.hideCanvas,"hide-sliders":e.options.hideSliders,"hide-inputs":e.options.hideInputs,"hide-mode-switch":e.options.hideModeSwitch,model:e.options.outputModel},model:{value:e.color,callback:function(i){e.color=i},expression:"color"}}):e._e()],1)},yi=[],Ci=p(_i,vi,yi,!1,null,null,null,null);const bi=Ci.exports,wi={mixins:[S],data(){return{editor:null,originalValue:null}},watch:{"schema.model":function(){const s=a.extend(this.originalValue,a.get(this.model,this.schema.model));this.editor.setValue(s),a.set(this.model,this.schema.model,s)}},mounted(){const s=a.get(this.$refs,"json-editor",!1);this.schema.jsonEditorOptions.title=" ";const e={schema:this.schema.jsonEditorOptions,theme:"cms",iconlib:"foundation3"};this.disabled&&(e.disable_array_delete=!0),Y.JSONEditor.defaults.themes.cms=class extends Y.JSONEditor.AbstractTheme{getRangeInput(i,r,n){return super.getRangeInput(i,r,n)}getGridContainer(){const i=document.createElement("div");return i.className="json-editor-grid-container",i}getGridRow(){const i=document.createElement("div");return i.className="json-editor-grid-row",i}getFormInputLabel(i){const r=super.getFormInputLabel(i);return r.style.display="inline-block",r.style.fontWeight="bold",r.className="json-editor-input-label",r}setGridColumnSize(i,r){i.className=`span${r}`}getSelectInput(i){return super.getSelectInput(i)}getFormInputField(i){return super.getFormInputField(i)}afterInputReady(i){if(!i.controlgroup&&(i.controlgroup=this.closest(i,".control-group"),i.controls=this.closest(i,".controls"),this.closest(i,".compact")&&(i.controlgroup.className=i.controlgroup.className.replace(/control-group/g,"").replace(/[ ]{2,}/g," "),i.controls.className=i.controlgroup.className.replace(/controls/g,"").replace(/[ ]{2,}/g," "),i.style.marginBottom=0),this.queuedInputErrorText)){const r=this.queuedInputErrorText;delete this.queuedInputErrorText,this.addInputError(i,r)}}getIndentedPanel(){return document.createElement("div")}getModal(){const i=document.createElement("div");return i.style.backgroundColor="white",i.style.border="1px solid black",i.style.boxShadow="3px 3px black",i.style.position="absolute",i.style.zIndex="10",i.style.display="none",i.style.width="auto",i}getInfoButton(i){const r=document.createElement("span");r.className="icon-info-sign pull-right",r.style.padding=".25rem",r.style.position="relative",r.style.display="inline-block";const n=document.createElement("span");return n.style["font-family"]="sans-serif",n.style.visibility="hidden",n.style["background-color"]="rgba(50, 50, 50, .75)",n.style.margin="0 .25rem",n.style.color="#FAFAFA",n.style.padding=".5rem 1rem",n.style["border-radius"]=".25rem",n.style.width="25rem",n.style.transform="translateX(-27rem) translateY(-.5rem)",n.style.position="absolute",n.innerText=i,r.onmouseover=function(){n.style.visibility="visible"},r.onmouseleave=function(){n.style.visibility="hidden"},r.appendChild(n),r}getFormInputDescription(i){const r=document.createElement("p");return r.className="help-inline",r.textContent=i,r}getFormControl(i,r,n,l){const o=document.createElement("div");o.className="control-group";const c=document.createElement("div");return c.className="controls",i&&r.getAttribute("type")==="checkbox"?(o.appendChild(c),i.className+=" checkbox",i.appendChild(r),c.appendChild(i),l&&c.appendChild(l),c.style.height="30px"):(i&&(i.className+=" control-label",o.appendChild(i)),l&&c.appendChild(l),c.appendChild(r),o.appendChild(c)),n&&c.appendChild(n),o}getHeaderButtonHolder(){const i=this.getButtonHolder();return i.className+=" btn-groups",i}getButtonHolder(){const i=document.createElement("div");return i.className="btn-group",i}getButton(i,r,n){const l=super.getButton(i,r,n);return l.className+=" btn btn-default",l}getTable(){const i=document.createElement("table");return i.className="table table-bordered",i}getTableCell(){return document.createElement("td")}addInputError(i,r){if(!i.controlgroup){this.queuedInputErrorText=r;return}!i.controlgroup||!i.controls||(i.controlgroup.className+=" error",i.errmsg?i.errmsg.style.display="":(i.errmsg=document.createElement("p"),i.errmsg.className="help-block errormsg",i.controls.appendChild(i.errmsg)),i.errmsg.textContent=r)}removeInputError(i){i.controlgroup||delete this.queuedInputErrorText,i.errmsg&&(i.errmsg.style.display="none",i.controlgroup.className=i.controlgroup.className.replace(/\s?error/g,""))}getTabHolder(i){const r=typeof i>"u"?"":i,n=document.createElement("div");return n.className="tabbable tabs-left",n.innerHTML=`<ul class='nav nav-tabs'  id='${r}'></ul><div class='tab-content well well-small' id='${r}'></div>`,n}getTopTabHolder(i){const r=typeof i>"u"?"":i,n=document.createElement("div");return n.className="tabbable tabs-over",n.innerHTML=`<ul class='nav nav-tabs' id='${r}'></ul><div class='tab-content well well-small'  id='${r}'></div>`,n}getTab(i,r){const n=document.createElement("li");n.className="nav-item";const l=document.createElement("a");return l.setAttribute("href",`#${r}`),l.appendChild(i),n.appendChild(l),n}getTopTab(i,r){const n=document.createElement("li");n.className="nav-item";const l=document.createElement("a");return l.setAttribute("href",`#${r}`),l.appendChild(i),n.appendChild(l),n}getTabContentHolder(i){return i.children[1]}getTopTabContentHolder(i){return i.children[1]}getTabContent(){const i=document.createElement("div");return i.className="tab-pane",i}getTopTabContent(){const i=document.createElement("div");return i.className="tab-pane",i}markTabActive(i){i.tab.className=i.tab.className.replace(/\s?active/g,""),i.tab.className+=" active",i.container.className=i.container.className.replace(/\s?active/g,""),i.container.className+=" active"}markTabInactive(i){i.tab.className=i.tab.className.replace(/\s?active/g,""),i.container.className=i.container.className.replace(/\s?active/g,"")}addTab(i,r){i.children[0].appendChild(r)}addTopTab(i,r){i.children[0].appendChild(r)}getProgressBar(){const i=document.createElement("div");i.className="progress";const r=document.createElement("div");return r.className="bar",r.style.width="0%",i.appendChild(r),i}updateProgressBar(i,r){i&&(i.firstChild.style.width=`${r}%`)}updateProgressBarUnknown(i){i&&(i.className="progress progress-striped active",i.firstChild.style.width="100%")}},this.editor=new Y.JSONEditor(s,e),this.disabled&&this.editor.disable(),this.editor.on("ready",()=>{this.originalValue=this.editor.getValue();const t=a.extend(this.originalValue,a.get(this.model,this.schema.model));this.editor.setValue(t),a.set(this.model,this.schema.model,t)}),this.editor.on("change",()=>{const t=this.editor.getValue();a.set(this.model,this.schema.model,t)})},methods:{}};var $i=function(){var e=this,t=e._self._c;return t("div",{ref:"json-editor",staticClass:"json-editor",attrs:{disabled:e.disabled}})},Si=[],Li=p(wi,$i,Si,!1,null,null,null,null);const Ti=Li.exports;const Ri={components:{TiptapVuetify:Be},mixins:[S],data(){return{localObj:this.model,loaded:!1,key:null,extensions:[qe,je,He,ze,Ke,Ge,Ye,We,Qe,[Xe,{options:{levels:[1,2,3]}}],Ze,Je,et,tt,st]}},watch:{model(){this.updateObj()}},mounted(){this.updateObj()},created(){},methods:{getColorForToolbar(){return this.$vuetify.theme.dark?"black":"white"},onInit(){setTimeout(()=>{const s=a.get(this.$refs.wysiwygWrapper,"children[1].children[0].children[0].children[0].children[0].children[0].children",[]);a.each(s,e=>{e.tabIndex=-1,a.each(e.children,t=>{t.tabIndex=-1,a.each(t.children,i=>{i.tabIndex=-1})})})},10)},updateObj(){if(!a.get(this.schema,"model",!1))return!1;const s=this.schema.model.split(".");this.key=s.pop(),this.localObj=a.reduce(s,(e,t)=>e[t],this.model),this.localObj[this.key]=this.localObj[this.key]||"",this.loaded=!0}}};var Ei=function(){var e=this,t=e._self._c;return t("div",{ref:"wysiwygWrapper",staticClass:"wysiwyg-wrapper"},[t("div",{staticClass:"field-label"},[e._v(e._s(e.schema.label))]),t("div",{staticClass:"border-wrapper"},[t("tiptap-vuetify",{attrs:{"card-props":{flat:!0},extensions:e.extensions,"toolbar-attributes":{color:e.getColorForToolbar(),dense:!0,outlined:!0,elevation:1},disabled:e.disabled,placeholder:"Write something "},on:{init:e.onInit,blur:e.onInit,focus:e.onInit},model:{value:e.localObj[e.key],callback:function(i){e.$set(e.localObj,e.key,i)},expression:"localObj[key]"}})],1)])},Ii=[],xi=p(Ri,Ei,Ii,!1,null,"2730a736",null,null);const ki=xi.exports,K={data(){return{dragging:!1,dragOptions:{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}}},methods:{onStartDrag(){this.dragging=!0},viewFile(s=!1){var e=s||this.attachment();const t=a.get(e,"_filename","").split("."),i=t.length>1?`.${a.last(t)}`:"";window.open(window.origin+e.url+i,"_blank").focus(),console.log(e)}}};const Di=["string","text","password","email","url","number","double","integer","checkbox","date","time","datetime","pillbox","json","code","wysiwyg","object","color","image","file"],Oi={mixins:[K],props:["schema","vfg","model","disabled"],data(){return{items:a.cloneDeep(a.get(this.model,this.schema.model,[])),types:[],selectedType:!1,localModel:{},key:P()}},watch:{"schema.model":function(){this.items=a.cloneDeep(a.get(this.model,this.schema.model,[]))}},created(){this.updateLocalData()},mounted(){const s=a.get(this,"schema.types",Di);this.types=a.map(s,e=>(a.isString(e)&&(e={input:e,parentKey:this.schema.model}),e.label||(e.label=a.includes(["select","multiselect"],e.input)?`${e.input}(${e.source})`:e.input),e)),this.selectedType=a.first(this.types)},methods:{onError(s){console.error("ParagraphView - error",s)},updateLocalData(){this.localModel=a.cloneDeep(this.model)},validate(){return a.each(this.$refs.vfg,s=>{if(!s.validate())throw this.errors=s.errors,new Error("group validation error")}),!0},debouncedValidate(){a.each(this.$refs.vfg,s=>{s.debouncedValidate()})},clearValidationErrors(){a.each(this.$refs.vfg,s=>{s.clearValidationErrors()})},getSchema(s){let e=[];const{resource:t,locale:i,userLocale:r,disabled:n}=this.schema;if(s.input==="group")e=a.map(s.schema,d=>a.extend({},d,{field:`value.${d.field}`,localised:this.schema.localised,label:d.label||d.field}));else{const d=a.extend({},s,{field:"value",localised:this.schema.localised});e.push(d)}a.each(e,d=>{a.includes(["image","file"],d.input)&&(d.input=a.camelCase(`paragraph ${d.input}`))});let l={};a.isString(s.source)&&(l=a.get(E.getSchema(s.source),"extraSources",{}));const o=H.getSchemaFields(e,t,i,r,n,l,this.schema.rootView||this);return{fields:H.getNestedGroups(t,o,0,null,"value.")}},getAttachment(s,e){const t=a.find(this.model._attachments,{_fields:{fileItemId:s}});return e?a.get(t,e):t},onChangeType(s){const e=a.find(this.types,{label:s});if(a.isUndefined(e))return console.warn(`No type found for ${s} in types:`,this.types);this.selectedType=e},onClickAddNewItem(){if(this.selectedType){const s=a.cloneDeep(this.selectedType);this.items.push(s),a.set(this.localModel,this.schema.model,this.items),this.$emit("input",this.localModel,this.schema.model)}},onClickRemoveItem(s){console.warn("onClickRemoveItem -",s);let e=a.get(this.model,"_attachments",[]);if(a.includes(["image","file","group"],s.input)){const t=r=>{const n=[];return a.each(r,(l,o)=>{if(o==="id")return n.push(l);(a.isPlainObject(l)||a.isArray(l))&&n.push(...t(l))}),n},i=t(s);console.warn("IDS = ",i),a.each(i,r=>{e=a.reject(e,{_fields:{fileItemId:r}})})}this.items=a.difference(this.items,[s]),a.set(this.localModel,this.schema.model,this.items),a.set(this.model,"_attachments",e),this.items=a.clone(this.items),this.key=P(),this.$emit("input",this.items,this.schema.model)},onChange(){a.set(this.localModel,this.schema.model,this.items),this.$emit("input",this.items,this.schema.model)},onEndDrag(){this.dragging=!1,a.set(this.localModel,this.schema.model,this.items),this.key=P(),this.$emit("input",this.items,this.schema.model)},onModelUpdated(s,e){a.set(this.localModel,this.schema.model,this.items),this.$emit("input",this.items,this.schema.model)}}};var Mi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"paragraph-view"},[e.schema?t("draggable",e._b({key:`${e.schema.model}-${e.key}`,class:{disabled:e.disabled},attrs:{list:e.items,draggable:".item",handle:".handle",group:`${e.schema.model}-${e.key}`,"ghost-class":"ghost"},on:{end:e.onEndDrag,start:function(i){e.dragging=!0}}},"draggable",e.dragOptions,!1),[e._l(e.items,function(i,r){return t(O,{key:`paragraph-item-${r}`,staticClass:"item"},[t("span",{staticClass:"handle"}),t("div",{staticClass:"item-main-wrapper"},[t("div",{staticClass:"item-main"},[t("custom-form",{attrs:{schema:e.getSchema(i),model:i},on:{error:e.onError,input:e.onModelUpdated}})],1),t(v,{staticClass:"add-new-item",attrs:{fab:"",small:""},on:{click:function(n){return e.onClickRemoveItem(i)}}},[t(f,[e._v("mdi-minus")])],1)],1)])}),t("div",{attrs:{slot:"header"},slot:"header"},[t(it,{attrs:{label:e.schema.label,value:e.selectedType,"menu-props":{bottom:!0,offsetY:!0},items:e.types,"item-text":"label","item-value":"label","hide-details":"",outlined:"",dense:"","persistent-placeholder":""},on:{change:e.onChangeType}}),t(v,{staticClass:"add-new-item",attrs:{fab:"",small:""},on:{click:e.onClickAddNewItem}},[t(f,[e._v("mdi-plus")])],1)],1)],2):e._e()],1)},Fi=[],Ai=p(Oi,Mi,Fi,!1,null,"c464b631",null,null);const Ni=Ai.exports,re={data(){return{dragover:!1,attachments:[],localModel:!1}},mounted(){this.localModel=a.cloneDeep(this.model),this.attachments=this.getAttachments()},methods:{onEndDrag({newIndex:s,oldIndex:e}){this.dragging=!1;const t=a.map(this.getAttachments(),(r,n)=>(r.order!==n+1&&(r.order=n+1,r.orderUpdated=!0),r));let i=a.map(this.localModel._attachments,r=>{if(!this.isSameAttachment(r))return r;const n=a.get(a.find(t,{orderUpdated:!0,_filename:r._filename,_size:r._size,url:r.url}),"order",0);return n!==0&&n!==a.get(r,"order",-1)&&(r.order=n,r.orderUpdated=!0),r});i=a.orderBy(i,["order"],["asc"]),this.attachments=a.filter(i,r=>this.isSameAttachment(r)),this.$emit("input",i,this.schema.model)},getImageSrc(s=!1){const e=s||this.attachment();return e.data?e.data:this.getPreviewUrl(e)},isImage(s=!1){const e=s||this.attachment();return e&&/image/g.test(e._contentType||e.file&&e.file.type)},getPreviewUrl(s=!1){return`${(s||this.attachment()).url}?resize=autox100`},isSameAttachment(s){const{key:e,locale:t}=this.getKeyLocale();return s._name===e&&(s._fields&&s._fields.locale)===t},attachment(){return a.find(this.localModel._attachments,s=>this.isSameAttachment(s))},getAttachments(){return a.get(this.attachments,"length",0)!==0?this.attachments:a.filter(this.localModel._attachments,s=>this.isSameAttachment(s))},imageSize(s=!1){const e=s||this.attachment();return this.bytesToSize(a.get(e,"_size",a.get(e,"file.size",!1)))},bytesToSize(s){if(s===0)return"0 Byte";const e=["Bytes","KB","MB","GB","TB"],t=parseInt(Math.floor(Math.log(s)/Math.log(1024))),i=Math.round(s/Math.pow(1024,t),2);return a.isNaN(i)?"Unknown":`${i} ${e[t]}`},isForMultipleImages(){if(this.schema.width&&this.schema.height)return!1;const s=this.getMaxCount();return s===-1?!0:s>1},isFieldDisabled(){const s=this.getMaxCount();return s===-1?!1:this.getAttachments().length>=s},getFieldType(){return a.toUpper(a.get(this.schema,"type","ImageView")==="ImageView"?"image":"file")},isFieldValid(){return a.get(a.compact(this.getRules()),"length",0)===0},getRules(){const s=[];return this.schema.required&&s.push(e=>!!e||a.get(this.getAttachments(),"length",0)!==0||h.get(`TL_${this.getFieldType()}_IS_MANDATORY`)),this.isForMultipleImages()?(s.push(e=>{const t=this.getMaxCount();return t===-1||a.get(this.getAttachments(),"length",0)+a.get(e,"length",0)<=t?!0:h.get(`TL_TOO_MANY_${this.getFieldType()}S`)}),a.get(this.schema,"options.limit",!1)&&s.push(e=>!e||!e.some(t=>t.size>this.schema.limit)||h.get(`TL_${this.getFieldType()}_IS_TOO_BIG`))):a.get(this.schema,"options.limit",!1)&&s.push(e=>!e||e.size<=this.schema.limit||h.get(`TL_${this.getFieldType()}_IS_TOO_BIG`)),s},getPlaceholder(){return`TL_CLICK_OR_DRAG_AND_DROP_TO_ADD_${this.getFieldType()}${this.isForMultipleImages()?"S":""}`},getMaxCount(){return a.get(this.schema,"options.maxCount",-1)},getFileSizeLimit(s){const e=s/1024;return e>1e3?`${e/1e3} MB`:`${e} KB`},removeImage(s){this.$refs.fileInput.internalValue=null,this.$refs.fileInput.$refs.input.value=null,this.localModel._attachments=a.filter(this.localModel._attachments,t=>t!==s),this.attachments=a.filter(this.localModel._attachments,t=>this.isSameAttachment(t)),this.$forceUpdate(),this.$emit("input",this.localModel._attachments,this.schema.model);const e=this.schema.label;this.schema.label=null,this.schema.label=e},onDrop(s){this.dragover=!1;const e=this.getMaxCount();if(e!==-1&&e<=1&&s.dataTransfer.files.length>1)return console.error("Only one file can be uploaded at a time..");this.onUploadChanged(s.dataTransfer.files)},async onUploadChanged(s){if(this.$refs.fileInput.validate(),!this.$refs.fileInput.valid||(s=a.isNull(s)?[]:s,a.isArray(s)||(s=[s]),!s.length))return;const e=this.getMaxCount(),t=this.getAttachments().length+s.length;e>1&&t>e?(console.warn("reached max",t,e),s=a.take(s,s.length-(t-e))):e===1&&t>1&&(this.localModel._attachments=a.filter(this.localModel._attachments,i=>!this.isSameAttachment(i))),this.attachments=a.filter(await this.readAllFiles(s),i=>this.isSameAttachment(i)),this.$forceUpdate(),this.$emit("input",this.localModel._attachments,this.schema.model)},async readAllFiles(s){let e=a.get(s,"length",1);return new Promise((t,i)=>{a.each(s,(r,n)=>{const l=new FileReader,o=this;l.onload=c=>{const{key:d,locale:_}=o.getKeyLocale(),C={_filename:r.name,_name:d,_fields:{locale:_},field:this.schema.model,localised:this.schema.localised,file:r,data:c.target.result};o.localModel._attachments.push(C),o.$forceUpdate(),e--,e===0&&(this.isForMultipleImages()&&a.each(o.localModel._attachments,(g,L)=>{g.order=L+1,g.orderUpdated=!0}),t(o.localModel._attachments))};try{l.readAsDataURL(r)}catch{}})})}}},Vi={components:{Cropper:at},mixins:[M,S,re,K],data(){return{firstCropUpdate:!0,stencilProps:{class:"cropper-stencil",previewClass:"cropper-stencil__preview",draggingClass:"cropper-stencil--dragging",handlersClasses:{default:"cropper-handler",eastNorth:"cropper-handler--east-north",westNorth:"cropper-handler--west-north",eastSouth:"cropper-handler--east-south",westSouth:"cropper-handler--west-south"}}}},methods:{getDefaultCropPosition({imageSize:s,visibleArea:e,coordinates:t}){const i=this.attachment();if(a.get(i,"cropOptions",!1))return{left:i.cropOptions.left,top:i.cropOptions.top};console.warn("no crop options");const r=e||s;return{left:(e?e.left:0)+r.width/2-t.width/2,top:(e?e.top:0)+r.height/2-t.height/2}},getDefaultCropSize(){return{width:a.get(this.schema,"options.width",500),height:a.get(this.schema,"options.height",500)}},onCropperChange(s){const e=this.attachment();a.each(this.localModel._attachments,t=>{t._id===e._id&&(t.cropOptions=s.coordinates,this.firstCropUpdate?this.firstCropUpdate=!1:t.cropOptions.updated=!0)}),this.$emit("input",this.localModel._attachments,this.schema.model)},imageUrl(){const s=this.attachment();return s&&(s.url||s.data)}}};var Ui=function(){var e=this,t=e._self._c;return t("div",{staticClass:"image-view",class:{"full-width":!(e.schema.width&&e.schema.height)}},[e.disabled?e._e():t("form",{attrs:{enctype:"multipart/form-data"}},[t(O,{staticClass:"file-input-card",class:{"drag-and-drop":e.dragover},attrs:{elevation:"0"},on:{drop:function(i){return i.preventDefault(),e.onDrop(i)},dragover:function(i){i.preventDefault(),e.dragover=!0},dragenter:function(i){i.preventDefault(),e.dragover=!0},dragleave:function(i){i.preventDefault(),e.dragover=!1}}},[t(z,{ref:"fileInput",attrs:{rules:e.getRules(),"hide-details":e.isFieldValid(),label:e.schema.label,placeholder:e._f("translate")(e.getPlaceholder()),clearable:!1,dense:"",outlined:"","persistent-placeholder":"","persistent-hint":"",multiple:e.isForMultipleImages(),accept:e.schema.accept,disabled:e.isForMultipleImages()&&e.isFieldDisabled()},on:{change:e.onUploadChanged},scopedSlots:e._u([{key:"selection",fn:function({index:i}){return[i===0?t("div",{staticClass:"v-file-input__text v-file-input__text--placeholder"},[e._v(" "+e._s(e._f("translate")(e.getPlaceholder()))+" ")]):e._e()]}}],null,!1,3100899402)})],1)],1),e.isForMultipleImages()?t("div",{staticClass:"preview-multiple"},[e.schema?t("draggable",e._b({key:`${e.schema.model}`,class:{disabled:e.disabled},attrs:{list:e.getAttachments(),draggable:".preview-attachment",handle:".row-handle","ghost-class":"ghost"},on:{end:e.onEndDrag,start:e.onStartDrag}},"draggable",e.dragOptions,!1),e._l(e.getAttachments(),function(i,r){return t(O,{key:`${i._filename}-${r}`,staticClass:"preview-attachment",class:{odd:r%2!==0}},[t(N,{staticClass:"filename",attrs:{close:""},on:{"click:close":function(n){return e.removeImage(i)}}},[e._v("#"+e._s(r+1)+" - "+e._s(e._f("truncate")(i._filename,10))+" ("+e._s(e.imageSize(i))+")")]),t("div",{staticClass:"row-handle"},[t("img",{attrs:{src:e.getImageSrc(i)}}),t(f,[e._v("mdi-drag")])],1)],1)}),1):e._e()],1):e.attachment()&&e.isImage()?[e.schema.width&&e.schema.height?[t("cropper",{ref:"cropper",staticClass:"cropper",attrs:{src:e.imageUrl(),transitions:!0,"image-restriction":"fill-area","image-class":"cropper__image","default-boundaries":"fill","default-size":e.schema.options.width&&e.schema.options.height?e.getDefaultCropSize():!1,"default-position":e.getDefaultCropPosition,"min-width":e.schema.options.width,"max-width":e.schema.options.width,"min-height":e.schema.options.height,"max-height":e.schema.options.height,"move-image":!!e.schema.options.moveImage,"resize-image":!!e.schema.options.resizeImage,"stencil-props":e.stencilProps},on:{change:e.onCropperChange}})]:t("div",{staticClass:"preview-single-attachment"},[t(N,{staticClass:"filename",attrs:{close:""},on:{"click:close":function(i){e.removeImage(e.attachment())}}},[e._v(e._s(e._f("truncate")(e.attachment()._filename,10))+" ("+e._s(e.imageSize(e.attachment()))+")")]),t("img",{staticClass:"preview",attrs:{src:e.getImageSrc()}})],1)]:e._e(),e.isForMultipleImages()?[t("div",{staticClass:"help-block"},[t(f,{attrs:{small:""}},[e._v("mdi-information")]),e.getMaxCount()!==-1?t("span",[e._v(e._s(e._f("translate")("TL_MAX_NUMBER_OF_IMAGES",null,{num:e.getMaxCount()})))]):t("span",[e._v(e._s(e._f("translate")("TL_UNLIMITED_NUMBER_OF_IMAGES")))])],1)]:e._e(),e.schema.width&&e.schema.height?t("div",{staticClass:"help-block"},[t(f,{attrs:{small:""}},[e._v("mdi-information")]),t("span",[e._v(e._s(e._f("translate")("TL_THIS_FIELD_REQUIRES_THE_FOLLOWING_SIZE"))+":"+e._s(e.schema.width)+"x"+e._s(e.schema.height))])],1):e._e(),e.schema.limit?t("div",{staticClass:"help-block"},[t(f,{attrs:{small:""}},[e._v("mdi-information")]),t("span",[e._v(e._s(e._f("translate")("TL_THIS_FIELD_REQUIRES_A_FILE_SIZE"))+": "+e._s(e.getFileSizeLimit(e.schema.limit)))])],1):e._e(),e.schema.accept?t("div",{staticClass:"help-block"},[t(f,{attrs:{small:""}},[e._v("mdi-information")]),t("span",[e._v(e._s(e._f("translate")("TL_THIS_FIELD_REQUIRES"))+": "+e._s(e.schema.accept))])],1):e._e()],2)},Pi=[],Bi=p(Vi,Ui,Pi,!1,null,null,null,null);const qi=Bi.exports,ji={mixins:[S,re,K]};var Hi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"attachment-view"},[e.disabled?e._e():t("form",{attrs:{enctype:"multipart/form-data"}},[t(O,{staticClass:"file-input-card",class:{"drag-and-drop":e.dragover},attrs:{elevation:"0"},on:{drop:function(i){return i.preventDefault(),e.onDrop(i)},dragover:function(i){i.preventDefault(),e.dragover=!0},dragenter:function(i){i.preventDefault(),e.dragover=!0},dragleave:function(i){i.preventDefault(),e.dragover=!1}}},[t(z,{ref:"fileInput",attrs:{rules:e.getRules(),label:e.schema.label,placeholder:e._f("translate")(e.getPlaceholder()),clearable:!1,dense:"",outlined:"","persistent-placeholder":"","persistent-hint":"",multiple:e.isForMultipleImages(),accept:e.schema.accept,disabled:e.isForMultipleImages()&&e.isFieldDisabled()},on:{change:e.onUploadChanged},scopedSlots:e._u([{key:"selection",fn:function({index:i}){return[i===0?t("div",{staticClass:"v-file-input__text v-file-input__text--placeholder"},[e._v(" "+e._s(e._f("translate")(e.getPlaceholder()))+" ")]):e._e()]}}],null,!1,3100899402)})],1)],1),e.isForMultipleImages()?t("div",{staticClass:"preview-multiple"},[e.schema?t("draggable",e._b({key:`${e.schema.model}`,class:{disabled:e.disabled},attrs:{list:e.getAttachments(),draggable:".preview-attachment",handle:".row-handle","ghost-class":"ghost"},on:{end:e.onEndDrag,start:e.onStartDrag}},"draggable",e.dragOptions,!1),e._l(e.getAttachments(),function(i,r){return t(O,{key:`${i._filename}-${r}`,staticClass:"preview-attachment",class:{odd:r%2!==0}},[t(N,{staticClass:"filename",attrs:{close:""},on:{"click:close":function(n){return e.removeImage(i)}}},[e._v("#"+e._s(r+1)+" - "+e._s(e._f("truncate")(i._filename,10))+" ("+e._s(e.imageSize(i))+")")]),t("div",{staticClass:"row-handle"},[e.isImage()?t("img",{attrs:{src:e.getImageSrc(i)}}):t(v,{attrs:{small:""},on:{click:function(n){return e.viewFile(i)}}},[e._v(e._s(e._f("translate")("TL_VIEW")))]),t(f,[e._v("mdi-drag")])],1)],1)}),1):e._e()],1):e.attachment()?t("div",{staticClass:"preview-single-attachment"},[t(N,{staticClass:"filename",attrs:{close:""},on:{"click:close":function(i){e.removeImage(e.attachment())}}},[e._v(e._s(e._f("truncate")(e.attachment()._filename,10))+" ("+e._s(e.imageSize(e.attachment()))+")")]),e.isImage()?t("img",{attrs:{src:e.getImageSrc()}}):t(v,{attrs:{small:""},on:{click:function(i){return e.viewFile()}}},[e._v(e._s(e._f("translate")("TL_VIEW")))])],1):e._e(),e.isForMultipleImages()?[t("div",{staticClass:"help-block"},[t(f,{attrs:{small:""}},[e._v("mdi-information")]),e.getMaxCount()!==-1?t("span",[e._v(e._s(e._f("translate")("TL_MAX_NUMBER_OF_FILES",null,{num:e.getMaxCount()})))]):t("span",[e._v(e._s(e._f("translate")("TL_UNLIMITED_NUMBER_OF_FILES")))])],1)]:e._e(),e.schema.width&&e.schema.height?t("div",{staticClass:"help-block"},[t(f,{attrs:{small:""}},[e._v("mdi-information")]),t("span",[e._v(e._s(e._f("translate")("TL_THIS_FIELD_REQUIRES_THE_FOLLOWING_SIZE"))+":"+e._s(e.schema.width)+"x"+e._s(e.schema.height))])],1):e._e(),e.schema.limit?t("div",{staticClass:"help-block"},[t(f,{attrs:{small:""}},[e._v("mdi-information")]),t("span",[e._v(e._s(e._f("translate")("TL_THIS_FIELD_REQUIRES_A_FILE_SIZE"))+": "+e._s(e.getFileSizeLimit(e.schema.limit)))])],1):e._e(),e.schema.accept?t("div",{staticClass:"help-block"},[t(f,{attrs:{small:""}},[e._v("mdi-information")]),t("span",[e._v(e._s(e._f("translate")("TL_THIS_FIELD_REQUIRES"))+": "+e._s(e.schema.accept))])],1):e._e()],2)},zi=[],Ki=p(ji,Hi,zi,!1,null,null,null,null);const Gi=Ki.exports;const Yi={mixins:[S,re,K],data(){return{dragover:!1,items:a.get(this.model,this.schema.model,[]),key:P(),attachments:[]}},watch:{"schema.model":function(){this.items=a.get(this.model,this.schema.model,[]),this.attachments=this.formatItems()}},mounted(){this.attachments=this.formatItems()},methods:{formatItems(){return a.map(this.items,s=>this.getAttachment(s))},onChange(){a.set(this.model,this.schema.model,this.items),this.$emit("input",this.model,this.schema.model)},onEndDrag(){a.set(this.model,this.schema.model,this.items),this.$emit("input",this.model,this.schema.model)},onDrop(s){if(this.dragover=!1,this.schema.maxCount<=1&&s.dataTransfer.files.length>1)return console.error("Only one file can be uploaded at a time..");s.dataTransfer.files.forEach(e=>{this.onChangeFile(e)})},onChangeFile(s){if(this.$refs.fileInput.validate(),!this.$refs.fileInput.valid)return;a.isArray(s)||(s=[s]);const{key:e,locale:t}=this.getKeyLocale();a.each(s,(i,r)=>{const n=P(),l={id:n};this.items.push(l),this.items=a.clone(this.items),a.set(this.model,this.schema.model,this.items),this.$emit("input",this.model,this.schema.model);const o=this.schema.rootView.model._attachments=this.schema.rootView.model._attachments||[],c={_filename:i.name,order:r+1,orderUpdated:!0,_name:e,_fields:{locale:t,fileItemId:n},file:i};if(this.schema.fileType==="image")try{c.url=URL.createObjectURL(i)}catch(d){console.error(d)}o.push(c),console.warn("added attachment = ",c),event.target.value=null}),a.set(this.model,this.schema.model,this.items),this.$emit("input",this.model,this.schema.model)},getAttachment(s,e){const t=a.find(this.schema.rootView.model._attachments,{_fields:{fileItemId:s.id}});return e?a.get(t,e):t},onClickRemoveFileItem(s){let e=this.schema.rootView.model._attachments=this.schema.rootView.model._attachments||[];e=a.reject(e,{_fields:{fileItemId:s.id}}),this.items=a.difference(this.items,[s]),a.set(this.schema.rootView.model,"_attachments",e),a.set(this.model,this.schema.model,this.items),this.$emit("input",this.model,this.schema.model)}}};var Wi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"paragraph-attachment-view"},[t(O,{class:{"drag-and-drop":e.dragover},attrs:{elevation:"0"},on:{drop:function(i){return i.preventDefault(),e.onDrop(i)},dragover:function(i){i.preventDefault(),e.dragover=!0},dragenter:function(i){i.preventDefault(),e.dragover=!0},dragleave:function(i){i.preventDefault(),e.dragover=!1}}},[t(z,{ref:"fileInput",attrs:{rules:e.getRules(),accept:e.model.input==="image"?"image/*":"*",clearable:!1,placeholder:e._f("translate")(e.getPlaceholder()),dense:"",outlined:"","persistent-placeholder":"","persistent-hint":"",multiple:e.isForMultipleImages(),disabled:e.isForMultipleImages()&&e.isFieldDisabled()},on:{change:e.onChangeFile},scopedSlots:e._u([{key:"selection",fn:function({index:i}){return[i===0?t("div",{staticClass:"v-file-input__text v-file-input__text--placeholder"},[e._v(" "+e._s(e._f("translate")(e.getPlaceholder()))+" ")]):e._e()]}}])})],1),e.schema?t("draggable",e._b({key:`${e.schema.model}-${e.key}`,staticClass:"preview-multiple",class:{disabled:e.disabled},attrs:{group:`${e.schema.model}-${e.key}`,draggable:".preview-attachment",handle:".row-handle","ghost-class":"ghost"},on:{end:e.onEndDrag,start:e.onStartDrag},model:{value:e.items,callback:function(i){e.items=i},expression:"items"}},"draggable",e.dragOptions,!1),e._l(e.items,function(i,r){return t(O,{key:`${i._filename}-${r}`,staticClass:"preview-attachment",class:{odd:r%2!==0}},[t(N,{staticClass:"filename",attrs:{close:""},on:{"click:close":function(n){return e.onClickRemoveFileItem(i)}}},[e._v("#"+e._s(r+1)+" - "+e._s(e._f("truncate")(e.getAttachment(i,"_filename"),10))+" ("+e._s(e.imageSize(e.getAttachment(i)))+")")]),t("div",{staticClass:"row-handle"},[e.isImage()?t("img",{attrs:{src:e.getImageSrc(i)}}):e.getAttachment(i,"url")?t(v,{attrs:{small:""},on:{click:function(n){e.viewFile(e.getAttachment(i))}}},[e._v(e._s(e._f("translate")("TL_VIEW")))]):e._e(),t(f,[e._v("mdi-drag")])],1)],1)}),1):e._e()],1)},Qi=[],Xi=p(Yi,Wi,Qi,!1,null,"1db722f8",null,null);const Zi=Xi.exports;const Ji={props:["format","name","width","value"],data(){return{hideCal:!0,activePort:null,timeStamp:null,months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Su","Mo","Tu","We","Th","Fr","Sa"],monthIndex:0,hourIndex:0,minuteIndex:0,year:2017,portsHolder:[],minute:0,hour:1,day:1,minuteSelectorVisible:!1,hourSelectorVisible:!1,period:"AM"}},computed:{ports:{get(){let s=[];if(this.portsHolder.length===0)for(let e=0;e<42;e++)s.push("");else s=this.portsHolder;return s},set(s){this.portsHolder=s}},month(){return this.months[this.monthIndex]},dateTime(){return`${this.timeStamp.getFullYear()}-${this.timeStamp.getMonth()+1}-${this.timeStamp.getUTCDay()}`},minutes(){const s=[];for(let e=0;e<60;e++)e<10?s.push(`0${e}`):s.push(`${e}`);return s},hours(){const s=[];for(let e=1;e<=12;e++)e<10?s.push(`0${e}`):s.push(`${e}`);return s},dateFormat(){return this.format||"YYYY-MM-DD hh:mm:ss a"},hideTime(){return this.dateFormat.indexOf("hh:mm:ss")===-1},hideDate(){return this.dateFormat==="hh:mm:ss a"}},created(){let s=new Date;this.value&&(s=new Date(this.value),this.timeStamp=s),this.year=s.getFullYear(),this.monthIndex=s.getMonth(),this.day=s.getDate(),this.period=s.getHours()>=12?"PM":"AM",this.hour=s.getHours(),this.hour===0?this.hour+=12:this.hour>12&&(this.hour-=12),this.minute=s.getMinutes()||0,this.updateCalendar(),document.addEventListener("keydown",this.keyIsDown),document.addEventListener("click",this.documentClicked),this.setDate()},destroyed(){document.removeEventListener("keydown",this.keyIsDown),document.removeEventListener("click",this.documentClicked)},methods:{padZero(s){return a.padStart(s,2,"0")},display(){return this.timeStamp?D(this.timeStamp).format(this.dateFormat):""},leftMonth(){const s=this.months.indexOf(this.month);s===0?this.monthIndex=11:this.monthIndex=s-1,this.updateCalendar()},rightMonth(){const s=this.months.indexOf(this.month);s===11?this.monthIndex=0:this.monthIndex=s+1,this.updateCalendar()},rightYear(){this.year++,this.updateCalendar()},leftYear(){this.year--,this.updateCalendar()},updateCalendar(){const s=this,t=new Date(s.year,s.monthIndex,1,0,0,0).getDay(),i=new Date(s.year,s.monthIndex+1,0).getDate(),r=[];let n=35;(t===6||t===5&&i===31)&&(n=42);let l=!1;for(let o=0;o<n;o++){const c=o-t,d=c<0||c>=i?"":c+1;r.push(d),this.timeStamp&&d===s.day&&this.timeStamp.getMonth()===s.monthIndex&&this.timeStamp.getFullYear()===s.year&&(s.activePort=o,l=!0)}l||(s.activePort=-1),this.ports=r},setDay(s,e){e!==""&&(this.activePort=s,this.day=e,this.timeStamp=new Date(this.year,this.monthIndex,this.day),this.setDate(!0))},setMinute(s,e){this.minuteIndex=s,this.minute=s,e&&(this.minuteSelectorVisible=!1)},setHour(s,e){this.hourIndex=s,this.hour=s+1,e&&(this.hourSelectorVisible=!1)},showHourSelector(){this.hourSelectorVisible=!0,this.minuteSelectorVisible=!1},showMinuteSelector(){this.minuteSelectorVisible=!0,this.hourSelectorVisible=!1},keyIsDown(s){const e=s.which||s.keycode;e===38?this.minuteSelectorVisible&&this.minuteIndex>0?(this.setMinute(this.minuteIndex-1,!1),this.scrollTopMinute()):this.hourSelectorVisible&&this.hourIndex>0&&(this.setHour(this.hourIndex-1,!1),this.scrollTopHour()):e===40?this.minuteSelectorVisible&&this.minuteIndex<this.minutes.length-1?(this.setMinute(this.minuteIndex+1,!1),this.scrollTopMinute()):this.hourSelectorVisible&&this.hourIndex<this.hours.length-1&&(this.setHour(this.hourIndex+1,!1),this.scrollTopHour()):e===13&&(this.minuteSelectorVisible=!1,this.hourSelectorVisible=!1),(this.minuteSelectorVisible||this.hourSelectorVisible)&&(s.preventDefault(),this.minuteSelectorVisible=!1,this.hourSelectorVisible=!1)},scrollTopMinute(){const s=this.$refs.minuteScroller.scrollHeight,e=this.$refs.minuteScrollerWrapper.clientHeight,t=s*(this.minuteIndex/(this.minutes.length-1))-e/2;this.$refs.minuteScroller.scrollTop=t},scrollTopHour(){const s=this.$refs.hourScroller.scrollHeight,e=this.$refs.hourScrollerWrapper.clientHeight,t=s*(this.hourIndex/(this.hours.length-1))-e/2;this.$refs.hourScroller.scrollTop=t},changePeriod(){this.period=this.period==="AM"?"PM":"AM"},calendarClicked(s){s.target.id!=="j-hour"&&s.target.id!=="j-minute"&&(this.minuteSelectorVisible=!1,this.hourSelectorVisible=!1),s.cancelBubble=!0,s.stopPropagation&&s.stopPropagation()},documentClicked(s){s.target.id!=="tj-datetime-input"&&(this.hideCal=!0)},toggleCal(){this.hideCal=!this.hideCal},clearDate(){this.timeStamp="",this.$emit("input",""),this.hideCal=!0},setDate(s){let e=this.hour;this.hour===12&&this.period==="AM"&&(e=e-12),this.hour!==12&&this.period==="PM"&&(e=e+12);const t=new Date(this.year||1970,this.monthIndex||0,this.day||1,e,this.minute,0);s&&(this.timeStamp=t,this.$emit("input",t.getTime()),this.hideCal=!0)}}};var ea=function(){var e=this,t=e._self._c;return t("div",{staticClass:"datetime-picker",style:{width:e.width},on:{click:function(i){return e.calendarClicked(i)}}},[t("div",[t("input",{attrs:{id:"tj-datetime-input",readonly:"",type:"text",name:e.name,autocomplete:"off"},domProps:{value:e.display()},on:{click:e.toggleCal}}),t("div",{staticClass:"calender-div",class:{noDisplay:e.hideCal}},[t("div",{class:{noDisplay:e.hideDate}},[t("div",{staticClass:"year-month-wrapper"},[t("div",{staticClass:"month-setter"},[t("span",{staticClass:"nav-l",attrs:{type:"button"},on:{click:e.leftYear}},[e._v("<")]),t("span",{staticClass:"year"},[e._v(e._s(e.year))]),t("span",{staticClass:"nav-r",attrs:{type:"button"},on:{click:e.rightYear}},[e._v(">")])]),t("div",{staticClass:"month-setter"},[t("span",{staticClass:"nav-l",attrs:{type:"button"},on:{click:e.leftMonth}},[e._v("<")]),t("span",{staticClass:"month"},[e._v(e._s(e._f("translate")("TL_"+e.month.toUpperCase())))]),t("span",{staticClass:"nav-r",attrs:{type:"button"},on:{click:e.rightMonth,mousedown:function(i){i.stopPropagation(),i.preventDefault()}}},[e._v(">")])])]),t("div",{staticClass:"headers"},[e._l(e.days,function(i,r){return[t("span",{key:r,staticClass:"days"},[e._v(e._s(e._f("translate")("TL_"+i.toUpperCase())))])]})],2),t("div",[e._l(e.ports,function(i,r){return[t("span",{key:r,staticClass:"port",class:{activePort:r===e.activePort},on:{click:function(n){return e.setDay(r,i)}}},[e._v(e._s(i))])]})],2)]),t("div",{staticClass:"time-picker",class:{noDisplay:e.hideTime}},[t("div",{staticClass:"hour-selector"},[t("div",{attrs:{id:"j-hour"},on:{click:e.showHourSelector}},[e._v(e._s(e.padZero(e.hour)))]),t("div",{ref:"hourScrollerWrapper",staticClass:"scroll-hider",class:{showSelector:e.hourSelectorVisible}},[t("ul",{ref:"hourScroller"},[e._l(e.hours,function(i,r){return[t("li",{key:r,class:{active:r==e.hourIndex},on:{click:function(n){return e.setHour(r,!0)}}},[e._v(e._s(i))])]})],2)])]),e._m(0),t("div",{staticClass:"minute-selector"},[t("div",{attrs:{id:"j-minute"},on:{click:e.showMinuteSelector}},[e._v(e._s(e.padZero(e.minute)))]),t("div",{ref:"minuteScrollerWrapper",staticClass:"scroll-hider",class:{showSelector:e.minuteSelectorVisible}},[t("ul",{ref:"minuteScroller"},[e._l(e.minutes,function(i,r){return[t("li",{key:r,class:{active:r==e.minuteIndex},on:{click:function(n){return e.setMinute(r,!0)}}},[e._v(e._s(i))])]})],2)])]),e._m(1),t("div",{staticClass:"minute-selector"},[t("div",{on:{click:e.changePeriod}},[e._v(e._s(e._f("translate")("TL_"+e.period.toUpperCase())))])])]),t("span",{staticClass:"okButton",attrs:{type:"button"},on:{click:function(i){return e.setDate(!0)}}},[e._v(e._s(e._f("translate")("TL_OK")))]),t("span",{staticClass:"okButton",attrs:{type:"button"},on:{click:function(i){return e.clearDate()}}},[e._v(e._s(e._f("translate")("TL_CLEAR")))])])])])},ta=[function(){var s=this,e=s._self._c;return e("div",{staticClass:"time-separator"},[e("span",[s._v(":")])])},function(){var s=this,e=s._self._c;return e("div",{staticClass:"time-separator"},[e("span",[s._v(":")])])}],sa=p(Ji,ea,ta,!1,null,"f9925e5d",null,null);const ia=sa.exports,aa={components:{datetime:ia},mixins:[S],props:["options","customDatetimePickerOptions"],data(){return{}},created(){this.schema.format=this.schema.format||"DD/MM/YYYY h:i:s"},methods:{onChangeData(s){a.set(this.model,this.schema.model,s),this.$emit("model-updated",s,this.schema.model);const e=this.schema.label;this.schema.label=null,this.schema.label=e},get:a.get}};var ra=function(){var e=this,t=e._self._c;return t("div",[t("datetime",{attrs:{format:e.schema.format,value:e.get(e.model,e.schema.model)},on:{input:e.onChangeData}})],1)},na=[],la=p(aa,ra,na,!1,null,null,null,null);const oa=la.exports,ca={mixins:[S],data(){return{objectValue:this.value}},computed:{selectOptions(){return this.schema.selectOptions||{}},options(){let s=this.schema.values;return typeof s=="function"?s.apply(this,[this.model,this.schema]):s},formattedOptions(){const s=this.selectOptions.label||this.options;if(a.isString(a.first(s)))return s;const e=this.customLabel;return a.isFunction(this.customLabel)?a.map(s,t=>{const i=e(t);return a.isString(i)&&(t.text=i),a.isUndefined(a.get(t,"value",void 0))&&(t.value=a.get(t,"_id",void 0)),t}):s},hasCustomLabel(){const s=a.get(this.schema,"selectOptions");return typeof s<"u"&&typeof s.customLabel<"u"&&typeof s.customLabel=="function"},customLabel(){return a.isString(a.first(this.options))?this.options:this.hasCustomLabel?this.schema.selectOptions.customLabel:"text"}},methods:{getLabel(){return this.disabled?"":a.isString(this.selectOptions.label)?this.selectOptions.label:this.schema.label},updateSelected(s){this.objectValue=s;const e=a.get(this.schema,"selectOptions.key");e?this.value=a.get(this.objectValue,e):this.value=this.objectValue,this.$emit("input",s,this.schema.model)},addTag(s,e){const t=this.selectOptions.onNewTag;typeof t=="function"&&t(s,e,this.options,this.objectValue)},onSearchChange(s,e){const t=this.selectOptions.onSearch;typeof t=="function"&&t(s,e,this.options)}}};var da=function(){var e=this,t=e._self._c;return t("div",{staticClass:"multiselect-wrapper"},[t(rt,{attrs:{id:e.selectOptions.id,label:e.getLabel(),chips:e.selectOptions.multiple,value:e.objectValue,items:e.formattedOptions,"deletable-chips":e.selectOptions.multiple,"hide-selected":e.selectOptions.hideSelected,disabled:e.disabled,placeholder:e.schema.placeholder,multiple:e.selectOptions.multiple,clearable:"","persistent-placeholder":"",outlined:"",dense:"","hide-details":""},on:{change:e.updateSelected,"search-change":e.onSearchChange,tag:e.addTag}})],1)},ua=[],ha=p(ca,da,ua,!1,null,null,null,null);const ma=ha.exports;function pa(s=""){return s.toString().trim().replace(/ /g,"-").replace(/-{2,}/g,"-").replace(/^-+|-+$/g,"").replace(/([^a-zA-Z0-9-_/./:]+)/g,"")}const fa={mixins:[S],data(){return{comboExpanded:!1}},computed:{items(){const s=this.schema.values;return typeof s=="function"?s.apply(this,[this.model,this.schema]):s},selectedCount(){return u.get(this,"value.length",0)},selectAllLabel(){return h.get(this.allSelected?"TL_DESELECT_ALL":"TL_SELECT_ALL")},allSelected(){return u.get(this.value,"length",0)===u.get(this.items,"length",0)}},methods:{onChangeSelectAll(s){this.value=s?u.map(this.items,e=>this.getItem(e,"value")):[],this.$forceUpdate()},getInputName(s){let e=this.getItem(s,"value");return this.schema&&this.schema.inputName&&this.schema.inputName.length>0&&(e=`${this.schema.inputName}_${e}`),pa(e)},getItem(s,e){if(!u.isObject(s))return s;if(typeof this.schema.customChecklistOptions<"u"&&typeof this.schema.customChecklistOptions.value<"u")return s[u.get(this.schema.customChecklistOptions,e,!1)];const t=u.get(s,e,"undefined");if(typeof t<"u")return t;this.newError(e)},isItemChecked(s){return this.value&&this.value.indexOf(this.getItem(s,"value"))!==-1},onChanged(s,e){(u.isNil(this.value)||!Array.isArray(this.value))&&(this.value=[]);const t=u.clone(this.value);s?t.push(this.getItem(e,"value")):t.splice(this.value.indexOf(this.getItem(e,"value")),1),this.value=t},onExpandCombo(){this.comboExpanded=!this.comboExpanded}}};var ga=function(){var e=this,t=e._self._c;return t("div",{staticClass:"wrapper custom-checklist"},[t("div",{staticClass:"field-label"},[e._v(e._s(e.schema.label))]),t("div",{staticClass:"border-wrapper"},[e.schema.listBox?t("div",{staticClass:"listbox form-control",attrs:{disabled:e.disabled}},[t("div",{staticClass:"select-all"},[t("label",[t(W,{attrs:{id:e.getFieldID(e.schema),ripple:!1,dense:"","hide-details":"","input-value":e.allSelected,label:e.selectAllLabel},on:{change:e.onChangeSelectAll}})],1)]),e._l(e.items,function(i,r){return t("div",{key:r,staticClass:"list-row",class:{"is-checked":e.isItemChecked(i)}},[t("label",[t(W,{attrs:{id:e.getFieldID(e.schema),ripple:!1,dense:"","hide-details":"","input-value":e.isItemChecked(i),disabled:e.disabled,label:e.getInputName(i),name:e.getInputName(i)},on:{change:function(n){return e.onChanged(n,i)}}})],1)])})],2):t("div",{staticClass:"combobox form-control",attrs:{disabled:e.disabled}},[t("div",{staticClass:"mainRow",class:{expanded:e.comboExpanded},on:{click:e.onExpandCombo}},[t("div",{staticClass:"node-cms-info"},[e._v(e._s(e.selectedCount)+" "+e._s(e._f("translate")("TL_SELECTED")))]),t("div",{staticClass:"arrow"})]),e.comboExpanded?t("div",{staticClass:"dropList"},e._l(e.items,function(i,r){return t("div",{key:r,staticClass:"list-row",class:{"is-checked":e.isItemChecked(i)}},[t("label",[t(W,{attrs:{id:e.getFieldID(e.schema)+r,ripple:!1,dense:"","hide-details":"",label:e.getInputName(i),"input-value":e.isItemChecked(i),disabled:e.disabled,name:e.getInputName(i)},on:{change:function(n){return e.onChanged(n,i)}}})],1)])}),0):e._e()])])])},_a=[],va=p(fa,ga,_a,!1,null,null,null,null);const ya=va.exports;const Ca={mixins:[S],data(){return{}},methods:{onChangeData(s){this.value=s},get(s){return a.get(this.schema,s,!1)},getAutocomplete(){return a.get(this.schema,"inputFieldType","text")==="password"?"current-password":"null"},getType(){return a.get(this.schema,"inputFieldType","text")},validateField(s){return this.schema.required&&(a.isNull(s)||a.isUndefined(s)||s==="")?!1:this.schema.validator&&a.isFunction(this.schema.validator)?!!this.schema.validator(s,this.schema.model,this.model):!0}}};var ba=function(){var e=this,t=e._self._c;return t(se,{class:[e.schema.labelClasses],attrs:{type:e.getType(),label:e.schema.label,value:e.value,"input-value":e.value,"max-length":e.schema.max,autocomplete:e.getAutocomplete(),"min-length":e.schema.min,rules:[e.validateField],dense:e.get("dense"),compact:e.get("compact"),disabled:e.get("disabled"),readonly:e.get("readonly"),filled:e.get("filled"),outlined:e.get("outlined"),solo:e.get("solo"),"persistent-placeholder":"","hide-details":""},on:{input:e.onChangeData},scopedSlots:e._u([e.schema.required?{key:"label",fn:function(){return[t("span",{staticClass:"red--text"},[t("strong",[e._v("* ")])]),e._v(e._s(e.schema.label)+" ")]},proxy:!0}:null],null,!0)})},wa=[],$a=p(Ca,ba,wa,!1,null,null,null,null);const Sa=$a.exports;const La={mixins:[S],data(){return{}},methods:{onChangeData(s){this.value=s},getType(){return a.get(this.schema,"inputFieldType","text")}}};var Ta=function(){var e=this,t=e._self._c;return t("div",{staticClass:"custom-textarea"},[t(nt,{class:[e.schema.labelClasses],attrs:{type:e.getType(),value:e.value,label:e.schema.label,"max-length":e.schema.max,"min-length":e.schema.min,dense:!!e.schema.dense,compact:!!e.schema.compact,disabled:!!e.schema.disabled,readonly:!!e.schema.readonly,filled:!!e.schema.filled,"hide-details":"",outlined:!!e.schema.outlined,solo:!!e.schema.solo},on:{input:e.onChangeData}})],1)},Ra=[],Ea=p(La,Ta,Ra,!1,null,null,null,null);const Ia=Ea.exports;const xa={mixins:[S],data(){return{}},computed:{},created(){},methods:{getValue(){const s=a.get(this.model,this.schema.model,!1);return a.isNull(s)?!1:s},onChange(s){this.$emit("input",s,this.schema.model)}}};var ka=function(){var e=this,t=e._self._c;return t("div",{staticClass:"custom-switch"},[t("div",{staticClass:"field-label"},[e._v(e._s(e.schema.label))]),t("div",{staticClass:"border-wrapper"},[t(pe,{staticClass:"switch",attrs:{"input-value":e.getValue(),compact:!!e.schema.compact,disabled:!!e.schema.disabled,readonly:!!e.schema.readonly,filled:!!e.schema.filled,dense:"","hide-details":"",solo:"",outlined:!!e.schema.outlined},on:{change:e.onChange}})],1)])},Da=[],Oa=p(xa,ka,Da,!1,null,null,null,null);const Ma=Oa.exports,Fa={mixins:[S],props:["locale"],data(){return{tags:[],options:{allowDuplicates:this.getOpt("allowDuplicates",!0),readOnly:this.getOpt("disabled",!1),placeholder:this.getOpt("placeholder",""),dense:this.getOpt("dense",!1),multiple:this.getOpt("multiple",!1),outlined:this.getOpt("outlined",!1),deletableChips:this.getOpt("deletableChips",!1),smallChips:this.getOpt("smallChips",!1),limit:this.getOpt("limit",-1)}}},watch:{tags(){a.set(this.model,this.schema.model,this.tags)},"schema.model":function(){this.tags=a.get(this.model,this.schema.model)}},created(){this.options=a.extend(this.options,this.schema.selectOptions)},mounted(){this.tags=a.get(this.model,this.schema.model)},methods:{onChangeData(s){a.get(this.options,"limit",-1)!==-1?this.value=a.take(s,this.options.limit):this.value=s}}};var Aa=function(){var e=this,t=e._self._c;return t(lt,{attrs:{clearable:"","hide-details":"",outlined:"","deletable-chips":"","small-chips":"",dense:"","hide-selected":!e.options.allowDuplicates,readonly:e.options.readOnly,placeholder:e.options.tagPlaceholder,multiple:e.options.multiple},on:{change:e.onChangeData},model:{value:e.tags,callback:function(i){e.tags=i},expression:"tags"}})},Na=[],Va=p(Fa,Aa,Na,!1,null,null,null,null);const Ua=Va.exports;const Pa={mixins:[S],props:["groupOptions"],data(){return{errors:null}},methods:{onError(s){console.log(999,"error",s)},validate(){const s=this.$refs.vfg.validate();if(!s)throw this.errors=this.$refs.vfg.errors,new Error("group validation error");return s},debouncedValidate(){return this.$refs.vfg.debouncedValidate()},clearValidationErrors(){return this.$refs.vfg.clearValidationErrors()},onModelUpdated(s,e){this.$emit("model-updated",s,e)}}};var Ba=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"field-label"},[e._v(e._s(e.schema.label))]),t("div",{staticClass:"group"},[t("custom-form",{ref:"vfg",attrs:{schema:e.schema.groupOptions,model:e.model},on:{"update:model":function(i){e.model=i},error:e.onError,input:e.onModelUpdated}})],1)])},qa=[],ja=p(Pa,Ba,qa,!1,null,"ff942ce0",null,null);const Ha=ja.exports;const za={props:["row","column","rowIndex","field"],methods:{getSrc(){const s=a.get(this.findAttachmentForField(this.row,this.field),"url",!1);return s?s+"?resize=autox50":!1},findAttachmentForField(s,e){return a.find(a.get(s,"_attachments",[]),t=>e.localised?a.get(t,"_fields.locale",!1)===e.locale&&t._name===e.originalModel:t._name===e.originalModel)}}};var Ka=function(){var e=this,t=e._self._c;return e.getSrc()?t("img",{staticClass:"vue-table-generator-field image",attrs:{src:e.getSrc()}}):t("span",[e._v(e._s(e._f("translate")("TL_NO_IMAGE")))])},Ga=[],Ya=p(za,Ka,Ga,!1,null,"e3374301",null,null);const Wa=Ya.exports,Qa={props:["row","column","rowIndex","field"],methods:{getValue(){return a.get(this.row,this.column.field,!1)}}};var Xa=function(){var e=this,t=e._self._c;return t(ot,{staticClass:"vue-table-generator-field custom-switch",attrs:{ripple:!1,value:e.getValue()}})},Za=[],Ja=p(Qa,Xa,Za,!1,null,"37c72f05",null,null);const er=Ja.exports;const tr={props:["row","column","rowIndex","edit","remove"]};var sr=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vue-table-generator-field table-column-actions"},[t(v,{attrs:{small:""},on:{click:function(i){return e.edit(e.row)}}},[e._v(e._s(e._f("translate")("TL_EDIT")))]),t(v,{staticClass:"delete-btn",attrs:{small:"",color:"node-cms-red"},on:{click:function(i){return e.remove(e.row)}}},[e._v(e._s(e._f("translate")("TL_DELETE")))])],1)},ir=[],ar=p(tr,sr,ir,!1,null,"b4a6d030",null,null);const rr=ar.exports,nr={install(s,e={}){this.installed||(this.installed=!0,this.params=e,s.prototype.$loading=ie)}};function lr(s,e,t){return h.get(s,e,t)}function or(s,e){return a.isString(e)?(a.includes(e,"n")&&console.warn("Truncate - should truncate the text by number of items"),a.truncate(s,{length:a.toNumber(e)})):a.truncate(s,{length:e})}window.Vue=m;m.component("CustomForm",Us);m.component("AttachmentView",Gi);m.component("ImageView",qi);m.component("CustomInput",Sa);m.component("CustomTextarea",Ia);m.component("CustomSwitch",Ma);m.component("ParagraphAttachmentView",Zi);m.component("ParagraphView",Ni);m.component("CustomTreeView",ui);m.component("CustomCode",gi);m.component("ColorPicker",bi);m.component("JsonEditor",Ti);m.component("WysiwygField",ki);m.component("CustomDatetimePicker",oa);m.component("CustomChecklist",ya);m.component("Group",Ha);m.component("CustomInputTag",Ua);m.component("CustomMultiSelect",ma);m.component("PluginPage",Hs);m.component("MultiselectPage",Ms);m.component("Syslog",Ws);m.component("CmsImport",ei);m.component("SyncResource",ri);m.component("Draggable",ct);m.component("TableImageView",Wa);m.component("TableCustomSwitch",er);m.component("TableRowActions",rr);m.mixin({filters:{translate:lr,truncate:or}});m.use(nr);m.use(dt);m.use(ut);m.use(ht);m.use(ve);m.use(mt);m.use(pt,{name:"timeago",locale:"enUS",locales:{enUS:ft,zhCN:gt}});function Z(s,e,t="System",i=["admins","imagination"]){window.plugins=window.plugins||[],window.plugins.push({title:s,displayname:e,component:s,group:t,allowed:i,type:"plugin"})}window.addEventListener("load",async function(){window.TranslateService=h;const e=(await b.get(`${window.location.pathname}config`)).data;Z("Syslog","Syslog"),e.import&&Z("CmsImport","Cms Import"),e.sync&&!e.sync.disablePlugin&&Z("SyncResource","Sync Resource"),window.disableJwtLogin=a.get(e,"disableJwtLogin",!1),window.noLogin=window.disableJwtLogin&&a.get(e,"disableAuthentication",!1);const t=new ve({});new m({el:"#app",vuetify:ye,router:t,render:function(i){return i(this.$el.getAttribute("type")==="login"?Is:Ss)}})});
